var contactsUl,chatsUl,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},allowedOrigins={"https://growthfile.com":!0,"https://growthfile-207204.firebaseapp.com":!0};function addView(t,n){removeSwipe();setHeader("<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n    ","").root_.classList.remove("hidden"),dom_root.classList.remove("mdc-layout-grid","pl-0","pr-0"),dom_root.innerHTML="\n        <iframe class='' id='form-iframe' src='"+window.location.origin+"/v2/forms/"+t.template+"/edit.html'></iframe>",document.getElementById("form-iframe").addEventListener("load",function(e){passFormData({name:"init",template:t,body:n,deviceType:native.getName()})})}function passFormData(e){var t=document.getElementById("form-iframe")||document.getElementById("rating-form");t&&t.contentWindow.postMessage(e,window.location.origin)}function resizeFrame(e){var t=document.getElementById("rating-form");t&&(t.style.height=e.height+"px")}function sendFormToParent(a){progressBar.open();var i=a.customerAuths;delete a.customerAuths,appLocation(3).then(function(t){requestCreator("create",a,t).then(function(){if(console.log(a),successDialog("You Created a "+a.template),"attendance"===a.report&&a.id){var e=db.transaction("attendance","readwrite"),n=e.objectStore("attendance");return n.get(a.id).onsuccess=function(e){var t=e.target.result;t&&(t.editable=0,n.put(t))},void(e.oncomplete=function(){history.back()})}return"customer"===a.template&&(ApplicationState.knownLocation=!0,ApplicationState.venue={office:a.office,template:a.template,status:a.status,location:a.venue[0].location,address:a.venue[0].address,latitude:a.venue[0].geopoint.latitude,longitude:a.venue[0].geopoint.longitude},localStorage.setItem("ApplicationState",JSON.stringify(ApplicationState)),Object.keys(i).forEach(function(e){requestCreator("updateAuth",i[e],t).then(function(e){console.log(e)}).catch(console.error)})),history.back()}).catch(function(e){if(snacks(e.message),passFormData({name:"toggleSubmit",template:"",body:"",deviceType:native.getName()}),"attendance"===a.report&&400==e.body.code){if(!a.id)return;var t=db.transaction("attendance");t.objectStore("attendance").get(a.id).onsuccess=function(e){var t=e.target.result;t&&handleError({message:"IDB record",body:t})},t.oncomplete=function(){}}})}).catch(handleLocationError)}function parseContact(e){var t=e.split("&")[0].split("=")[1],n=e.split("&")[1].split("=")[1],a=e.split("&")[2].split("=")[1];return{displayName:t||"",phoneNumber:n?formatNumber(n):"",email:a||""}}function setContactForCustomer(e){var t=parseContact(e),n=document.getElementById("form-iframe")||document.getElementById("rating-form");n&&n.contentWindow.postMessage({name:"setContact",body:t},window.location.origin)}function setContactForCustomerFailed(e){handleError({message:e,body:""})}function getContactManager(e){var t=parseContact(e),n=document.getElementById("form-iframe");n&&n.contentWindow.postMessage({name:"setContactForManager",body:t},window.location.origin)}function expenseClaimImage(e){var t=document.getElementById("form-iframe");t&&t.contentWindow.postMessage({name:"setExpenseImage",body:e},window.location.origin)}function callImage(e){var t=document.getElementById("form-iframe");t&&t.contentWindow.postMessage({name:"setCallImage",body:e},window.location.origin)}window.addEventListener("message",function(e){allowedOrigins[e.origin]&&"object"===_typeof(e.data)&&null!=e.data&&e.data.hasOwnProperty("name")&&window[e.data.name](e.data.body)});var currentChatsArray=[],currentContactsArray=[];function chatView(){var e=document.getElementById("app-tab-content");if(e){if(!document.getElementById("search-btn")){var t=createElement("button",{className:"material-icons mdc-top-app-bar__action-item mdc-icon-button",id:"search-btn",textContent:"search"});document.getElementById("section-end").insertBefore(t,document.getElementById("section-end").firstChild),t.addEventListener("click",function(){history.pushState(["searchChats"],null,null),search()})}e.innerHTML=chatDom(),readLatestChats(!0)}}function chooseContact(e){var t=parseContact(e);t.mobile=t.phoneNumber,delete t.phoneNumber,history.pushState(["enterChat",t],null,null),enterChat(t)}function chatDom(){return"<div class='user-chats'>\n    \n<div id='search-users-container'>\n    <div class='search-field'></div>\n    <div class='search-result-container'></div>\n</div>\n<div class=\"mdc-list-group\">\n <h3 id='no-result-found' style='text-align:center'></h3>   \n<div class='chats-container'>\n<h3 class=\"mdc-list-group__subheader mdc-list-group__subheader mdc-typography--headline6\"></h3>\n<ul class=\"mdc-list mdc-list--two-line mdc-list--avatar-list\" id='chats'>\n\n</ul>\n</div>\n<div class='contacts-container'>\n  <h3 class=\"mdc-list-group__subheader mdc-list-group__subheader mdc-typography--headline6\"></h3>\n  <ul class=\"mdc-list mdc-list--two-line mdc-list--avatar-list\" id='all-contacts'>\n  </ul>\n</div>\n  </div>\n</div>"}function searchBar(){return'<div id=\'search-users\' class="mdc-text-field mdc-text-field--with-leading-icon mdc-text-field--with-trailing-icon mdc-text-field--no-label">\n    <i class="material-icons mdc-text-field__icon" tabindex="0" role="button" id=\'search-back\'>arrow_back</i>\n    <i class="material-icons mdc-text-field__icon hidden"  tabindex="0" role="button" id=\'clear-search\'>clear</i>\n    <input type="text" id="my-input" class="mdc-text-field__input" placeholder=\'Search...\' style=\'padding-left:48px;padding-right: 48px;\'>\n    <div class="mdc-line-ripple"></div>\n</div>'}function search(){document.getElementById("app-header").classList.add("hidden"),document.querySelector("#search-users-container .search-field").innerHTML=searchBar();var o=new mdc.textField.MDCTextField(document.getElementById("search-users"));o.focus(),appTabBar.root_.classList.add("hidden"),o.input_.addEventListener("input",function(e){o.trailingIcon_.root_.classList.remove("hidden"),e.target.value?o.trailingIcon_.root_.classList.remove("hidden"):o.trailingIcon_.root_.classList.add("hidden");var n=firebase.auth().currentUser.phoneNumber,t=getSearchBound(e),a="",i="";currentChatsArray=[],currentContactsArray=[],t.bound.onsuccess=function(e){var t=e.target.result;t&&(t.value.mobile!==n&&(t.value.timestamp?(a+=userLi(t.value),currentChatsArray.push(t.value)):(i+=userLi(t.value),currentContactsArray.push(t.value))),t.continue())},t.tx.oncomplete=function(){var e=document.getElementById("chats"),t=document.getElementById("all-contacts"),n=document.getElementById("no-result-found");n&&(currentChatsArray.length||currentContactsArray.length?n.innerHTML="":n.innerHTML="No Results Found"),e&&(currentChatsArray.length?(document.querySelector(".chats-container h3").textContent="Chats",document.querySelector(".chats-container").classList.remove("hidden")):(document.querySelector(".chats-container h3").textContent="",document.querySelector(".chats-container").classList.add("hidden")),e.innerHTML=a),t&&(i?(document.querySelector(".contacts-container h3").textContent="Other Contacts",document.querySelector(".contacts-container").classList.remove("hidden")):(document.querySelector(".contacts-container h3").textContent="",document.querySelector(".contacts-container").classList.add("hidden")),t.innerHTML=i)}}),o.leadingIcon_.root_.onclick=function(){closeSearchBar(),chatView()},o.trailingIcon_.root_.onclick=function(){searchInitCancel(o)}}function getSearchBound(e){var t=e.target.value,n=db.transaction(["users","addendum"]),a=n.objectStore("users"),i=null,o="next";return e.target.value?(t=isNumber(t)?(indexName="mobile",formatNumber(t)):(indexName="NAME_SEARCH",t.toLowerCase()),i=IDBKeyRange.bound(t,t+"ï¿¿"),a=a.index(indexName)):history.state&&"searchChats"===history.state[0]&&(indexName="timestamp",o="prev"),{tx:n,bound:a=a.openCursor(i,o)}}function isNumber(e){return!isNaN(e)}function formatNumber(e){var t=e;return"91"===t.substring(0,2)?t="+"+t:"+91"!==t.substring(0,3)&&(t="+91"+t),t.replace(/ +/g,"")}function getOtherContacts(){currentContactsArray=[];var e=db.transaction("users","readwrite"),t=e.objectStore("users").index("timestamp"),n=firebase.auth().currentUser.phoneNumber,a="";t.openCursor("").onsuccess=function(e){var t=e.target.result;t&&(t.value.mobile!==n&&(a+=userLi(t.value),currentContactsArray.push(t.value)),t.continue())},e.oncomplete=function(){var e=document.getElementById("all-contacts");document.querySelector(".contacts-container").classList.remove("hidden"),e&&(e.innerHTML=a||"No Contacts Found",initializeContactList(contactsUl=new mdc.list.MDCList(e)))}}function readLatestChats(a){currentChatsArray=[];var e=db.transaction(["users"],"readwrite"),t=e.objectStore("users").index("timestamp"),n=firebase.auth().currentUser.phoneNumber,i="",o=IDBKeyRange.bound(1,27138906e5);t.openCursor(o,"prev").onsuccess=function(e){var t=e.target.result;t&&(t.value.mobile!==n&&(i+=userLi(t.value,!0),currentChatsArray.push(t.value)),t.continue())},e.oncomplete=function(){var e=document.getElementById("chats"),t=document.getElementById("all-contacts"),n=document.querySelector(".chats-container");n&&n.classList.remove("hidden"),e&&(currentChatsArray.length?e.innerHTML=i:e.innerHTML='<h3 class="mb-0 mdc-typography--headline5 mdc-theme--primary mb-0 text-center">No chats found</h3>\n                ',a&&(initializeChatList(chatsUl=new mdc.list.MDCList(e)),initializeContactList(new mdc.list.MDCList(t))))}}function initializeChatList(e){e.listen("MDCList:action",function(e){var t=currentChatsArray[e.detail.index];history.state&&"searchChats"===history.state[0]?history.replaceState(["enterChat",t],null,null):history.pushState(["enterChat",t],null,null),enterChat(t)})}function initializeContactList(e){e.listen("MDCList:action",function(e){var t=currentContactsArray[e.detail.index];history.state&&"searchChats"===history.state[0]?history.replaceState(["enterChat",t],null,null):history.pushState(["enterChat",t],null,null),enterChat(t)})}function userLi(e,t){return'<li class="mdc-list-item '+(e.count&&t?"unread-chat":"")+'">\n   <div style="position:relative">\n   <img class="mdc-list-item__graphic"  aria-hidden="true" src='+(e.photoURL||"./img/empty-user.jpg")+'  onerror="imgErr(this)" data-number='+e.mobile+'>\n   <i class="material-icons user-selection-icon">check_circle</i>\n   </div>\n    \n    <span class="mdc-list-item__text">\n    <span class="mdc-list-item__primary-text">\n        '+(e.displayName||e.mobile)+'\n    </span>\n    <span class="mdc-list-item__secondary-text">\n    '+(e.comment||"")+'\n    </span>\n    </span>\n    <span class="mdc-list-item__meta" aria-hidden="true">\n    <span class=\'chat-time mdc-typography--subtitle2\'>\n        '+(e.timestamp?formatChatTime(e.timestamp):"")+"</span>\n        "+(e.count&&t?" <div class='unread-count'>"+e.count+"</div>":"")+"\n    </span>\n    </li>"}function loadUsers(c,s){return new Promise(function(e,t){var n=db.transaction(["users"]),a=n.objectStore("users"),i=firebase.auth().currentUser.phoneNumber,o="",r=[];a.openCursor().onsuccess=function(e){var t=e.target.result;t&&(t.value.mobile!==i&&(s&&s[t.value.mobile]||(r.push(t.value),c&&(t.value.comment="",t.value.count="",t.value.timestamp=""),o+=userLi(t.value))),t.continue())},n.oncomplete=function(){return e({domString:o,data:r})}})}function selectNew(){return"<div class='new-message-container'>\n        <h2 class='mdc-typography--headline5 mt-0 mb-0'>Message Team With Direct</h2>\n    <p>Send private message.... </p>\n    <button class='mdc-button' onclick=newMessage()>\n    <span class=\"mdc-button__label\">Send Message</span>\n    </button>\n    </div>"}function formatCreatedTime(e){return e?moment(e).calendar(null,{sameDay:"hh:mm A",lastDay:"[Yesterday] hh:mm A",nextDay:"[Tomorrow]",nextWeek:"dddd",lastWeek:"DD/MM/YY hh:mm A",sameElse:"DD/MM/YY hh:mm A"}):""}function formatChatTime(e){return e?moment(e).calendar(null,{sameDay:"hh:mm",lastDay:"[Yesterday]",nextDay:"[Tomorrow]",nextWeek:"dddd",lastWeek:"DD/MM/YY",sameElse:"DD/MM/YY"}):""}function isToday(e){return(new Date).setHours(0,0,0,0)==new Date(e).setHours(0,0,0,0)}function enterChat(e){removeSwipe();var t=document.getElementById("app-tab-content");if(t){var n=db.transaction("users","readwrite").objectStore("users");n.get(e.mobile).onsuccess=function(e){var t=e.target.result;t&&(delete t.count,n.put(t))},setHeader("<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n        <img src="+(e.photoURL||"./img/empty-user.jpg")+' class=\'header-image\' onerror="imgErr(this)">\n        <span class="mdc-top-app-bar__title">'+(e.displayName||e.mobile)+"</span>\n        ","").root_.classList.remove("hidden"),t.innerHTML='\n    <div class="page">\n    <div class="marvel-device nexus5">\n  \n      <div class="screen">\n        <div class="screen-container">\n          \n          <div class="chat">\n            <div class="chat-container">\n              \n              <div class="conversation">\n                <div class="conversation-container">\n                <div id=\'content\'>\n                </div>\n            \n            \n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n        ',getUserChats(e)}}function actionBoxContent(e){return"\n    <div class='menu-container mdc-menu-surface--anchor' id=\""+e.addendumId+'"> </div>\n    '+e.comment+'\n<span class="metadata">\n<i class=\'material-icons\'>info</i>\n<span>click to see more</span>\n    <span class="time">\n        '+moment(e.timestamp).format("hh:mm")+"\n    </span>\n  \n</span>"}function actionBox(e,t){var n=createElement("div",{className:"message "+t+" menu-action"});return n.addEventListener("click",function(){openActivity(e)}),n.innerHTML=""+actionBoxContent(e),n}function openActivity(n){db.transaction("activity").objectStore("activity").get(n.activityId).onsuccess=function(e){var t=e.target.result;t&&showViewDialog(createActivityHeading(t,n.location),t,"view-form")}}function messageBoxContent(e,t){return" "+e+'\n    <span class="metadata">\n        <span class="time">'+moment(t).format("hh:mm")+"</span\n    </span>\n  </div>"}function messageBox(e,t,n){var a=createElement("div",{className:"message "+t});return a.innerHTML=" "+messageBoxContent(e,n),a}function createActivityHeading(e,t){var n='<a target="_blank" href=\'comgooglemaps://?center='+t._latitude+","+t._longitude+"'>view in map</span>";return"Android"===native.getName()&&(n="<a href='geo:"+t._latitude+","+t._longitude+"?q="+t._latitude+","+t._longitude+"'>view in map</a>"),e.activityName+"\n    <p class='card-time mdc-typography--subtitle1 mb-0 mt-0'>Created On "+formatCreatedTime(e.timestamp)+"</p>\n    <i class='material-icons dialog-close--heading' id='close-activity-dialog'>close</i>\n    "+(e.creator.displayName||e.creator.phoneNumber?' <span class="demo-card__subtitle mdc-typography mdc-typography--subtitle2 mt-0">by '+(e.creator.displayName||e.creator.phoneNumber)+"</span>":"")+"\n    <div class='mdc-typography--subtitle2'>"+n+"</div>\n    "}function getStatusArray(e){var t=[],n={name:"Confirm",icon:"check",status:"CONFIRMED",color:"green"},a={name:"Undo",icon:"undo",status:"PENDING",color:"#103153"},i={name:"Delete",icon:"delete",status:"CANCELLED",color:"red"};return"CANCELLED"===e.status&&t.push(a,n),"PENDING"===e.status&&t.push(i,n),"CONFIRMED"===e.status&&t.push(i,a),t}function showViewDialog(e,t,n){var a=new Dialog(e,activityDomCustomer(t),n).create();return a.open(),a.container_.querySelector(".mdc-dialog__actions").remove(),a.autoStackButtons=!1,a.listen("MDCDialog:opened",function(e){var t=document.getElementById("schedule-container");t&&new mdc.list.MDCList(t).layout()}),document.getElementById("close-activity-dialog").addEventListener("click",function(){a.close()}),document.getElementById("share-btn")&&document.getElementById("share-btn").addEventListener("click",function(){share(t,dom_root)}),a}function createDynamicChips(e,t,n){var a=createElement("button",{className:"mdc-chip",id:t}),i=createElement("div",{className:"mdc-chip__text",textContent:e}),o=createElement("i",{className:"material-icons mdc-chip__icon mdc-chip__icon--trailing",textContent:"cancel"});return o.setAttribute("tabindex","0"),o.setAttribute("role","button"),n&&a.appendChild(n),a.appendChild(i),a.appendChild(o),a}function share(t,e){if(e){setHeader("<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n    <span class=\"mdc-top-app-bar__title\">Add People</span>\n    ","<a class='mdc-top-app-bar__action-item material-icons' id='search-btn'>\n        search\n    </a>").root_.classList.remove("hidden");var a={},c={};t.assignees.forEach(function(e){a[e.phoneNumber]=!0,c[e.phoneNumber]=!0}),e.innerHTML="\n    <div id='search-users-container'>\n    </div>\n    <div class='share-user-container'>\n    <div class=\"mdc-chip-set hidden\" id='share'>\n    </div>\n    </div>\n    <ul class=\"mdc-list mdc-list--two-line mdc-list--avatar-list\" id='users-list'>\n    </ul>\n    <button class=\"mdc-fab mdc-theme--primary-bg app-fab--absolute\" aria-label=\"Favorite\" id='send-assignee'>\n        <span class=\"mdc-fab__icon material-icons mdc-theme--on-primary\">arrow_forward</span>\n    </button>\n    ";var s=document.getElementById("share"),l=new mdc.chips.MDCChipSet(s),n=document.getElementById("users-list"),d=new mdc.list.MDCList(n),i=new mdc.ripple.MDCRipple(document.getElementById("send-assignee"));history.pushState(["share",t],null,null),loadUsers(!0,a).then(function(r){r.data.length&&(i.root_.addEventListener("click",function(){var e=Object.keys(c);e.length?(t.share=e,addAssignee(t)):snacks("At least 1 contact must be selected")}),document.getElementById("users-list").innerHTML=r.domString,l.listen("MDCChip:removal",function(e){var t=d.listElements[Number(e.detail.chipId)];delete c[r.data[Number(e.detail.chipId)].mobile],s.removeChild(e.detail.root),t.classList.remove("selected"),t.querySelector(".user-selection-icon").classList.add("hidden"),t.querySelector(".user-selection-icon").classList.remove("user-selection-show"),l.chips.length?s.classList.remove("hidden"):s.classList.add("hidden")}),d.listen("MDCList:action",function(e){var t=e.detail.index,n=d.listElements[t],a=r.data[t];if(n.classList.contains("selected")){new mdc.chips.MDCChip(document.getElementById(""+t)).beginExit()}else{c[a.mobile]=!0,n.classList.add("selected"),n.querySelector(".user-selection-icon").classList.remove("hidden"),n.querySelector(".user-selection-icon").classList.add("user-selection-show");var i=createElement("img",{className:"mdc-chip__icon mdc-chip__icon--leading",src:a.photoURL||"./img/empty-user.jpg"}),o=createDynamicChips(a.displayName||a.mobile,t,i);o.classList.add("mdc-chip--selected"),s.appendChild(o),l.addChip(o),o.scrollIntoView({behavior:"smooth",block:"center",inline:"end"}),s.classList.remove("hidden")}}),document.getElementById("search-btn").addEventListener("click",function(e){document.getElementById("app-header").classList.add("hidden"),document.getElementById("search-users-container").innerHTML="<div class='search-field'>\n            "+searchBar()+"\n        </div>";var n=new mdc.textField.MDCTextField(document.getElementById("search-users"));n.focus(),n.input_.addEventListener("input",function(e){e.target.value?n.trailingIcon_.root_.classList.remove("hidden"):n.trailingIcon_.root_.classList.add("hidden"),d.listElements.forEach(function(e){e.classList.remove("found")});var t=getSearchBound(e);t.bound.onsuccess=function(e){var t=e.target.result;if(t)if(a[t.value.mobile])t.continue();else{var n=document.querySelector('[data-number="'+t.value.mobile+'"]');n&&n.parentNode.parentNode.classList.add("found"),t.continue()}},t.tx.oncomplete=function(){d.listElements.forEach(function(e){e.classList.contains("found")?e.classList.remove("hidden"):e.classList.add("hidden")})}}),n.leadingIcon_.root_.onclick=function(){searchInitBack(n)},n.trailingIcon_.root_.onclick=function(){searchInitCancel(n)}}))})}}function closeSearchBar(){document.getElementById("search-users")&&document.getElementById("search-users").classList.add("hidden"),document.getElementById("app-header").classList.remove("hidden"),appTabBar.root_.classList.remove("hidden")}function searchInitBack(e){closeSearchBar(),e.value="",e.input_.dispatchEvent(new Event("input"))}function searchInitCancel(e){e.value="",e.input_.dispatchEvent(new Event("input"))}function activityDomCustomer(e){return" <div class='mdc-card'>\n    <div id='status-change-container'></div>\n    <div class='view-card'>\n    <div id='schedule-container'>\n        <ul class='mdc-list mdc-list--two-line'>\n            "+viewSchedule(e)+"\n        </ul>\n    </div>\n    <div id='schedule-container'>\n        <ul class='mdc-list mdc-list--two-line'>\n            "+viewVenue(e)+"\n        </ul>\n    </div>\n    <div id='attachment-container'>\n        "+viewAttachment(e)+"\n    </div>  \n     \n        <div id='assignee-container'>\n            "+(e.assignees.length?'<div class="assignees tasks-heading center">\n            <i class="material-icons">share</i>\n            '+viewAssignee(e,!0)+"\n        </div>":"")+"\n          \n    </div>\n\n</div>"}function addAssignee(t){closeSearchBar(),appLocation(3).then(function(e){requestCreator("share",t,e).then(function(){snacks("You added "+t.assignees.length+" people"),history.back()}).catch(console.error)}).catch(handleLocationError)}function setActivityStatus(t){appLocation(3).then(function(e){requestCreator("statusChange",t,e).then(function(){snacks(t.activityName+" is "+t.status)}).catch(console.error)}).catch(handleLocationError)}function iconByType(e,t){if("string"===e)return"Name"===t?"account_circle":"info";return{phoneNumber:"phone","HH:MM":"access_time",weekday:"today"}[e]}function viewFormAttachmentEl(e,t){return"base64"===t.attachment[e].type?'<ul class="mdc-image-list my-image-list mdc-image-list--masonry">\n        <li class="mdc-image-list__item">\n        <img class="mdc-image-list__image" src="'+t.attachment[e].value+'" onerror="imgErr(this)">\n          <div class="mdc-image-list__supporting">\n            <span class="mdc-image-list__label">'+e+"</span>\n          </div>\n        </li>\n      </ul>":"Include"===e?"":"product"===t.attachment[e].type?checkProductLength(t.attachment.Products.value)?"<div class='products-container'>\n            <p class='mdc-typography--subtitle2 mb-0'>Products : </p>\n            "+t.attachment[e].value.map(function(e){return"<p class='mt-0 mb-0 mdc-theme--subtitle1'>"+e.name+"</p>\n                <div class='details mdc-theme--caption' style='margin-left:20px'>\n                    "+(e.date?"<div> Date : "+moment(e.date).format("D MMM h[:]mm A")+"</div>":"")+"\n                    "+(e.quantity?"<div>Quantity : "+e.quantity+"</div>":"")+"\n                    "+(e.rate?"<div>Rate : "+e.rate+"</div>":"")+"\n                </div>\n                "}).join("")+"\n        </div>\n        ":"":'<h1 class="mdc-typography--subtitle1 mt-0">\n        '+e+" : "+t.attachment[e].value+"\n    </h1>"}function viewAttachment(t){return""+Object.keys(t.attachment).map(function(e){return""+(t.attachment[e].value?viewFormAttachmentEl(e,t):"")}).join("")}function viewVenue(e,n){return""+e.venue.map(function(e,t){return"\n            "+(e.location&&e.address?'\n            <li class="mdc-list-item">\n                 '+(0==t?'<span class="mdc-list-item__graphic material-icons"\n                 aria-hidden="true">location_on</span>':'<span class="mdc-list-item__graphic" aria-hidden="true"\n                    style=\'background-color:white\'></span>')+"\n                    <span class='mdc-list-item__text'>\n                    <span class='mdc-list-item__primary-text'>"+e.location+"</span>\n                    <span class='mdc-list-item__secondary-text'>"+e.address+"</span>\n                    </span>\n                     "+(n?'<a class="mdc-list-item__meta material-icons venue-map-intent mdc-theme--primary" aria-hidden="true" href=\'geo:'+e.geopoint._latitude+","+e.geopoint._longitude+"?q="+e.geopoint._latitude+","+e.geopoint._longitude+"'>map</a>":"")+"\n              </li>":"")}).join("")}function viewSchedule(e){return"\n    \n    "+e.schedule.map(function(e,t){return'\n            <li class="mdc-list-item">\n            '+(0==t?'<span class="mdc-list-item__graphic material-icons"\n            aria-hidden="true">today</span>':'<span class="mdc-list-item__graphic" aria-hidden="true"\n            style=\'background-color:white\'></span>')+'\n            <span class="mdc-list-item__text">\n              <span class="mdc-list-item__primary-text">'+e.name+'</span>\n              <span class="mdc-list-item__secondary-text">'+moment(e.startTime).format("D MMM h[:]mm A")+" - "+moment(e.endTime).format("D MMM h[:]mm A")+"</span>\n            </span>\n          </li>"}).join("")}function viewAssignee(e,t){return"\n    <div class=\"mdc-chip-set\" id='share'>\n     "+e.assignees.map(function(e,t){return'<div class="mdc-chip" id=\''+t+"-preselected'>\n                    <img class='mdc-chip__icon mdc-chip__icon--leading' src="+(e.photoURL||"../img/empty-user.jpg")+" onerror=\"imgErr(this)\">\n                    <div class='mdc-chip__text'>"+(e.displayName||e.phoneNumber)+"</div>\n                </div>"}).join("")+"\n\n    </div>"}function createStatusChange(e){var t="";return"CANCELLED"===e&&(t='<li class="mdc-list-item" data-value="PENDING">\n       PENDING\n      </li>\n      <li class="mdc-list-item" data-value="CONFIRMED">\n        CONFIRMED\n    </li>\n      '),"PENDING"===e&&(t='<li class="mdc-list-item mdc-list-item--selected" data-value="PENDING" aria-selected="true">\n        PENDING\n       </li>\n       <li class="mdc-list-item" data-value="CONFIRMED">\n         CONFIRMED\n     </li>\n       '),"CONFIRMED"===e&&(t='<li class="mdc-list-item mdc-list-item--selected" data-value="CONFIRMED" aria-selected="true">\n        CONFIRMED\n       </li>\n       <li class="mdc-list-item" data-value="PENDING">\n         PENDING\n     </li>\n       '),'<div class="mdc-select status-select" id=\'status-enhanced-select\'>\n    <input type="hidden" name="enhanced-select">\n    <i class="mdc-select__dropdown-icon"></i>\n    <div class="mdc-select__selected-text"></div>\n    <div class="mdc-select__menu mdc-menu mdc-menu-surface status-select">\n      <ul class="mdc-list">\n        '+t+'\n      </ul>\n    </div>\n    <span class="mdc-floating-label">Change Status</span>\n    <div class="mdc-line-ripple"></div>\n  </div>'}function dynamicAppendChats(){var a=document.getElementById("content"),i=firebase.auth().currentUser.phoneNumber;db.transaction("addendum").objectStore("addendum").index("timestamp").openCursor(IDBKeyRange.lowerBound(Number(a.dataset.timestamp),!0)).onsuccess=function(e){var t=e.target.result;if(t&&a)if(t.value.key===i+history.state[1].mobile)if(document.getElementById(t.value.addendumId))t.continue();else{var n="them";t.value.user===i&&(n="me"),t.value.isComment?a.appendChild(messageBox(t.value.comment,n,t.value.timestamp)):a.appendChild(actionBox(t.value,n)),t.continue()}else t.continue()};var e=db.transaction("users","readwrite"),n=e.objectStore("users");n.get(history.state[1].mobile).onsuccess=function(e){var t=e.target.result;t&&(delete t.count,n.put(t))},e.oncomplete=function(){setBottomScroll()}}function getHumanDateString(e){var t=moment(),n=moment().subtract(1,"day");return e.isSame(t,"day")?"Today":e.isSame(n,"day")?"Yesterday":e.format("DD MMMM YYYY")}function dateBox(e){var t=createElement("div",{className:"date-box"});return t.innerHTML='<div class="date" data-chat-date=\''+e+"'>"+e+"</div>\n    ",t}function getUserChats(a){var e=db.transaction("addendum"),t=e.objectStore("addendum").index("key"),i=firebase.auth().currentUser.phoneNumber,n=IDBKeyRange.only(i+a.mobile),o=firebase.auth().currentUser.photoURL||"./img/empty-user.jpg",r=document.getElementById("content"),c=document.createDocumentFragment(),s="",l="",d="";t.openCursor(n).onsuccess=function(e){var t=e.target.result;if(t){t.value.user===i?(s="me",image=o):(s="them",image=a.photoURL||"./img/empty-user.jpg");var n=getHumanDateString(moment(t.value.timestamp));n!==l&&c.appendChild(dateBox(n)),l=n,t.value.isComment?c.appendChild(messageBox(t.value.comment,s,t.value.timestamp)):c.appendChild(actionBox(t.value,s)),d=t.value.timestamp,t.continue()}},e.oncomplete=function(){r.innerHTML="",r.appendChild(c),setBottomScroll(),r.dataset.timestamp=d}}function resetCommentField(e,t,n){e.style.height="72px",t.style.height="56px",n.style.height="auto"}function setBottomScroll(){var e=document.querySelector(".conversation-container");e&&(e.scrollTop=e.scrollHeight)}function createElement(e,t){var n=document.createElement(e);return t&&Object.keys(t).forEach(function(e){n[e]=t[e]}),n}function createFab(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],a=createElement("button",{className:"mdc-fab  mdc-button--raised",id:t});n&&a.classList.add("app-fab--absolute");var i=createElement("span",{className:"mdc-fab__icon material-icons",textContent:e});return a.appendChild(i),new mdc.ripple.MDCRipple(a),setTimeout(function(){a.classList.remove("mdc-fab--exited")},200),a}function actionButton(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=arguments[2],a=createElement("div",{className:"action-button-container"}),i=createElement("div",{className:"submit-button-cont"}),o=void 0;return(o=n?createElement("a",{href:n,target:"_blank",textContent:e,className:"mdc-button mdc-button--raised submit-btn",id:t}):createButton(e,t)).classList.add("submit-btn","mdc-button--raised"),new mdc.ripple.MDCRipple(o),i.appendChild(o),a.appendChild(i),a}function createExtendedFab(e,t,n,a,i){var o=createElement(i?"a":"button",{className:"mdc-fab mdc-fab--extended mdc-button--raised mdc-fab-custom",id:n});return i&&(o.href=i),a&&o.classList.add("app-fab--absolute"),o.innerHTML='\n                   <span class="material-icons mdc-fab__icon">'+e+'</span>\n                   <span class="mdc-fab__label">'+t+'</span>\n                   <div class="mdc-fab__ripple"></div>\n                   ',new mdc.ripple.MDCRipple(o),o}function createButton(e,t,n){var a=createElement("button",{className:"mdc-button",id:t||""}),i=createElement("span",{className:"mdc-button__label",textContent:e});if(n){var o=createElement("i",{className:"material-icons mdc-button__icon",textContent:n});a.appendChild(o)}return a.appendChild(i),a}function createLi(e){return createElement("li",{className:"mdc-list-item",textContent:e})}function Dialog(e,t,n){this.title=e,this.content=t,this.id=n}function dialogButton(e,t){var n=createElement("button",{className:"mdc-button mdc-dialog__button",type:"button",textContent:e});return n.setAttribute("data-mdc-dialog-action",t),n}function setHeader(e,t){var n=document.getElementById("app-header");n.querySelector("#section-start").innerHTML=e,n.querySelector("#section-end").innerHTML=t;var a=document.getElementById("navigation-tabs");if(history.state&&"appView"===history.state[0]){if(!a){var i=showTabs([{id:"home-icon",icon:"home",name:"Home"},{id:"inbox-icon",icon:"inbox",name:"Inbox"}],"navigation-tabs");n.insertBefore(i,n.querySelector("#main-progress-bar")),appTabBar=new mdc.tabBar.MDCTabBar(i),updateTotalCount()}return switchTabs(appTabBar.foundation_.adapter_.getFocusedTabIndex()),new mdc.topAppBar.MDCTopAppBar(n)}return a&&a.remove(),n.querySelector(".mdc-top-app-bar__row").classList.remove("hidden"),new mdc.topAppBar.MDCTopAppBar(n)}function updateTotalCount(){db.transaction("users").objectStore("users").index("count").getAll().onsuccess=function(e){var t=e.target.result,n=0;if(t.forEach(function(e){n+=e.count}),!(n<=0)){var a=document.querySelector("#inbox-icon .mdc-tab__content");if(a){a.querySelector(".tab-notification")&&a.querySelector(".tab-notification").remove();var i=createElement("span",{className:"mdc-tab__icon tab-notification"}),o=createElement("div",{textContent:n});i.appendChild(o),a.insertBefore(i,a.firstElementChild)}}}}function createSimpleMenu(e,t){return'\n    <div class="mdc-menu mdc-menu-surface" id="'+t+'">\n    <ul class="mdc-list" role="menu" aria-hidden="true" aria-orientation="vertical" tabindex="-1">\n    '+e.map(function(e){return' <li class="mdc-list-item" role="menuitem">\n        <span class="mdc-list-item__graphic mdc-menu__selection-group-icon">\n        <i class=\'material-icons\'>'+e.icon+'</i>\n        </span>\n        <span class="mdc-list-item__text">'+e.name+"</span>\n        </li>"}).join("")+"\n    </ul>\n    </div>\n  "}function menuItemMap(e,t){var n=createElement("li",{className:"mdc-list-item map-menu-item"});n.setAttribute("role","menuitem");var a='<a target="_blank") href=\'comgooglemaps://?center='+t._latitude+","+t._longitude+'\' class="mdc-list-item__text" on>'+e.name+"</span>";return"Android"===native.getName()&&(a="<a href='geo:"+t._latitude+","+t._longitude+"?q="+t._latitude+","+t._longitude+'\' class="mdc-list-item__text">'+e.name+"</a>"),n.innerHTML="<span class=\"mdc-list-item__graphic mdc-menu__selection-group-icon\">\n    <i class='material-icons'>"+e.icon+"</i>\n    </span>\n    "+a,n}function textFieldTelephone(e){return'\n    <div class="'+(e.customClass?e.customClass:"")+" mdc-text-field mdc-text-field--outlined  mt-10 "+(e.disabled?"mdc-text-field--disabled":"")+" "+(e.label?"":"mdc-text-field--no-label")+"\" id='"+e.id+"'>\n    <input class=\"mdc-text-field__input\" value='"+(e.value||"")+"' type='tel' "+(e.disabled?"disabled":"")+" "+(e.required?"required":"")+'>\n    <div class="mdc-notched-outline">\n    <div class="mdc-notched-outline__leading"></div>\n    '+(e.label?'<div class="mdc-notched-outline__notch">\n    <label for=\'email\' class="mdc-floating-label mdc-floating-label--float-above ">'+e.label+"</label>\n    </div>":"")+'\n    <div class="mdc-notched-outline__trailing"></div>\n    </div>\n    </div>\n    '}function textField(e){var t=createElement("div",{className:"mdc-text-field mdc-text-field--outlined full-width",id:e.id});return e.trailingIcon&&t.classList.add("mdc-text-field--with-trailing-icon"),e.leadingIcon&&t.classList.add("mdc-text-field--with-leading-icon"),t.innerHTML="\n    "+(e.leadingIcon?'<i class="material-icons mdc-text-field__icon" tabindex="0" role="button">'+e.leadingIcon+"</i>":"")+"\n    <input autocomplete="+(e.autocomplete?e.autocomplete:"off")+' type="'+(e.type||"text")+'" class="mdc-text-field__input" value="'+(e.value||"")+'" '+(e.required?"required":"")+" "+(e.disabled?"disabled":"")+" "+(e.readonly?"readonly":"")+" >\n    "+(e.trailingIcon?'<i class="material-icons mdc-text-field__icon" tabindex="0" role="button">'+e.trailingIcon+"</i>":"")+'\n    \n    <div class="mdc-notched-outline '+(e.label?"":"mdc-notched-outline--no-label")+'">\n      <div class="mdc-notched-outline__leading"></div>\n      <div class="mdc-notched-outline__notch">\n        <label  class="mdc-floating-label">'+(e.label?e.label:"")+'</label>\n      </div>\n      <div class="mdc-notched-outline__trailing"></div>\n    </div>\n  ',t}function textFieldWithHelper(e){var t=createElement("div",{className:"text-field-container"});e.classList&&e.classList.forEach(function(e){t.classList.add(e)}),t.appendChild(textField(e));var n=createElement("div",{className:"mdc-text-field-helper-line"});return n.innerHTML='  <div class="mdc-text-field-helper-text mdc-text-field-helper-text--validation-msg"></div>',t.appendChild(n),t}function textAreaWithHelper(e){var t=createElement("div",{className:"text-field-container"});return e.classList&&e.classList.forEach(function(e){t.classList.add(e)}),t.innerHTML="\n    "+textArea(e)+'\n    <div class="mdc-text-field-helper-line">\n      <div class="mdc-text-field-helper-text mdc-text-field-helper-text--validation-msg"></div>\n    </div>\n',t}function textArea(e){return'<div class="mdc-text-field mdc-text-field--textarea" id="'+e.id+'">\n    <textarea  class="mdc-text-field__input" rows="4" cols="40" required="'+e.required+'"></textarea>\n    <div class="mdc-notched-outline">\n      <div class="mdc-notched-outline__leading"></div>\n      <div class="mdc-notched-outline__notch">\n        <label for="textarea" class="mdc-floating-label">'+e.label+'</label>\n      </div>\n      <div class="mdc-notched-outline__trailing"></div>\n    </div>\n  </div>'}function createRadio(e,t){var n=createElement("div",{className:"mdc-radio",id:e});return n.innerHTML='<input class="mdc-radio__native-control" type="radio" id="'+t+'" name="radios">\n    <div class="mdc-radio__background">\n        <div class="mdc-radio__outer-circle"></div>\n        <div class="mdc-radio__inner-circle"></div>\n    </div>\n    <div class="mdc-radio__ripple"></div>\n    ',new mdc.radio.MDCRadio(n),n}function createCheckBox(e){return'\n    <div class="mdc-form-field">\n  <div class="mdc-checkbox">\n    <input type="checkbox"\n           class="mdc-checkbox__native-control"\n           id='+e+'/>\n    <div class="mdc-checkbox__background">\n      <svg class="mdc-checkbox__checkmark"\n           viewBox="0 0 24 24">\n        <path class="mdc-checkbox__checkmark-path"\n              fill="none"\n              d="M1.73,12.91 8.1,19.28 22.79,4.59"/>\n      </svg>\n      <div class="mdc-checkbox__mixedmark"></div>\n    </div>\n    <div class="mdc-checkbox__ripple"></div>\n  </div>\n  <label for="'+e+'">'+(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"")+"</label>\n</div>"}Dialog.prototype.create=function(e){var t=createElement("div",{className:"mdc-dialog",role:"alertDialog",id:this.id});t.setAttribute("aria-modal","true"),t.setAttribute("aria-labelledby","Title"),t.setAttribute("aria-describedby","content");var n=createElement("div",{className:"mdc-dialog__container"}),a=createElement("div",{className:"mdc-dialog__surface"}),i=createElement("h2",{className:"mdc-dialog__title"});i.innerHTML=this.title,this.footer=createElement("footer",{className:"mdc-dialog__actions"});var o=createElement("div",{className:"mdc-dialog__content"});this.content instanceof HTMLElement?o.appendChild(this.content):o.innerHTML=this.content,this.title&&a.appendChild(i),a.appendChild(o),"simple"!==e&&(this.cancelButton=createElement("button",{className:"mdc-button mdc-dialog__button",type:"button",textContent:"Close"}),this.cancelButton.setAttribute("data-mdc-dialog-action","close"),this.cancelButton.style.marginRight="auto",this.okButton=createElement("button",{className:"mdc-button mdc-dialog__button",type:"button",textContent:"Okay"}),this.okButton.setAttribute("data-mdc-dialog-action","accept"),this.footer.appendChild(this.cancelButton),this.footer.appendChild(this.okButton),a.appendChild(this.footer)),n.appendChild(a),t.appendChild(n),t.appendChild(createElement("div",{className:"mdc-dialog__scrim"}));var r=document.getElementById("dialog-container");return r.innerHTML="",r.appendChild(t),new mdc.dialog.MDCDialog(t)};var sliderElement,xStart=null,yStart=null,sliderCallback=null;function swipe(e,t){e&&(sliderCallback=t,(sliderElement=e).addEventListener("touchstart",handleTouchStart,!1),e.addEventListener("touchend",handleTouchEnd,!1))}function removeSwipe(){sliderElement&&(sliderElement.removeEventListener("touchstart",handleTouchStart,!1),sliderElement.removeEventListener("touchend",handleTouchEnd,!1),sliderCallback=sliderElement=null)}function handleTouchStart(e){var t=e.touches[0];xStart=t.clientX,yStart=t.clientY}function handleTouchMove(e){if(xStart){var t=e.touches[0].clientX,n=e.touches[0].clientY,a=t-xStart,i=n-yStart,o="";o=Math.abs(a)>Math.abs(i)?0<a?"left":"right":0<i?"up":"down",yStart=xStart=null,sliderCallback(o)}}function handleTouchEnd(e){var t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY,a=t-xStart,i=n-yStart,o="";0==a&&0==i||(o=Math.abs(a)>Math.abs(i)?0<a?"left":"right":0<i?"up":"down",yStart=xStart=null,sliderCallback(o))}function createCheckBoxList(e){return"<li class='mdc-list-item checkbox-list' tabindex=\"-1\">\n    <span class='mdc-list-item__text'>\n        <span class='mdc-list-item__primary-text'>"+e.primaryText.trim()+"</span>\n        <span class='mdc-list-item__secondary-text mdc-theme--primary'>"+e.secondaryText.trim()+'</span>\n    </span>\n    <span class="mdc-list-item__graphic mdc-list-item__meta">\n    <div class="mdc-checkbox">\n        <input type="checkbox"\n                class="mdc-checkbox__native-control"\n                id="demo-list-checkbox-item-'+e.index+'" />\n        <div class="mdc-checkbox__background">\n          <svg class="mdc-checkbox__checkmark"\n                viewBox="0 0 24 24">\n            <path class="mdc-checkbox__checkmark-path"\n                  fill="none"\n                  d="M1.73,12.91 8.1,19.28 22.79,4.59"/>\n          </svg>\n          <div class="mdc-checkbox__mixedmark"></div>\n        </div>\n      </div>\n</span>\n</li>'}function textFieldTelephoneWithHelper(e){var t=createElement("div",{className:"text-field-container"});return e.classList&&e.classList.forEach(function(e){t.classList.add(e)}),t.innerHTML="\n    "+textFieldTelephone(e)+'\n    <div class="mdc-text-field-helper-line">\n      <div class="mdc-text-field-helper-text mdc-text-field-helper-text--validation-msg"></div>\n    </div>\n',t}var shareWidget=function(e,t){var n="Hi "+firebase.auth().currentUser.displayName+"  wants you to use Growthfile to Check-in & collect proof of work without any effort. Download app & login now ",a=createElement("div",{className:"share-widget"}),i=createElement("div",{className:"mdc-typography--body1 mb-10 mt-0",innerHTML:"Invite users to join <span class='mdc-theme--primary bold'>"+t+"</span>"});a.appendChild(i);var o=createElement("div",{className:"link-manager"});o.appendChild(textField({value:e,trailingIcon:"share",readonly:!0}));var r=new mdc.textField.MDCTextField(o.querySelector(".mdc-text-field"));r.trailingIcon_.root_.addEventListener("click",function(){r.focus(),callShareInterface(e,n)});var c=createElement("input",{value:n+e});return document.body.appendChild(c),c.remove(),a.appendChild(o),a},parseURL=function(){var e=window.location.search;if(e)return new URLSearchParams(e)},encodeString=function(e){return encodeURIComponent(e)},callShareInterface=function(e,t){var n={link:e,shareText:t+e,type:"text/plain",email:{cc:"",subject:"Welcome to Growthfile - Hereâs your link to download the app",body:""}};"Android"!==native.getName()?webkit.messageHandlers.share.postMessage(n):AndroidInterface.share(JSON.stringify(n))},copyRegionToClipboard=function(e){e.select(),e.setSelectionRange(0,9999),document.execCommand("copy"),snacks("Link copied","OKay",null,8e3)},linearProgress=function(e){var t=createElement("div",{className:"mdc-linear-progress mdc-linear-progress--indeterminate mdc-linear-progress--closed",id:e});return t.setAttribute("role","progressbar"),t.innerHTML=' <div class="mdc-linear-progress__buffering-dots"></div>\n    <div class="mdc-linear-progress__buffer"></div>\n    <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">\n      <span class="mdc-linear-progress__bar-inner"></span>\n    </div>\n    <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">\n      <span class="mdc-linear-progress__bar-inner"></span>\n    </div>',new mdc.linearProgress.MDCLinearProgress(t)},mdcSelect=function(e){var t=createElement("div",{className:"mdc-select mdc-select--no-label"});return t.innerHTML='<div class="mdc-select__anchor demo-width-class">\n        <i class="mdc-select__dropdown-icon"></i>\n        <div class="mdc-select__selected-text"></div>\n        <div class="mdc-line-ripple"></div>\n    </div>\n    <div class="mdc-select__menu mdc-menu mdc-menu-surface demo-width-class">\n    <ul class="mdc-list">\n        '+e.map(function(e,t){return'<li class="mdc-list-item '+(0==t?"mdc-list-item--selected":"")+'" data-value="'+e+'" aria-selected="'+(0==t?"true":"false")+'">'+e+"</li>"}).join("")+"\n    </ul>",new mdc.select.MDCSelect(t)};function AppKeys(){this.mode="production"}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}AppKeys.prototype.getMode=function(){return this.mode},AppKeys.prototype.getMapKey=function(){return"dev"===this.mode?"AIzaSyB2SuCoyi9ngRIy6xZRYuzxoQJDtOheiUM":"AIzaSyBl6SlzDCW51UEYudI8kFwG41KePOjW7xI"},AppKeys.prototype.getKeys=function(){return"production"===this.mode?{apiKey:"AIzaSyA4s7gp7SFid_by1vLVZDmcKbkEcsStBAo",authDomain:"growthfile-207204.firebaseapp.com",databaseURL:"https://growthfile-207204.firebaseio.com",projectId:"growthfile-207204",storageBucket:"growthfile-207204.appspot.com",messagingSenderId:"701025551237"}:{apiKey:"AIzaSyB2SuCoyi9ngRIy6xZRYuzxoQJDtOheiUM",authDomain:"growthfilev2-0.firebaseapp.com",databaseURL:"https://growthfilev2-0.firebaseio.com",projectId:"growthfilev2-0",storageBucket:"growthfilev2-0.appspot.com",messagingSenderId:"1011478688238",appId:"1:1011478688238:web:707166c5b9729182d81eff",measurementId:"G-R2K1J16PTW"}},AppKeys.prototype.getBaseUrl=function(){return"production"===this.mode?"https://api2.growthfile.com/api/":"https://us-central1-growthfilev2-0.cloudfunctions.net/api/"},AppKeys.prototype.dynamicLinkUriPrefix=function(){return"production"===this.mode?"https://growthfile.page.link":"https://growthfileanalytics.page.link"};var db,EMAIL_REAUTH,firebaseUI,sliderInterval,potentialAlternatePhoneNumbers,firebaseDeepLink,facebookDeepLink,firebaseAnalytics,dom_root=document.getElementById("app-current-panel"),appKey=new AppKeys,progressBar=void 0,snackBar=void 0,appTabBar=void 0,DB_VERSION=33,sliderIndex=1,sliderTimeout=1e4,serverTimeUpdated=!1,updatedWifiAddresses={addresses:{},timestamp:null},isNewUser=!1;function setFirebaseAnalyticsUserId(e){window.AndroidInterface&&window.AndroidInterface.setFirebaseAnalyticsUserId?window.AndroidInterface.setFirebaseAnalyticsUserId(e):window.messageHandlers&&window.messageHandlers.firebaseAnalytics?window.messageHandlers.firebaseAnalytics.postMessage({command:"setFirebaseAnalyticsUserId",id:e}):console.log("No native apis found")}function logFirebaseAnlyticsEvent(e,t){if(e)if(window.AndroidInterface&&window.AndroidInterface.logFirebaseAnlyticsEvent)window.AndroidInterface.logFirebaseAnlyticsEvent(e,JSON.stringify(t));else if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.firebaseAnalytics){var n={name:e,parameters:t,command:"logFirebaseAnlyticsEvent"};window.webkit.messageHandlers.firebaseAnalytics.postMessage(n)}else console.log("No native APIs found.")}function setFirebaseAnalyticsUserProperty(e,t){if(e&&t)if(window.AndroidInterface&&window.AndroidInterface.setFirebaseAnalyticsUserProperty)window.AndroidInterface.setFirebaseAnalyticsUserProperty(e,t);else if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.firebaseAnalytics){var n={command:"setFirebaseAnalyticsUserProperty",name:e,value:t};window.webkit.messageHandlers.firebaseAnalytics.postMessage(n)}else console.log("No native APIs found.")}function parseFacebookDeeplink(e){console.log("fb link ",e);var t=new URL(e),n=new URLSearchParams(t.search);facebookDeepLink=n,firebase.auth().currentUser}function parseDynamicLink(e){var t=new URL(e);firebaseDeepLink=new URLSearchParams(t.search),firebase.auth().currentUser}function linkSharedComponent(e){console.log(e),logFirebaseAnlyticsEvent("share",{method:e,content_type:"text"})}function updatedWifiScans(e){console.log("updated wifi",e);var n={};e.split(",").forEach(function(e){var t=new URLSearchParams(e);t.has("ssid")&&t.delete("ssid"),t.has("macAddress")&&(n[t.get("macAddress")]=!0)}),updatedWifiAddresses.addresses=n,updatedWifiAddresses.timestamp=Date.now()}function imgErr(e){return e.onerror="",e.src="./img/empty-user.jpg",!0}window.addEventListener("error",function(e){this.console.error(e.message),-1<e.message.toLowerCase().indexOf("script error")||"You can't have a focus-trap without at least one focusable element"!==e.message&&handleError({message:"global error :"+e.message,body:{lineno:e.lineno,filename:e.filename,colno:e.colno,error:JSON.stringify({stack:e.error.stack,message:e.error.message})}})});var native=function(){var a="",n="";return{setFCMToken:function(e){console.log("rec ",e);var t=localStorage.getItem("token");console.log("stored token",t),t!==e&&(n=!0),localStorage.setItem("token",e)},getFCMToken:function(){return localStorage.getItem("token")},isFCMTokenChanged:function(){return n},setName:function(e){localStorage.setItem("deviceType",e)},getName:function(){return localStorage.getItem("deviceType")},setIosInfo:function(e){var t=new URLSearchParams(e),n={};t.forEach(function(e,t){n[t]="appVersion"===t?Number(e):e}),(a=n).idbVersion=DB_VERSION},getInfo:function(){if(!this.getName())return!1;var e=JSON.parse(localStorage.getItem("deviceInfo"));return e||("Android"===this.getName()&&((a=getAndroidDeviceInformation()).idbVersion=DB_VERSION),a)}}}();function getAndroidDeviceInformation(){return{id:AndroidInterface.getId(),deviceBrand:AndroidInterface.getDeviceBrand(),deviceModel:AndroidInterface.getDeviceModel(),osVersion:AndroidInterface.getOsVersion(),baseOs:AndroidInterface.getBaseOs(),radioVersion:AndroidInterface.getRadioVersion(),appVersion:Number(AndroidInterface.getAppVersion())}}function preloadImages(e){e.forEach(function(e){(new Image).src=e})}function checkNetworkValidation(){navigator.onLine?startApp():failureScreen({message:"You Are Currently Offline. Please Check Your Internet Connection",icon:"wifi_off",title:"BROKEN INTERNET CONNECTION"},checkNetworkValidation)}function firebaseUiConfig(){return{callbacks:{signInSuccessWithAuthResult:function(e){return document.querySelector(".login-box").classList.add("hidden"),setFirebaseAnalyticsUserId(firebase.auth().currentUser.uid),isNewUser=e.additionalUserInfo.isNewUser,e.additionalUserInfo.isNewUser?firebase.auth().currentUser.getIdTokenResult().then(function(e){isAdmin(e)?(logReportEvent("Sign Up Admin"),setFirebaseAnalyticsUserProperty("isAdmin","true")):logReportEvent("Sign Up");var t={method:firebase.auth.PhoneAuthProvider.PROVIDER_ID},n=firebaseDeepLink||facebookDeepLink;n&&(t.source=n.get("utm_source"),t.medium=n.get("utm_medium"),t.campaign=n.get("utm_campaign")),logFirebaseAnlyticsEvent("sign_up",t)}):(logReportEvent("login"),logFirebaseAnlyticsEvent("login",{method:firebase.auth.PhoneAuthProvider.PROVIDER_ID})),!1},signInFailure:function(e){return handleUIError(e)},uiShown:function(){logFirebaseAnlyticsEvent("auth_page_open",{}),document.querySelector(".login-box").classList.remove("hidden")}},signInFlow:"popup",signInOptions:[{provider:firebase.auth.PhoneAuthProvider.PROVIDER_ID,recaptchaParameters:{type:"image",size:"invisible",badge:"bottomright"},defaultCountry:"IN"}]}}function initializeFirebaseUI(){document.getElementById("app-header").classList.remove("hidden");header=setHeader("<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n  <span class=\"mdc-top-app-bar__title\">Login</span>\n  ",""),(firebaseUI=firebaseui.auth.AuthUI.getInstance()||new firebaseui.auth.AuthUI(firebase.auth())).start(document.getElementById("login-container"),firebaseUiConfig())}function userSignedOut(){progressBar.close(),document.getElementById("dialog-container").innerHTML="",document.getElementById("step-ui").innerHTML="",document.getElementById("app-header").classList.add("hidden"),firebaseUI&&firebaseUI.delete(),dom_root.innerHTML="\n    <div class='slider' id='app-slider' style=\"background-image:url('./img/welcome.jpg')\">\n \n    <div class=\"action-button-container\">\n          <div class=\"submit-button-cont\">\n              <div class='dot-container'>\n                <span class='dot active'></span>\n                <span class='dot'></span>\n                <span class='dot'></span>\n              </div>\n              <button class=\"mdc-button mdc-button--raised submit-btn\" data-mdc-auto-init=\"MDCRipple\"\n                  id='login-btn'>\n                  <div class=\"mdc-button__ripple\"></div>\n                  \n                  <span class=\"mdc-button__label\">Agree & Continue</span>\n              </button>\n          </div>\n        </div>\n    </div>\n  ";var e=document.getElementById("app-slider");new mdc.ripple.MDCRipple(document.getElementById("login-btn")).root_.addEventListener("click",function(){removeSwipe(),dom_root.innerHTML="",history.pushState(["login"],null,null),initializeFirebaseUI()}),sliderInterval=setInterval(function(){e&&sliderSwipe("right")},sliderTimeout),swipe(e,sliderSwipe)}function sliderSwipe(e){"left"===e&&(sliderIndex<=1?sliderIndex=3:sliderIndex--),"right"===e&&(3<=sliderIndex?sliderIndex=1:sliderIndex++),loadSlider(),[].concat(_toConsumableArray(document.querySelectorAll(".dot"))).forEach(function(e,t){e.classList.remove("active"),t==sliderIndex-1&&e.classList.add("active")})}function loadSlider(){var e="";switch(sliderIndex){case 1:e="./img/welcome.jpg";break;case 2:e="./img/proof.jpeg";break;case 3:e="./img/payments.jpeg"}document.getElementById("app-slider")&&(document.getElementById("app-slider").style.backgroundImage="url('"+e+"')")}function loadingScreen(e){dom_root.innerHTML="\n  <div class='splash-content loading-screen' id='loading-screen' style=\"background-image:url('"+e.src+"');\">\n    <div class='text-container' style=\""+("./img/fetching-location.jpg"===e.src?"margin-top:110px":"")+"\"> \n      <div class='text mdc-typography--headline6'>"+(e.text||"")+'</div>\n      <div class="loader">\n        <svg class="circular" viewBox="25 25 50 50">\n          <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="4" stroke-miterlimit="10"/>\n        </svg>\n      </div>\n      </div>  \n  </div>\n  '}function removeLoadingScreen(){document.getElementById("loading-screen")&&document.getElementById("loading-screen").remove()}function startApp(){var a=firebase.auth().currentUser.uid,i=window.indexedDB.open(a,DB_VERSION);i.onupgradeneeded=function(e){switch((db=i.result).onerror=function(){handleError({message:""+db.error.message})},e.oldVersion){case 0:createObjectStores(db,a);break;case 30:createSubscriptionObjectStore(db),createMapObjectStore(db),createCalendarObjectStore(db);break;case 31:var t=i.transaction.objectStore("addendum");t.indexNames.contains("timestamp")||t.createIndex("timestamp","timestamp");break;case 32:var n=i.transaction.objectStore("users");n.openCursor().onsuccess=function(e){var t=e.target.result;t&&(delete t.value.count,n.put(t.value),t.continue())};default:console.log("version upgrade")}},i.onsuccess=function(){console.log("request success"),db=i.result,console.log("run app"),regulator().then(console.log).catch(function(e){if("geolocation"===e.type)return handleLocationError(e);contactSupport()})},i.onerror=function(){handleError({message:""+i.error.name,body:JSON.stringify(i.error.message)})}}function getDeepLink(){return firebaseDeepLink||(facebookDeepLink||(isNewUser?new URLSearchParams("?utm_source=organic"):null))}function regulator(){var n=getDeepLink(),a=native.getInfo();return new Promise(function(e,t){loadingScreen({src:"./img/wait.jpg",text:"Loading ... "}),("dev"===appKey.getMode()&&"localhost"===window.location.host?Promise.resolve():requestCreator("fcmToken",{token:native.getFCMToken()})).then(function(){return n?("get-subscription"===n.get("action")&&loadingScreen({src:"./img/wait.jpg",text:"Adding you in "+n.get("office")}),requestCreator("acquisition",{source:n.get("utm_source"),medium:n.get("utm_medium"),campaign:n.get("utm_campaign"),office:n.get("office")})):Promise.resolve()}).then(function(){return loadingScreen({src:"./img/server.jpg",text:"Connecting to server"}),requestCreator("now")}).then(function(){return serverTimeUpdated=!0,loadingScreen({src:"./img/fetching-location.jpg",text:"Verifying location"}),appLocation(3)}).then(function(e){return handleCheckin(e),"localhost"===window.location.host&&"dev"===appKey.getMode()?Promise.resolve():JSON.parse(localStorage.getItem("deviceInfo"))?Promise.resolve():requestCreator("device",a)}).then(function(){localStorage.setItem("deviceInfo",JSON.stringify(a))}).catch(t)})}function contactSupport(){var e=createElement("div",{style:"position:fixed;bottom:1rem;width:100%;text-align:center"});e.innerHTML="\n  \n  <p class='mdc-typography--headline6 mb-10 mt-0'>Having trouble ? </p>\n  <a class='mdc-typography--subtitle2 mdc-theme--primary' href=\"https://wa.me/918595422858\">Contact support</a>\n  ",dom_root.appendChild(e)}function showErrorMessage(){var e=document.querySelector("#loading-screen .text-container");e&&(e.innerHTML="<p class='mdc-typography--headline6 mb-10 mt-0'>Error occured</p>\n  <div class='mdc-typography--subtitle2 mdc-theme--primary'>Please try again later</div>")}function handleCheckin(n,e){var t=getDeepLink();getCheckInSubs().then(function(e){if(t&&"get-subscription"===t.get("action"))return e[t.get("office")]={attachment:{Comment:{type:"string",value:""},Photo:{type:"base64",value:""}},template:"check-in",office:t.get("office"),schedule:[],venue:["Check-In Location"],status:"PENDING"},ApplicationState.officeWithCheckInSubs=e,void mapView(n);if(!shouldCheckin(n,e))return initProfileView();if(Object.keys(e).length)return ApplicationState.officeWithCheckInSubs=e,mapView(n);Promise.all([firebase.auth().currentUser.getIdTokenResult(),checkIDBCount(["activity","addendum","children","subscriptions","map","attendance","reimbursement","payment"])]).then(function(t){getRootRecord().then(function(e){return 0==e.fromTime?(loadingScreen({src:"./img/update.jpg",text:"Fetching your data"}),void requestCreator("Null").then(function(){handleCheckin(n,!0)})):isAdmin(t[0])||t[1]?initProfileView():noOfficeFoundScreen()})})})}function noOfficeFoundScreen(){dom_root.innerHTML="\n      <div class='message-screen mdc-layout-grid'>\n      <div class='icon-container'>\n        <div class='mdc-theme--primary icons'>\n          <i class='material-icons'>help_outline</i>\n        </div>\n      </div>\n      <div class='text-container'>\n        <h3 class='mdc-typography--headline5 headline mt-0'>No office found </h3>\n        <p class='mdc-typography--body1'>\n          Please contact your administrator\n        </p>\n      </div>\n    </div>\n  "}function initProfileView(){var e=firebase.auth().currentUser;if(e.displayName&&e.photoURL&&e.email)return openReportView();removeLoadingScreen(),document.getElementById("app-header").classList.remove("hidden"),history.pushState(["profileCheck"],null,null),profileCheck()}function miniProfileCard(e,t,n){return"<div class='mdc-card profile-update-init'>\n  \n  <div class='content-area'>\n  <div id='primary-content'>\n  \n  "+e+"\n  </div>\n  </div>\n  "+n+"\n</div>"}function increaseStep(e){var t=e-1;0!=t&&(document.getElementById("step"+t).classList.remove("is-active"),document.getElementById("step"+t).classList.add("is-complete")),document.getElementById("step"+e).classList.add("is-active")}function checkForPhoto(){if(firebase.auth().currentUser.photoURL)return increaseStep(3),void checkForEmail();setHeader('<span class="mdc-top-app-bar__title">Add Photo</span>',""),logReportEvent("Profile Completion Photo"),logFirebaseAnlyticsEvent("profile_completion_photo"),increaseStep(2);dom_root.innerHTML=miniProfileCard('\n\n      <div class=\'photo-container\'>\n      <img src="./img/empty-user.jpg" id="image-update">\n      <button class="mdc-fab mdc-theme--primary-bg" aria-label="Favorite">\n        <span class="mdc-fab__icon material-icons mdc-theme--on-primary">camera</span>\n        <input type=\'file\' accept=\'image/jpeg;capture=camera\' id=\'choose\'>\n      </button>\n      </div>\n  \n      ',' <span class="mdc-top-app-bar__title">Add Your Profile Picture</span>',""),document.getElementById("choose").addEventListener("change",function(e){getImageBase64(e).then(function(e){return requestCreator("backblaze",{imageBase64:document.getElementById("image-update").src=e})}).then(function(){increaseStep(3),checkForEmail()}).catch(function(e){increaseStep(3),checkForEmail(),snacks(e.message)})})}function checkForEmail(){var e=firebase.auth().currentUser;e.email&&e.emailVerified?openReportView():getRootRecord().then(function(e){e.skipEmail?openReportView():(logReportEvent("Profile Completion Email"),logFirebaseAnlyticsEvent("profile_completion_email"),increaseStep(3),emailUpdation(!0,function(){openReportView()}))})}function checkEmptyIdProofs(t){if(!t.idProof)return!0;var e=Object.keys(t.idProof),n=!1;return e.forEach(function(e){t.idProof[e].number&&t.idProof[e].front&&t.idProof[e].back||(n=!0)}),n}function getProfileInformation(){return new Promise(function(o,e){getRootRecord().then(function(i){if(i.aadhar&&i.pan&&i.linkedAccounts)return o(i);requestCreator("profile").then(function(t){var e=firebase.auth().currentUser.uid,n=db.transaction("root","readwrite"),a=n.objectStore("root");a.get(e).onsuccess=function(e){delete(i=e.target.result).idProof,i.linkedAccounts=t.linkedAccounts,i.pan=t.pan,i.aadhar=t.aadhar,a.put(i)},n.oncomplete=function(){return o(i)}}).catch(e)})})}function resizeAndCompressImage(e,t){var n=document.createElement("canvas"),a=new CanvasDimension(e.width,e.height);a.setMaxHeight(screen.height),a.setMaxWidth(screen.width);var i=a.getNewDimension();return n.width=i.width,n.height=i.height,n.getContext("2d").drawImage(e,0,0,i.width,i.height),n.toDataURL("image/jpeg",t)}function CanvasDimension(e,t){this.MAX_HEIGHT="",this.MAX_WIDTH="",this.width=e,this.height=t}function showReLoginDialog(e,t){var n=new Dialog(e,'<h3 class="mdc-typography--headline6 mdc-theme--primary">'+t+"</h3>").create();return n.open(),n.buttons_[1].textContent="RE-LOGIN",n}function getProfileCompletionTabs(){return'<div class="step-container">\n  <div class="progress">\n    <div class="progress-track"></div>\n    <div id="step1" class="progress-step">\n      <i class=\'material-icons\'>person</i>\n    </div>\n    <div id="step2" class="progress-step">\n      <i class=\'material-icons\'>camera</i>\n    </div>\n    <div id="step3" class="progress-step">\n      <i class=\'material-icons\'>email</i>\n    </div>\n\n  </div>\n\n</div>'}function profileCheck(){var e=firebase.auth().currentUser;if(document.getElementById("step-ui").innerHTML=getProfileCompletionTabs(),!e.displayName)return logReportEvent("Profile Completion Name"),logFirebaseAnlyticsEvent("profile_completion_name"),document.getElementById("app-header").classList.remove("hidden"),increaseStep(1),void updateName(function(){checkForPhoto()});increaseStep(2),checkForPhoto()}function areObjectStoreValid(e){for(var t=["map","children","calendar","root","subscriptions","list","users","activity","addendum"],n=0;n<t.length;n++){var a=t[n];if(!e.contains(a))return{"not-present":a,isValid:!1}}return{"not-present":"",isValid:!0}}function getEmployeeDetails(a,i){return new Promise(function(n,e){var t=db.transaction(["children"]).objectStore("children").index(i).getAll(a);t.onsuccess=function(e){var t=e.target.result;return console.log(t),n(t)},t.onerror=function(){return e({message:t.error,body:""})}})}function createObjectStores(e,t){var n=e.createObjectStore("activity",{keyPath:"activityId"});n.createIndex("timestamp","timestamp"),n.createIndex("office","office"),n.createIndex("hidden","hidden"),n.createIndex("template","template"),n.createIndex("status","status");var a=e.createObjectStore("users",{keyPath:"mobile"});a.createIndex("displayName","displayName"),a.createIndex("isUpdated","isUpdated"),a.createIndex("count","count"),a.createIndex("mobile","mobile"),a.createIndex("timestamp","timestamp"),a.createIndex("NAME_SEARCH","NAME_SEARCH");var i=e.createObjectStore("addendum",{autoIncrement:!0});i.createIndex("activityId","activityId"),i.createIndex("user","user"),i.createIndex("key","key"),i.createIndex("timestamp","timestamp"),i.createIndex("KeyTimestamp",["timestamp","key"]),createSubscriptionObjectStore(e),createCalendarObjectStore(e),createMapObjectStore(e);var o=e.createObjectStore("children",{keyPath:"activityId"});o.createIndex("template","template"),o.createIndex("office","office"),o.createIndex("templateStatus",["template","status"]),o.createIndex("officeTemplate",["office","template"]),o.createIndex("employees","employee"),o.createIndex("employeeOffice",["employee","office"]),o.createIndex("team","team"),o.createIndex("teamOffice",["team","office"]),createReportObjectStores(e),createRootObjectStore(e,t,0)}function createCalendarObjectStore(e){e.objectStoreNames.contains("calendar")&&e.deleteObjectStore("calendar");var t=e.createObjectStore("calendar",{autoIncrement:!0});t.createIndex("activityId","activityId"),t.createIndex("timestamp","timestamp"),t.createIndex("start","start"),t.createIndex("end","end"),t.createIndex("templateOffice",["template","office"])}function createSubscriptionObjectStore(e){e.objectStoreNames.contains("subscriptions")&&e.deleteObjectStore("subscriptions");var t=e.createObjectStore("subscriptions",{keyPath:"activityId"});t.createIndex("office","office"),t.createIndex("template","template"),t.createIndex("officeTemplate",["office","template"]),t.createIndex("validSubscription",["office","template","status"]),t.createIndex("templateStatus",["template","status"]),t.createIndex("status","status"),t.createIndex("report","report")}function createMapObjectStore(e){e.objectStoreNames.contains("map")&&e.deleteObjectStore("map");var t=e.createObjectStore("map",{keyPath:"activityId"});t.createIndex("location","location"),t.createIndex("latitude","latitude"),t.createIndex("longitude","longitude"),t.createIndex("byOffice",["office","location"]),t.createIndex("bounds",["latitude","longitude"]),t.createIndex("office","office"),t.createIndex("status","status")}function createReportObjectStores(e){if(!e.objectStoreNames.contains("attendance")){var t=e.createObjectStore("attendance",{keyPath:"id"});t.createIndex("key","key"),t.createIndex("date","date"),t.createIndex("month","month"),t.createIndex("office","office"),t.createIndex("attendance","attendance")}if(!e.objectStoreNames.contains("payment")){var n=e.createObjectStore("payment",{keyPath:"id"});n.createIndex("key","key"),n.createIndex("date","date"),n.createIndex("month","month"),n.createIndex("year","year"),n.createIndex("status","status"),n.createIndex("office","office")}if(!e.objectStoreNames.contains("reimbursement")){var a=e.createObjectStore("reimbursement",{keyPath:"id"});a.createIndex("key","key"),a.createIndex("date","date"),a.createIndex("month","month"),a.createIndex("year","year"),a.createIndex("office","office")}}function createRootObjectStore(e,t,n){e.createObjectStore("root",{keyPath:"uid"}).put({uid:t,fromTime:n,location:""})}function redirect(){firebase.auth().signOut().then(function(){window.location="https://www.growthfile.com"}).catch(function(e){console.log(e),window.location="https://www.growthfile.com",handleError({message:e+" from redirect"})})}function getCheckInSubs(){return new Promise(function(e){var n={},t=db.transaction("subscriptions");t.objectStore("subscriptions").index("templateStatus").openCursor(IDBKeyRange.bound(["check-in","CONFIRMED"],["check-in","PENDING"])).onsuccess=function(e){var t=e.target.result;t&&(t.value.attachment&&t.value.venue&&t.value.schedule&&(n[t.value.office]?n[t.value.office].timestamp<=t.value.timestamp&&(n[t.value.office]=t.value):n[t.value.office]=t.value),t.continue())},t.oncomplete=function(){return delete n.xanadu,e(n)}})}function checkIDBCount(i){return new Promise(function(e,t){var n=0,a=db.transaction(i);i.forEach(function(e){if(db.objectStoreNames.contains(e)){var t=a.objectStore(e).count();t.onsuccess=function(){n+=t.result}}}),a.oncomplete=function(){return e(n)},a.onerror=function(){return t({message:a.error.message,body:a.error})}})}function openReportView(){document.getElementById("step-ui").innerHTML="",history.pushState(["appView"],null,null),getCurrentJob().then(function(e){e.activityId&&(e.isActive=!0),history.pushState(["jobView",e],null,null),jobView(e)})}function fillVenueInSub(e,t){var n=e.venue[0];return e.venue=[{geopoint:{latitude:t.latitude||"",longitude:t.longitude||""},location:t.location||"",address:t.address||"",venueDescriptor:n}],e}function reloadPage(){window.location.reload(!0)}function shouldCheckin(e,t){ApplicationState.officeWithCheckInSubs=t;var n=JSON.parse(localStorage.getItem("ApplicationState"));if(!n)return!0;if(!n.lastCheckInCreated)return!0;var a=isLastLocationOlderThanThreshold(n.lastCheckInCreated,300),i=isLocationMoreThanThreshold(calculateDistanceBetweenTwoPoints(n.location,e));return!(!a&&!i)||(ApplicationState=n,!1)}function isNewJob(e){var t=JSON.parse(localStorage.getItem("ApplicationState"));if(!t)return!0;if(!t.lastCheckInCreated)return!0;var n=isToday(t.lastCheckInCreated),a=isLocationMoreThanThreshold(calculateDistanceBetweenTwoPoints(t.location,e));return!n||!!a}function isToday(e){return moment(e).isSame(moment().clone().startOf("day"),"d")}window.onpopstate=function(e){e.state&&(!{mapView:!0,userSignedOut:!0,profileCheck:!0,login:!0,share:!0,addView:!0}[e.state[0]]?"showRating"!==e.state[0]&&("emailUpdation"!==e.state[0]&&"emailVerificationWait"!==e.state[0]?window[e.state[0]]&&window[e.state[0]](e.state[1]):history.go(-1)):history.replaceState(["appView"],null,null))},window.addEventListener("load",function(){(firebase.initializeApp(appKey.getKeys()),progressBar=new mdc.linearProgress.MDCLinearProgress(document.querySelector("#app-header .mdc-linear-progress")),snackBar=new mdc.snackbar.MDCSnackbar(document.querySelector(".mdc-snackbar")),topBar=new mdc.topAppBar.MDCTopAppBar(document.querySelector(".mdc-top-app-bar")),window.Worker||window.indexedDB)?(preloadImages(["./img/fetching-location.jpg","./img/wait.jpg","./img/server.jpg","./img/update.jpg","./img/fetching.jpg"]),firebase.auth().onAuthStateChanged(function(e){if(!e)return logReportEvent("IN Slider"),history.pushState(["userSignedOut"],null,null),void userSignedOut();clearInterval(sliderInterval);var t=new mdc.topAppBar.MDCTopAppBar(document.getElementById("app-header"));return t.listen("MDCTopAppBar:nav",handleNav),t.root_.classList.add("hidden"),"production"!==appKey.getMode()||native.getInfo()?(dom_root.classList.remove("hidden"),EMAIL_REAUTH?(history.pushState(["jobs"],null,null),history.pushState(["profileView"],null,null),history.pushState(["emailUpdation"],null,null),void emailUpdation(!1,function(){EMAIL_REAUTH=!1,history.back()})):(localStorage.setItem("error",JSON.stringify({})),localStorage.removeItem("storedLinks"),void checkNetworkValidation())):redirect()})):new Dialog("App Incompatiblity","Growthfile  is incompatible with this device").create().open()}),CanvasDimension.prototype.setMaxWidth=function(e){this.MAX_WIDTH=e},CanvasDimension.prototype.setMaxHeight=function(e){this.MAX_HEIGHT=e},CanvasDimension.prototype.getNewDimension=function(){return this.width>this.height?this.width>this.MAX_WIDTH&&(this.height*=this.MAX_WIDTH/this.width,this.width=this.MAX_WIDTH):this.height>this.MAX_HEIGHT&&(this.width*=this.MAX_HEIGHT/this.height,this.height=this.MAX_HEIGHT),{width:this.width,height:this.height}};_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function jobView(e){progressBar.close();var t=e;dom_root.classList.add("mdc-top-app-bar--fixed-adjust"),dom_root.innerHTML="",setHeader("<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a><span class=\"mdc-top-app-bar__title\" >"+e.activityName+"</span>","").root_.classList.remove("hidden"),getCustomerPhoneNumber(t.attachment.Location.value).then(function(e){console.log(t),t.customerPhonenumber=e,dom_root.appendChild(constructJobView(t))})}function getCurrentJob(){return new Promise(function(e,t){var n=ApplicationState.selectedOffice,a=db.transaction("activity"),i=a.objectStore("activity"),o=firebase.auth().currentUser,r={activityName:"DUTY",attachment:{"Duty Type":{value:"",type:"duty"},Location:{value:ApplicationState.venue?ApplicationState.venue.location:""},Include:{value:""},Supervisor:{value:""},Products:{value:[{name:"",rate:"",date:"",quanity:""}]}},checkins:[],calls:[],creator:{phoneNumber:"",displayName:"",photoURL:""},office:ApplicationState.selectedOffice,template:"duty",schedule:[{startTime:Date.now(),endTime:Date.now(),name:"Date"}],assignees:[{displayName:o.displayName,photoURL:o.photoURL,phoneNumber:o.phoneNumber}],venue:[],canEdit:!1,supervisior:null,isActive:!1,timestamp:Date.now()},c=IDBKeyRange.bound(moment().startOf("day").valueOf(),moment().endOf("day").valueOf());i.index("timestamp").openCursor(c).onsuccess=function(e){var t=e.target.result;t&&(t.value.office===n&&"duty"===t.value.template&&isToday(t.value.schedule[0].startTime)&&ApplicationState.venue&&t.value.attachment.Location.value===ApplicationState.venue.location&&0!=t.value.isActive&&(console.log("matched location with duty location"),r=t.value),t.continue())},a.oncomplete=function(){console.log(r),e(r)}})}function handleFinishedDuty(e){document.querySelector("#time-clock").innerHTML=e.timer.time}function createAppHeader(){var e=setHeader('\n    <span class="mdc-top-app-bar__title">OnDuty</span>\n    ','<div class="mdc-menu-surface--anchor">\n        <button class="material-icons mdc-top-app-bar__action-item mdc-icon-button" aria-label="Profile" id=\'settings-icon\'>more_vert</button>\n        <div class="mdc-menu mdc-menu-surface" id=\'app-menu\'>\n            <ul class="mdc-list" role="menu" aria-hidden="true" aria-orientation="vertical" tabindex="-1">\n                <li class="mdc-list-item" role="menuitem" data-type=\'settings\'>\n                    <span class="mdc-list-item__text">Settings</span>\n                </li>\n            </ul>\n        </div>\n    </div>');e.root_.classList.remove("hidden");var t=new mdc.menu.MDCMenu(e.root_.querySelector(".mdc-menu-surface"));return document.getElementById("settings-icon").addEventListener("click",function(){t.open=!0,t.listen("MDCMenu:selected",function(e){if(console.log(e),"settings"==e.detail.item.dataset.type)return history.pushState(["profileScreen"],null,null),void profileScreen();if("share"==e.detail.item.dataset.type){var t=JSON.parse(e.detail.item.dataset.offices);if(1==t.length)return void giveSubscriptionInit(t[0]);var n=new Dialog("Choose office",officeSelectionList(t),"choose-office-subscription").create("simple"),a=new mdc.list.MDCList(document.getElementById("dialog-office"));bottomDialog(n,a),a.listen("MDCList:action",function(e){n.close(),giveSubscriptionInit(t[e.detail.index])})}})}),e}function getCustomerPhoneNumber(o){return new Promise(function(n,e){var a=db.transaction(["map","activity"]),t=a.objectStore("map"),i=void 0;t.index("location").get(o).onsuccess=function(e){var t=e.target.result;if(!t)return n("");a.objectStore("activity").get(t.activityId).onsuccess=function(e){(i=e.target.result)?n(i.attachment["First Contact"].value||i.attachment["Second Contact"].value):n("")}}})}function getSupervisorContact(a){return new Promise(function(e,t){var n=db.transaction("users");n.objectStore("users").get(a).onsuccess=function(e){record=e.target.result},n.oncomplete=function(){e(record)}})}function createDutyRejection(){var e=createElement("div",{className:"full-width"}),t=textAreaWithHelper({label:"Reason",required:!0}),n=new mdc.textField.MDCTextField(t.querySelector(".mdc-text-field"));n.root_.classList.add("full-width");var a=createButton("submit");return a.classList.add("mdc-button--raised","full-width"),a.addEventListener("click",function(){a.toggleAttribute("disabled"),n.value.trim()?(setHelperValid(n),appLocation(3).then(function(e){return requestCreator("comment",{comment:n.value.trim()},e)}).then(function(){document.getElementById("dialog-container").innerHTML="",a.toggleAttribute("disabled")}).catch(function(){a.toggleAttribute("disabled")})):setHelperInvalid(n,"Please give a reason")}),e.appendChild(t),e.appendChild(a),e}function showUpcomingDuty(e){var t=createElement("div",{className:"duty-pop--container"}),n=createElement("div",{className:"inline-flex full-width"}),a=createElement("div",{className:"reason--container mt-20 hidden"}),i=createElement("i",{className:"material-icons close-popup",textContent:"close",style:"margin-left:auto"});i.setAttribute("data-mdc-dialog-action","close"),n.appendChild(i),t.appendChild(n),t.appendChild(a);var o=createElement("div",{className:"duty-popup--details"});o.innerHTML="\n    <div class='details'>\n        <span class='inline-flex mb-10 mt-20'>\n            <i class='material-icons mdc-theme--primary'>directions_bike</i>\n            <span class='ml-10'>"+e.distance+" Km</span>\n        </span>\n        <span class='inline-flex mb-10 mt-20'>\n            <i class='material-icons mdc-theme--primary'>hourglass_top</i>\n            <span class='ml-10'>"+getTimeToReach(e.distance,20)+"</span>\n        </span>\n        <hr>\n        <div class='customer mt-10'>\n            <div class='inline-flex mt-10 mb-10 full-width mdc-theme--primary'>\n                <i class='material-icons'>location_on</i>\n                <span class='ml-10'>"+e.attachment.Location.value+" </span>\n            </div>\n            "+(e.attachment["Duty Type"].value?"<div class='inline-flex mt-10 mb-10 full-width mdc-theme--primary'>\n                <i class='material-icons'>assignment</i>\n                <span class='ml-10'>"+e.attachment["Duty Type"].value+" </span>\n            </div>":"")+"\n        </div>\n        <hr>\n        <div class='supervisior'>\n            "+(e.supervisiorContact?"<ul class='mdc-list mdc-list--two-line mdc-list--avatar-list'>\n            <li class='mdc-list-item pl-0'>\n               \n                    <img class='mdc-list-item__graphic' src='"+(e.supervisiorContact.photoURL||"./img/empty-user.jpg")+"'>\n                    \n                    <span class='mdc-list-item__text'>\n                        <span class='mdc-list-item__primary-text'>"+(e.supervisiorContact.displayName||e.supervisiorContact.mobile)+"</span>\n                        <span class=\"mdc-list-item__secondary-text\">Supervisor</span>\n                    </span>\n                    <a class='mdc-list-item__meta material-icons' href='tel:"+e.supervisiorContact.mobile+"'>phone</a>\n            </li>\n        </ul>":"")+"\n           \n            <span class='inline-flex mt-10 mb-10 full-width'>\n                <i class='material-icons mdc-theme--primary'>access_time</i>\n                <span class='ml-10'>"+moment(e.schedule[0].startTime).format("hh:mm A")+" to "+moment(e.schedule[0].endTime).format("hh:mm A")+" </span>\n            </span>\n        </div>\n        "+(e.assignees.length?" <hr><div class='staff mdc-theme--primary'>\n            <span class='inline-flex mt-10 mb-10 full-width'>\n                <i class='material-icons'>group</i>\n                <span class='ml-10'>Staffs</span>\n            </span>\n            <div class='mdc-chip-set'>\n                "+e.assignees.map(function(e,t){var n=createElement("img",{className:"mdc-chip__icon mdc-chip__icon--leading",src:e.photoURL||"./img/empty-user.jpg"});return createDynamicChips(e.displayName||e.mobile,t,n).outerHTML}).join("")+"\n                </div>\n            </div>":"")+"\n        \n        "+(checkProductLength(e.attachment.Products.value)?"<hr><div class='products'>\n            <span class='inline-flex mt-10 mb-10 full-width'>\n                <i class='material-icons'>settings</i>\n                <span class='ml-10'>Products</span>\n            </span>\n            <ul class='mdc-list mdc-list--two-line'>\n            "+e.attachment.Products.value.map(function(e){return"<li class='mdc-list-item'>\n                    <span class='mdc-list-item__text'>\n                        <span class='mdc-list-item__primary-text'>"+e.name+"</span>\n                        <span class='mdc-list-item__secondary-text'>Quantity : "+e.quanity+"</span>\n                    </span>\n                    <span class='mdc-list-item__meta'>"+convertNumberToINR(Number(e.rate))+"</span>\n                </li>"})+"\n            </ul>\n        </div>":"")+"\n    </div>\n    <div class='navigate text-center mt-10'>\n        "+createExtendedFab("navigation","Navigate","navigate","","https://www.google.com/maps/dir/?api=1&origin="+ApplicationState.location.latitude+"%2C"+ApplicationState.location.longitude+"&destination="+e.coords.latitude+"%2C"+e.coords.longitude).outerHTML+"\n    </div>\n    ",t.appendChild(o);var r=new Dialog("",t,"duty-dialog").create("simple");r.open(),r.scrimClickAction="",r.content_.querySelector("#navigate").setAttribute("data-mdc-dialog-action","accept"),console.log(r)}function getTimeToReach(e,t){var n=e/t;return n<1?40*n.toFixed(1)+" minutes":n.toFixed(1)+" Hours"}function dutyScreen(e){var t=createElement("div",{className:"duty-container"});return t.innerHTML="\n  \n    <div class='mdc-card duty-overview'>\n       <div class='duty-details pt-10'>\n           <div class='customer'>\n               <div class='location full-width mb-10'>\n                   <div class='icon' style='float:left;'>\n                       <i class='material-icons mdc-theme--primary'>location_on</i>\n                   </div>\n                   <div class='text mdc-typography--headline6 ml-10'>\n                      "+(e.attachment.Location.value||"-")+"\n                    </div>\n                </div>\n                "+(e.customerPhonenumber?"\n                    <span class='inline-flex mb-10 customer-contact'>\n                    <i class='material-icons mdc-theme--secondary'>phone</i>\n                    <span class='mdc-typography--headline6 ml-10'>\n                        <a href='tel:"+e.customerPhonenumber+"'>"+e.customerPhonenumber+"</a>\n                    </span>\n                </span>":"")+"            \n           </div>\n           <div class='full-width mb-10 mt-10 counter-container text-center'>\n                \n        \n                "+(e.isActive?"\n                <div class='mdc-typography--headline6 bold' style='color:#7C909E;'>Duty started "+(e.creator.phoneNumber?"":"at "+formatCreatedTime(e.schedule[0].startTime))+"</div>\n                <div id='time-clock' class='mdc-typography--headline3 bold mb-10' data-id=\""+e.activityId+"\"></div>\n                <div class='finish-button--container mt-20'>\n                        "+createExtendedFab("close","Finish duty","finish").outerHTML+"\n                </div>":"")+" \n           </div>\n           <span class='inline-flex'>\n            <i class='material-icons  mdc-theme--secondary'>access_time</i>\n            <span class='mdc-typography--body1 ml-10'>"+formatCreatedTime(e.schedule[0].startTime)+" - "+formatCreatedTime(e.schedule[0].endTime)+"</span>\n        </span>\n           "+(e.attachment["Duty Type"].value?"<div class='duty-type'>\n                <span class='inline-flex mb-10'>\n                    <i class='material-icons mdc-theme--secondary'>assignment</i>\n                    <span class='mdc-typography--headline6 ml-10'>"+(e.attachment["Duty Type"].value||"-")+" </span>\n                </span>\n            </div>":"")+"\n           <div class='staff mt-10'>\n                <span class='inline-flex'>\n                    <i class='material-icons mdc-theme--secondary'>group_add</i>\n                    <span class='mdc-typography--headline6 ml-10'>Staff</span>\n                </span>\n                <div class=\"mdc-chip-set\" role=\"grid\">\n                    "+viewAssignee(e)+"\n                </div>\n            </div>\n\n           <div class='products'>\n           "+(checkProductLength(e.attachment.Products.value)?"\n               <span class='inline-flex'>\n                   <i class='material-icons mdc-theme--secondary'>settings</i>\n                   <span class='mdc-typography--headline6 ml-10'>Products</span>\n               </span>\n               <ul class='mdc-list mdc-list--two-line'>\n                    "+e.attachment.Products.value.map(function(e){return"<li class='mdc-list-item'>\n                           <span class='mdc-list-item__text'>\n                               <span class='mdc-list-item__primary-text'>"+e.name+"</span>\n                               <span class='mdc-list-item__secondary-text'>Quantity : "+e.quanity+"</span>\n                           </span>\n                           <span class='mdc-list-item__meta'>"+convertNumberToINR(Number(e.rate))+"</span>\n                       </li>"})+"\n               </ul>":"")+"\n           </div>\n       </div>\n   </div>",t}function showDutySchedule(e){return moment(e.schedule[0].startTime).format("hh:mm A")+" to "+moment(e.schedule[0].endTime).format("hh:mm A")}var createImageLi=function(e,t){var n=createElement("li",{className:"mdc-image-list__item"});return n.innerHTML='<div class="mdc-image-list__image-aspect-container">\n                <img class="mdc-image-list__image" src="'+e+'" alt="Text label">\n        </div>\n        <div class="mdc-image-list__supporting">\n            <span class="mdc-image-list__label">'+t+"</span>\n        </div>",n};function constructJobView(e){var t=createElement("div",{className:"mdc-layout-grid job-screen"});t.appendChild(dutyScreen(e));var n=createElement("div",{className:"mdc-card timeline-overview mt-10"}),i=createElement("ul",{className:"mdc-image-list standard-image-list mdc-image-list--with-text-protection"});if(e.hasOwnProperty("checkins")&&(console.log("has photo"),e.checkins.forEach(function(a){if(a.attachment.Photo.value){console.log("has photo");var e=createImageLi(a.attachment.Photo.value,formatCreatedTime(a.timestamp));e.addEventListener("click",function(){var e=createElement("div",{className:"full-width"}),t=createElement("ul",{className:"mdc-list mdc-list--two-line mdc-list--avatar-list pt-0"}),n=createElement("li",{className:"mdc-list-item pl-0 pr-0"});n.innerHTML='<img src="'+(a.creator.photoURL||"./img/empty-user.jpg")+'" class="mdc-list-item__graphic">\n                    <span class="mdc-list-item__text">\n                           <span class="mdc-list-item__primary-text">'+(a.creator.displayName||a.creator.phoneNumber)+'</span>\n                           <span class="mdc-list-item__secondary-text">'+formatCreatedTime(a.timestamp)+"</span>\n                       </span>",t.appendChild(n),e.appendChild(t),a.attachment.Comment.value&&e.appendChild(createElement("p",{className:"mdc-typography--body1 mt-0",textContent:a.attachment.Comment.value})),e.appendChild(createElement("img",{src:a.attachment.Photo.value,style:"width:100%"})),new Dialog("",e).create("").open()}),i.appendChild(e)}})),i.childElementCount?n.appendChild(i):n.appendChild(createElement("div",{className:"mdc-typography--subtitle2 text-center",textContent:"No photos uploaded"})),t.appendChild(n),e.isActive){var a=t.querySelector("#finish");a.classList.add("mdc-button--raised"),a.addEventListener("click",function(){markDutyFinished(e)});var o=createExtendedFab("add_a_photo","Upload photo","",!0);o.style.zIndex="99",o.addEventListener("click",function(){history.pushState(["cameraView"],null,null),openCamera()}),t.appendChild(o)}return t}function markDutyFinished(e){var t=db.transaction("activity","readwrite"),n=t.objectStore("activity");e.isActive=!1,n.put(e),t.oncomplete=function(){successDialog("Duty completed"),history.back()}}function checkProductLength(e){return e.filter(function(e){return e.name}).length}function getTimelineAddendum(r){return new Promise(function(n,e){var t=db.transaction("addendum"),a=t.objectStore("addendum"),i={},o=IDBKeyRange.bound(moment().startOf("day").valueOf(),moment().endOf("day").valueOf());a.index("timestamp").openCursor(o).onsuccess=function(e){var t=e.target.result;t&&("object"===_typeof(t.value.location)&&(isLocationMoreThanThreshold(calculateDistanceBetweenTwoPoints({latitude:t.value.location._latitude,longitude:t.value.location._longitude},r))||(i[t.value.activityId]=t.value)),t.continue())},t.oncomplete=function(){var t=[];console.log(t),Object.keys(i).forEach(function(e){t.push(i[e])});var e=t.sort(function(e,t){return t.timestamp-e.timestamp});n(e)}})}function getTimelineActivityData(o,r){return new Promise(function(e,t){var n=db.transaction("activity"),a=n.objectStore("activity"),i={currentDuty:"",timelineData:[]};o.forEach(function(n){n.activityId&&(a.get(n.activityId).onsuccess=function(e){var t=e.target.result;t&&t.office===r&&(n.timestamp===ApplicationState.lastCheckInCreated&&"duty"===t.template&&(i.currentDuty=t),t.geopoint=n.geopoint,i.timelineData.push(t))})}),n.oncomplete=function(){e(i)}})}function createTimeLapse(e){setHeader("<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n    <span class=\"mdc-top-app-bar__title\">History</span>\n    ","");var t=createElement("div",{className:"timeline"}),n=createElement("div",{className:"history-tl-container"});n.appendChild(e);var a=createElement("div",{className:"timeline--container"});t.appendChild(n),dom_root.innerHTML="",a.appendChild(t);var i=createElement("div",{className:"timeline--footer"}),o=createButton("close");o.classList.add("mdc-button--raised","rounded-close"),o.addEventListener("click",function(){history.back()}),i.appendChild(o),a.appendChild(i),dom_root.appendChild(a)}function createTimelineLi(e){var t=mapTemplateNameToTimelineEvent(e),n=createElement("li",{className:"tl-item "+e.template});n.dataset.activity=JSON.stringify(e);var a=createElement("div",{className:"item-title",textContent:t}),i=createElement("span",{className:"event-time mdc-typography--caption",textContent:moment(e.timestamp).format("hh:mm A")});return n.addEventListener("click",function(){var e=JSON.parse(n.dataset.activity);showViewDialog(createActivityHeading(e),e,"view-form")}),n.appendChild(a),n.appendChild(i),n}function mapTemplateNameToTimelineEvent(e){return"check-in"===e.template?e.attachment.Photo.value?"Uploaded photo":"Check-In":"leave"===e.template?"On leave":"Created "+e.template}function checkForDuty(n){if(!(n.schedule[0].endTime<Date.now())){var e=db.transaction("map");e.objectStore("map").index("location").get(n.attachment.Location.value).onsuccess=function(e){var t=e.target.result;t&&(n.distance=calculateDistanceBetweenTwoPoints(t,ApplicationState.location).toFixed(1),n.coords=t)},e.oncomplete=function(){getSupervisorContact(n.attachment.Supervisor.value).then(function(e){n.supervisiorContact=e,showUpcomingDuty(n)})}}}function getAllCustomer(o){return new Promise(function(e,t){var n=db.transaction("map"),a=n.objectStore("map"),i=[];a.index("office").openCursor(o).onsuccess=function(e){var t=e.target.result;t&&(t.value.location&&t.value.address&&"customer"===t.value.template&&i.push(t.value),t.continue())},n.oncomplete=function(){e(i)}})}function getChildrenActivity(o,r){return new Promise(function(e,t){var n=db.transaction("children"),a=n.objectStore("children"),i=[];a.index("officeTemplate").openCursor([o,r]).onsuccess=function(e){var t=e.target.result;t&&("CANCELLED"!==t.value.status&&i.push(t.value),t.continue())},n.oncomplete=function(){e(i)}})}function showRating(o,r,c){history.pushState(["showRating"],null,null);setHeader("<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n    <span class=\"mdc-top-app-bar__title mdc-typography--headline5 bold\">How was your job ?</span>\n    ","").root_.classList.remove("hidden"),dom_root.innerHTML="\n    <div id='rating-view'>\n        <iframe id='rating-form' src='"+window.location.origin+"/v2/forms/rating/index.html'></iframe>;\n    </div>",Promise.all([getChildrenActivity(o.office,"product"),getSubscription(o.office,"product"),getSubscription(o.office,"customer"),getAllCustomer(o.office)]).then(function(e){var t=e[0],n=e[1],a=e[2],i=e[3];document.getElementById("rating-form").addEventListener("load",function(e){passFormData({name:"init",template:o,body:{products:t,customers:i,customer:r,canEditProduct:n,canEditCustomer:a,dutyId:c},deviceType:native.getName()})})})}function convertNumberToINR(e){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e)}function createProductLi(e,t){var n=createElement("li",{className:"mdc-list-item",textContent:t.name});n.dataset.name=t.name,n.dataset.date=t.date,n.dataset.quantity=t.quantity,n.dataset.rate=t.rate;var a=createElement("span",{className:"mdc-list-item__meta material-icons mdc-theme--primary",textContent:"edit"});a.addEventListener("click",function(){openProductScreen(e,t)});var i=createElement("span",{className:"mdc-list-item__meta material-icons mdc-theme--error ml-20",textContent:"delete"});return i.addEventListener("click",function(){n.remove()}),n.appendChild(a),n.appendChild(i),n}function openProductScreen(e,t){productDialog=new Dialog("New product",createProductScreen(e,t)).create("simple"),productDialog.open()}function createProductScreen(a){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{rate:"",date:"",quantity:"",name:""},t=createElement("div",{className:"product-choose-container"}),i=createProductSelect(a);e.name&&(i.value=e.name);var o=new mdc.textField.MDCTextField(textField({id:"rate",label:"Rate",type:"number",value:e.rate||""})),r=new mdc.textField.MDCTextField(textField({id:"quantity",label:"Quantity",type:"number",value:e.quantity||""})),c=new mdc.textField.MDCTextField(textField({id:"date",type:"date",label:"Date",value:e.data||createDate(new Date)}));t.appendChild(i.root_),t.appendChild(o.root_),t.appendChild(r.root_),t.appendChild(c.root_);var n=createElement("div",{className:"dialog-action-buttons"}),s=createButton("cancel");s.addEventListener("click",function(e){e.preventDefault(),productDialog.close()});var l=createButton("save");return l.classList.add("mdc-button--raised"),n.appendChild(s),n.appendChild(l),l.addEventListener("click",function(e){if(e.preventDefault(),productDialog.close(),i.value){document.querySelector('[data-product-name="'+i.value+'"]')&&document.querySelector('[data-product-name="'+i.value+'"]').remove();var t={rate:Number(o.value),date:c.value,quantity:Number(r.value),name:i.value},n=document.getElementById("product-list");[].concat(_toConsumableArray(n.querySelectorAll("li"))).forEach(function(e){e.dataset.name===i.value&&e.remove()}),n.appendChild(createProductLi(a,t))}else showSnacksApiResponse("Please select a product name")}),t.appendChild(n),t}function appView(){var n=createAppHeader();dom_root.classList.add("mdc-top-app-bar--fixed-adjust"),dom_root.innerHTML="\n        \n        <div class='tabs-section'>\n            <div id='app-tab-content'></div>\n        </div>",appTabBar.listen("MDCTabBar:activated",function(e){switchTabs(e.detail.index)}),appTabBar.activateTab(0),swipe(document.getElementById("app-tab-content"),function(e){var t=appTabBar.foundation_.adapter_.getFocusedTabIndex();"up"!==e?"down"!==e?("right"===e?t++:t--,appTabBar.tabList_[t]?appTabBar.activateTab(t):t=0):n.root_.querySelector(".mdc-top-app-bar__row").classList.add("hidden"):n.root_.querySelector(".mdc-top-app-bar__row").classList.remove("hidden")})}function switchTabs(e){if(document.getElementById("search-btn")&&document.getElementById("search-btn").remove(),document.querySelector(".mdc-top-app-bar__row").classList.remove("hidden"),0==e){var t=document.querySelector('#app-menu ul li[data-type="share"]');return t&&t.remove(),void showAllDuties()}1!=e||chatView()}function showAllDuties(){dom_root.classList.add("mdc-top-app-bar--fixed-adjust"),document.getElementById("app-header").classList.remove("hidden");var e=db.transaction("activity"),t=e.objectStore("activity"),c=createElement("div",{className:"all-duties"}),s=createElement("div",{className:"mdc-list-group"}),l=createElement("ul",{className:"mdc-list mdc-list--two-line mdc-list--avatar-list active-ul mdc-elevation--z6"}),d=createElement("ul",{className:"mdc-list mdc-list--two-line mdc-list--avatar-list duties--ul"}),n=[];t.index("template").openCursor("duty").onsuccess=function(e){var t=e.target.result;t&&(Array.isArray(t.value.schedule)&&t.value.schedule[0].startTime&&t.value.schedule[0].endTime&&n.push(t.value),t.continue())},e.oncomplete=function(){var i=!1,o=!1,e=n.sort(function(e,t){return t.timestamp-e.timestamp}),r=1<Object.keys(ApplicationState.officeWithCheckInSubs).length;getCurrentJob().then(function(n){var a=n.activityId;e.forEach(function(e){var t=dutyDateList(e,a,r);a&&a===e.activityId?(i=!0,n.isActive=!0,t.addEventListener("click",function(){removeSwipe(),history.pushState(["jobView",n],null,null),jobView(n)}),l.appendChild(t),console.log("going to start timer")):(o=!0,t.addEventListener("click",function(){history.pushState(["jobView",e],null,null),jobView(e)}),d.appendChild(t),d.appendChild(createElement("li",{className:"mdc-list-divider"})))}),i&&s.appendChild(createElement("h3",{className:"mdc-list-group__subheader active--subheader",textContent:"Ongoing"})),s.appendChild(l),o&&s.appendChild(createElement("h3",{className:"mdc-list-group__subheader previous--subheader mt-10",textContent:"Previous"})),s.appendChild(d),c.appendChild(s),new mdc.list.MDCList(d)});var t=document.getElementById("app-tab-content");t&&(t.innerHTML="",t.appendChild(c))}}function dutyDateList(e,t,n){var a=createElement("li",{className:"mdc-list-item"});return n&&a.classList.add("mdc-list--with-office"),t===e.activityId&&a.classList.add("active-duty"),a.innerHTML='<span class="mdc-list-item__text full-width">\n      \n        <span class="mdc-list-item__primary-text">\n           \n            '+e.attachment.Location.value+'\n        </span>\n    \n        <span class="mdc-list-item__secondary-text bold duty-list--time">\n            '+formatCreatedTime(e.schedule[0].startTime)+" to "+formatCreatedTime(e.schedule[0].endTime)+"\n        </span>\n        "+(n?'<span class="mdc-list-item__secondary-text duty-list--office full-width">\n        '+e.office+"\n    </span>":"")+"\n   \n    </span>\n    <span class='mdc-list-item__meta material-icons navigate-next'>navigate_next</span>\n    ",new mdc.ripple.MDCRipple(a),a}function createProductSelect(e){var t=createElement("div",{className:"mdc-select full-width"});return t.innerHTML='<i class="mdc-select__dropdown-icon"></i>\n                        <select class="mdc-select__native-control">\n                            '+e.map(function(e){return'<option value="'+e.attachment.Name.value+'">'+e.attachment.Name.value+"</option>"}).join("")+'\n                        </select>\n                        <label class="mdc-floating-label">Choose product</label>\n                        <div class="mdc-line-ripple"></div>',new mdc.select.MDCSelect(t)}function createDate(e){console.log(e);var t=e.getMonth()+1,n=e.getDate();return t<10&&(t="0"+t),n<10&&(n="0"+n),e.getFullYear()+"-"+t+"-"+n}function getDutyStatus(e){var t=Date.now();return e.schedule[0].endTime<t?"Finished":e.schedule[0].startTime>t?"Upcoming":e.schedule[0].startTime<=t&&t<=e.schedule[0].endTime?"Open":void 0}function createTemplateButton(a){var e=createExtendedFab("work_off","Apply leave","",!0);return e.addEventListener("click",function(){if(console.log(a),1==a.length)return history.pushState(["addView"],null,null),void addView(a[0]);var n=new Dialog("Choose office",officeSelectionList(a),"choose-office-subscription").create("simple"),e=new mdc.list.MDCList(document.getElementById("dialog-office"));bottomDialog(n,e),e.listen("MDCList:action",function(e){var t=a[e.detail.index];n.close(),history.pushState(["addView"],null,null),addView(t)})}),e}function getReportSubscriptions(i){return new Promise(function(e,t){var n=[],a=db.transaction("subscriptions");a.objectStore("subscriptions").index("report").openCursor(i).onsuccess=function(e){var a=e.target.result;a&&("CANCELLED"!==a.value.status&&"attendance regularization"!==a.value.template&&(n.forEach(function(e,t,n){e.office===a.value.office&&e.template===a.value.template&&(e.hasOwnProperty("timestamp")&&a.value.hasOwnProperty("timestamp")?e.timestamp<a.value.timestamp&&n.splice(t,1):n.splice(t,1))}),n.push(a.value)),a.continue())},a.oncomplete=function(){console.log(n),e(n)}})}function showTabs(e,t){var n=createElement("div",{className:"mdc-tab-bar",id:t});return n.setAttribute("role","tablist"),n.innerHTML='<div class="mdc-tab-scroller">\n    <div class="mdc-tab-scroller__scroll-area">\n      <div class="mdc-tab-scroller__scroll-content">\n    \n        '+e.map(function(e){return'\n            <button class="mdc-tab" role="tab" aria-selected="false" tabindex="-1" id='+(e.id||"")+'>\n            <span class="mdc-tab__content">\n              <span class="mdc-tab__text-label">'+e.name+'</span>\n              <span class="mdc-tab-indicator">\n                <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>\n              </span>\n            </span>\n            <span class="mdc-tab__ripple"></span>\n          </button>'}).join("")+"\n      </div>\n    </div>\n  </div>",n}function calculateSpeed(e,t){return e/t}function distanceDelta(e,t){return calculateDistanceBetweenTwoPoints(e,t)}function timeDelta(t,n){try{return moment.duration(moment(n).diff(t)).asMinutes()}catch(e){return console.log(e),(n-t)/36e6}}function getStoredLocation(){var e=localStorage.getItem("ApplicationState");if(e)return JSON.parse(e).location}function isLocationOld(e,t){return!!t&&(t.provider===e.provider&&t.latitude===e.latitude&&t.longitude===e.longitude)}function isLocationMoreThanThreshold(e){return.7<=e}function isLastLocationOlderThanThreshold(t,e){try{var n=moment();return e<moment.duration(n.diff(t)).asSeconds()}catch(e){return Math.abs((Date.now()-t)/1e3)}}function toRad(e){return e*Math.PI/180}function calculateDistanceBetweenTwoPoints(e,t){var n=toRad(t.latitude-e.latitude),a=toRad(t.longitude-e.longitude),i=toRad(t.latitude),o=toRad(e.latitude),r=Math.sin(n/2)*Math.sin(n/2)+Math.sin(a/2)*Math.sin(a/2)*Math.cos(i)*Math.cos(o);return 6371*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)))}function GetOffsetBounds(e,t){var n=180/Math.PI;this.latLng=e,this.ratio=t/6378*n,this.radioLon=this.ratio/Math.cos(this.latLng.latitude*Math.PI/180)}function getCellularInformation(){var e=void 0,t=AndroidInterface.getMobileCountryCode(),n=AndroidInterface.getMobileNetworkCode(),a=AndroidInterface.getRadioType(),i=AndroidInterface.getCarrier(),o=AndroidInterface.getWifiAccessPoints();try{e=AndroidInterface.getCellTowerInformation()}catch(e){handleError({message:e.message,body:{mcc:t,mnc:n,radioType:a,carrier:i}})}var r=[],c=[];o&&(r=parseWifiQuery(o)),e&&(c=removeFalseCellIds(parseQuery(e,t,n)));var s={};return t&&(s.homeMobileCountryCode=Number(t)),n&&(s.homeMobileNetworkCode=Number(n)),i&&(s.carrier=i),a&&(s.radioType=a),r.length&&(s.wifiAccessPoints=r),c.length&&(s.cellTowers=c),r.length&&c.length?s.considerIp=!1:s.considerIp=!0,s}function removeFalseCellIds(e){var t=2147483647;return e.filter(function(e){return 0<e.cellId&&e.cellId<t&&0<e.locationAreaCode&&e.locationAreaCode<t})}function parseWifiQuery(e){var a=[];return e.split(",").forEach(function(e){var t=new URLSearchParams(e);if(t.has("ssid")&&t.delete("ssid"),t.has("macAddress")){var n={};t.forEach(function(e,t){n[t]="macAddress"===t?e:Number(e)}),a.push(n)}}),a}function parseQuery(e,n,a){var i=[];return e.split(",").forEach(function(e){var t=new URLSearchParams(e);i.push(queryPatramsToObject(t,n,a))}),i}function queryPatramsToObject(e,n,a){var i={};return e.forEach(function(e,t){"mobileCountryCode"!==t||0!=Number(e)?"mobileNetworkCode"!==t||0!=Number(e)?i[t]=Number(e):i[t]=Number(a):i[t]=Number(n)}),i}GetOffsetBounds.prototype.north=function(){return this.latLng.latitude+this.ratio},GetOffsetBounds.prototype.south=function(){return this.latLng.latitude-this.ratio},GetOffsetBounds.prototype.east=function(){return this.latLng.longitude+this.radioLon},GetOffsetBounds.prototype.west=function(){return this.latLng.longitude-this.radioLon};var selectedSubs=void 0,ApplicationState=JSON.parse(localStorage.getItem("ApplicationState"))||{location:"",venue:"",knownLocation:!1,iframeVersion:13};function logReportEvent(e){var t=native.getInfo();if("Android"===native.getName()&&14<=t.appVersion)AndroidInterface.logEvent(e);else try{webkit.messageHandlers.logEvent.postMessage(e)}catch(e){console.log(e)}}function failureScreen(e,t){document.getElementById("app-header").classList.add("hidden"),dom_root.innerHTML="\n    <div class=\"center-abs location-not-found\">\n    <i class='material-icons mdc-theme--secondary'>"+(e.icon||"location_off")+"</i>\n    <p class='mdc-typography--headline5'>\n    "+e.title+"\n    </p>\n    <p class='mdc-typography--body1'>\n    "+e.message+'\n    </p>\n    <button class="mdc-button mdc-theme--primary-bg" id=\'try-again\'>\n    <span class="mdc-button__label mdc-theme--on-primary">RETRY</span>\n    </button>\n    </div>',document.getElementById("try-again").addEventListener("click",function(e){document.querySelector(".center-abs.location-not-found").classList.add("hidden"),t()})}function handleLocationError(e){switch(progressBar&&progressBar.close(),passFormData({name:"toggleSubmit",template:"",body:"",deviceType:native.getName()}),e.message){case"THRESHOLD EXCEED":handleCheckin(e.body.geopoint);break;case"BROKEN INTERNET CONNECTION":new Dialog(e.message,"Please Check Your Internet Connection").create().open();break;case"TURN ON YOUR WIFI":new Dialog(e.message,"Enabling Wifi Will Help Growthfile Accurately Detect Your Location").create().open();break;default:handleError({message:e.message,body:{reason:e.body||e,stack:e.stack||""}}),new Dialog("Location Error","There was a problem in detecting your location. Please try again later").create().open()}}function mapView(t){document.getElementById("app-header").classList.add("hidden"),ApplicationState.location=t,history.pushState(["mapView"],null,null),progressBar.close();var e={lat:t.latitude,lng:t.longitude};console.log(e);var n=new GetOffsetBounds(t,1);loadNearByLocations({north:n.north(),south:n.south(),east:n.east(),west:n.west()},t).then(function(e){return dom_root.innerHTML="\n    <div id='map-view'>\n      <div class=\"selection-box-auto\" id='selection-box'>\n          <div class=\"content-body\"></div>\n      </div>\n    </div>",e.length?1==e.length?createKnownCheckIn(e[0],t):void loadCardData(e,t):createUnkownCheckIn(t)})}function createUnkownCheckIn(t){document.getElementById("app-header").classList.add("hidden");var n=Object.keys(ApplicationState.officeWithCheckInSubs);if(ApplicationState.knownLocation=!1,1!=n.length){setHeader('<span class="mdc-top-app-bar__title">Choose company</span>',"","app-header").root_.classList.remove("hidden"),dom_root.classList.add("mdc-top-app-bar--fixed-adjust");var a=createElement("ul",{className:"mdc-list pt-0"});n.forEach(function(e){var t=createList({primaryText:e});a.appendChild(t)}),document.querySelector("#selection-box .content-body").appendChild(a);var e=new mdc.list.MDCList(a);e.singleSelection=!0,e.selectedIndex=0,e.listen("MDCList:action",function(e){console.log(e.detail.index),generateRequestForUnknownCheckin(n[e.detail.index],t)})}else generateRequestForUnknownCheckin(n[0],t)}function generateRequestForUnknownCheckin(a,i){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{subscriptionRetry:0,invalidRetry:0};loadingScreen({src:"./img/fetching-location.jpg",text:"Checking in ..."}),getRootRecord().then(function(e){var t=fetchCurrentTime(e.serverTime),n=JSON.parse(JSON.stringify(ApplicationState.officeWithCheckInSubs[a]));n.share=[],n.timestamp=t,requestCreator("create",fillVenueInSub(n,""),i).then(function(){successDialog("Check-In Created"),ApplicationState.venue="",ApplicationState.selectedOffice=a,localStorage.setItem("ApplicationState",JSON.stringify(ApplicationState)),initProfileView()}).catch(function(e){progressBar.close();var t=getDeepLink();t&&"get-subscription"===t.get("action")&&e.message==="No subscription found for the template: 'check-in' with the office '"+t.get("office")+"'"?o.subscriptionRetry<=2&&setTimeout(function(){o.subscriptionRetry++,generateRequestForUnknownCheckin(a,i,o)},5e3):"Invalid check-in"!==e.message||handleInvalidCheckinLocation(o.invalidRetry,function(e){ApplicationState.location=e,o.invalidRetry++,generateRequestForUnknownCheckin(a,e,o)})})})}function handleInvalidCheckinLocation(e,n){if(e)return reloadPage();if("Android"!==native.getName())try{webkit.messageHandlers.locationService.postMessage("start"),window.addEventListener("iosLocation",function e(t){n(t.detail),window.removeEventListener("iosLocation",e,!0)},!0)}catch(e){failureScreen({message:"There was a problem in detecting your location.",icon:"location_off",title:"Failed To Detect Location"},reloadPage)}else handleGeoLocationApi().then(n).catch(function(e){handleError({message:"Geolocation failed to get data for retry attempt at invalid checkin",body:e}),failureScreen({message:"There was a problem in detecting your location.",icon:"location_off",title:"Failed To Detect Location"},reloadPage)})}function loadCardData(t,n){ApplicationState.knownLocation=!0,setHeader('<span class="mdc-top-app-bar__title">Choose your location</span>',"","app-header").root_.classList.remove("hidden"),dom_root.classList.add("mdc-top-app-bar--fixed-adjust");var e="<ul class='mdc-list mdc-list pt-0 mdc-list--two-line mdc-list--avatar-list' id='selected-venue'>\n  "+t.map(function(e){return""+venueList(e)}).join("")+"\n</ul>";document.querySelector("#selection-box .content-body").innerHTML=e;var a=new mdc.list.MDCList(document.getElementById("selected-venue"));a.singleSelection=!0,a.selectedIndex=0,a.listen("MDCList:action",function(e){console.log(e.detail.index),createKnownCheckIn(t[e.detail.index],n)})}function createKnownCheckIn(n,a){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{subscriptionRetry:0,invalidRetry:0};console.log(n);var e=JSON.parse(JSON.stringify(ApplicationState.officeWithCheckInSubs[n.office]));e.share=[],document.getElementById("app-header").classList.add("hidden"),progressBar.open(),loadingScreen({src:"./img/fetching-location.jpg",text:"Checking in at "+n.location}),requestCreator("create",fillVenueInSub(e,n),a).then(function(){successDialog("Check-In Created"),ApplicationState.venue=n,ApplicationState.selectedOffice=n.office,localStorage.setItem("ApplicationState",JSON.stringify(ApplicationState)),initProfileView()}).catch(function(e){progressBar.close();var t=getDeepLink();t&&"get-subscription"===t.get("action")&&e.message==="No subscription found for the template: 'check-in' with the office '"+t.get("office")+"'"?i.subscriptionRetry<=2&&setTimeout(function(){i.subscriptionRetry++,createKnownCheckIn(n,a,i)},5e3):"Invalid check-in"!==e.message||handleInvalidCheckinLocation(i.invalidRetry,function(e){ApplicationState.location=e,i.invalidRetry++,createKnownCheckIn(n,e,i)})})}function venueList(e){return'<li class=\'mdc-list-item venue-list-item  pl-0 pr-0\'>\n    <span class="mdc-list-item__graphic material-icons" aria-hidden="true">location_on</span>\n    <span class="mdc-list-item__text">\n      <span class="mdc-list-item__primary-text">'+e.location+'</span>\n      <span class="mdc-list-item__secondary-text">'+e.office+'</span>\n    </span>\n    <span class="mdc-list-item__meta material-icons" aria-hidden="true">keyboard_arrow_right</span>\n    </li>\n  \n    '}function toggleCardHeight(e,t){var n=document.getElementById("map-view"),a=document.getElementById(t);e?(n.classList.add("hidden"),a.classList.remove("hidden"),a.style.height="100%",document.getElementById("app-header").classList.add("hidden")):(n.classList.remove("hidden"),document.getElementById("selection-box").classList.remove("hidden"),a.classList.add("hidden"),document.getElementById("app-header").classList.remove("hidden"))}function snapView(e){document.querySelector(e).innerHTML='\n  <div class=\'snap-container\'>\n  <h6 class=\'mdc-typography--headline5 text-center\'>\n    Create a photo check-in\n  </h6>\n  <div class=\'landing-page-container text-center\'>\n    <button class="mdc-fab mdc-fab--extended mdc-theme--primary-bg mdc-theme--on-primary">\n      <div class="mdc-fab__ripple"></div>\n      <span class="material-icons mdc-fab__icon">camera</span>\n      <span class="mdc-fab__label">Take photo</span>\n    </button>\n  </div>\n  </div>\n  ',document.querySelector(".snap-container .mdc-fab").addEventListener("click",openCamera),openCamera()}function openCamera(){"Android"!==native.getName()?webkit.messageHandlers.startCamera.postMessage("setFilePath"):AndroidInterface.startCamera("setFilePath")}function setFilePathFailed(e){snacks(e)}function setFilePath(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{subscriptionRetry:0,invalidRetry:0},n="data:image/jpg;base64,"+e;dom_root.innerHTML='\n  <div class=\'image-container\'>\n    <div id=\'snap\' class="snap-bckg">\n      <div class="form-meta snap-form">\n        <div class="mdc-text-field mdc-text-field--no-label mdc-text-field--textarea" id=\'snap-textarea\'>\n            <textarea\n            class="mdc-text-field__input  snap-text mdc-theme--on-primary" rows="1" cols="100"></textarea></div>\n            <button id=\'snap-submit\' class="mdc-fab app-fab--absolute  snap-fab mdc-theme--primary-bg  mdc-ripple-upgraded"\n          style="z-index: 9;">\n          <svg class="mdc-button__icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/><path d="M0 0h24v24H0z" fill="none"/></svg>\n        </button>\n      </div>\n    </div>\n  </div>\n  ';setHeader("<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n        <span class=\"mdc-top-app-bar__title\">Upload photo</span>\n        ","").root_.classList.remove("hidden");var a=document.getElementById("snap"),i=new mdc.textField.MDCTextField(document.getElementById("snap-textarea")),o=new mdc.ripple.MDCRipple(document.getElementById("snap-submit"));i.focus(),i.input_.addEventListener("keyup",function(){this.style.paddingTop="25px",this.style.height="5px",this.style.height=this.scrollHeight+"px",this.scrollHeight<=300&&(o.root_.style.bottom=this.scrollHeight-20+"px")});var r=new Image;r.onload=function(){var e=getOrientation(r);a.style.backgroundImage="url("+n+")","landscape"!=e&&"sqaure"!=e||(a.style.backgroundSize="contain")},r.src=n,o.root_.addEventListener("click",function(){var e=i.value;sendPhotoCheckinRequest({sub:ApplicationState.officeWithCheckInSubs[ApplicationState.selectedOffice],base64:n,retries:t,textValue:e,knownLocation:!0})})}function sendPhotoCheckinRequest(n){var e=n.base64,t=n.textValue,a=n.retries,i=JSON.parse(JSON.stringify(n.sub));i.attachment.Photo.value=e||"",i.attachment.Comment.value=t,i.share=[],history.back(),requestCreator("create",fillVenueInSub(i,ApplicationState.venue),ApplicationState.location).then(function(){successDialog("Photo uploaded")}).catch(function(e){var t=getDeepLink();t&&"get-subscription"===t.get("action")&&e.message==="No subscription found for the template: 'check-in' with the office '"+t.get("office")+"'"?a.subscriptionRetry<=2&&setTimeout(function(){a.subscriptionRetry++,n.knownLocation?createKnownCheckIn(ApplicationState.venue,geopoint,a):createUnkownCheckIn(i.office,geopoint,a)},5e3):"Invalid check-in"!==e.message||handleInvalidCheckinLocation(a.invalidRetry,function(e){ApplicationState.location=e,a.invalidRetry++,setFilePath(base64,a)})})}function mdcDefaultSelect(e,t,n,a){return'<div class="mdc-select" id='+n+'>\n  <i class="mdc-select__dropdown-icon"></i>\n  <select class="mdc-select__native-control">\n  <option disabled selected></option>\n  '+e.map(function(e){return" <option value='"+e+"'>\n    "+e+"\n    </option>"}).join("")+"\n"+a+"\n\n  </select>\n  <label class='mdc-floating-label'>"+t+'</label>\n  <div class="mdc-line-ripple"></div>\n</div>'}function mdcSelectVenue(e,t,n){return'<div class="mdc-select" id='+n+'>\n  <i class="mdc-select__dropdown-icon"></i>\n  <select class="mdc-select__native-control">\n  <option disabled selected value='+JSON.stringify("0")+"></option>\n  <option value="+JSON.stringify("1")+">UNKNOWN LOCATION</option>\n\n  "+e.map(function(e){return" <option value='"+JSON.stringify(e)+"'>\n    "+e.location+"\n    </option>"}).join("")+"\n  \n</select>\n  <label class='mdc-floating-label'>"+t+'</label>\n  <div class="mdc-line-ripple"></div>\n</div>'}function getOrientation(e){return e.width>e.height?"landscape":e.height>e.width?"potrait":e.width==e.height?"square":void 0}function loadNearByLocations(r,c){return new Promise(function(e,t){var n=[],a=db.transaction(["map"]),i=a.objectStore("map").index("bounds"),o=IDBKeyRange.bound([r.south,r.west],[r.north,r.east]);i.openCursor(o).onsuccess=function(e){var t=e.target.result;t&&(ApplicationState.officeWithCheckInSubs[t.value.office]&&(isLocationMoreThanThreshold(calculateDistanceBetweenTwoPoints(c,t.value))||n.push(t.value)),t.continue())},a.oncomplete=function(){return e(n)}})}function profileScreen(){removeSwipe();setHeader("<a class='mdc-top-app-bar__navigation-icon  material-icons'>arrow_back</a>\n  <span class=\"mdc-top-app-bar__title\">Settings</span>","").root_.classList.remove("hidden");var e=firebase.auth().currentUser;dom_root.classList.add("mdc-top-app-bar--fixed-adjust"),dom_root.innerHTML="";var t=createElement("ul",{className:"mdc-list mdc-list--two-line mdc-list--avatar-list"}),n=createElement("li",{className:"mdc-list-item"});n.innerHTML='<img class="mdc-list-item__graphic"  aria-hidden="true" src='+(e.photoURL||"./img/empty-user.jpg")+'  onerror="imgErr(this)">\n  <span class="mdc-list-item__text">\n    <span class="mdc-list-item__primary-text">\n        '+e.displayName+'\n    </span>\n    <span class="mdc-list-item__secondary-text">\n        '+e.phoneNumber+"\n    </span>\n  </span>",new mdc.ripple.MDCRipple(n),n.addEventListener("click",function(){history.pushState(["profileView"],null,null),profileView()}),createList({icon:"account_balance",primaryText:"Bank account",secondaryText:"Add or edit bank accounts"}).addEventListener("click",function(){history.pushState(["bankAccount"],null,null),bankAccount()}),createList({icon:"verified_user",primaryText:"Id proofs",secondaryText:"Aadhar , PAN"}).addEventListener("click",function(){history.pushState(["idProofView"],null,null),idProofView(function(){history.back()})});var a=createList({icon:"help",primaryText:"Help",secondaryText:"Contact us,privacy,FAQ"});a.addEventListener("click",function(){history.pushState(["helpView"],null,null),helpView()}),t.appendChild(n),t.appendChild(createListDivider()),t.appendChild(a),dom_root.appendChild(t)}function helpView(){setHeader("<a class='mdc-top-app-bar__navigation-icon  material-icons'>arrow_back</a>\n  <span class=\"mdc-top-app-bar__title\">Help</span>","");var e=createElement("ul",{className:"mdc-list mdc-list--avatar-list help-list"}),t=createElement("li",{className:"mdc-list-item"});t.innerHTML='\n  <i class="mdc-list-item__graphic material-icons mdc-theme--secondary" aria-hidden="true">help</i>\n  <a href=\'https://wa.me/+918595422858\'>Contact us</a>';var n=createElement("li",{className:"mdc-list-item"});n.innerHTML='\n  <i class="mdc-list-item__graphic material-icons mdc-theme--secondary" aria-hidden="true">question_answer</i>\n  <a href=\'https://growthfile.com/faq\'>FAQ</a>';var a=createElement("li",{className:"mdc-list-item"});a.innerHTML='\n  <i class="mdc-list-item__graphic material-icons mdc-theme--secondary" aria-hidden="true">privacy_tip</i>\n  <a href=\'https://growthfile.com/legal\'>Privacy policy</a>',e.appendChild(t),e.appendChild(createListDivider()),e.appendChild(n),e.appendChild(createListDivider()),e.appendChild(a),dom_root.innerHTML="",dom_root.appendChild(e)}function createList(e){var t=createElement("li",{className:"mdc-list-item"});return t.innerHTML="\n    "+(e.icon?'<i class="mdc-list-item__graphic material-icons mdc-theme--secondary" aria-hidden="true">'+e.icon+"</i>":"")+"\n    "+(e.primaryText&&e.secondaryText?' <span class="mdc-list-item__text">\n      <span class="mdc-list-item__primary-text">\n        '+e.primaryText+'\n      </span>\n       <span class="mdc-list-item__secondary-text">\n        '+e.secondaryText+"\n      </span>":e.primaryText)+"\n      "+(e.meta?"<span class='mdc-list-item__meta material-icons'>"+e.meta+"</span>":"")+"\n    </span>\n  ",new mdc.ripple.MDCRipple(t),t}function createListDivider(){return createElement("li",{className:"mdc-list-divider"})}function profileView(){setHeader("<a class='mdc-top-app-bar__navigation-icon  material-icons'>arrow_back</a>\n  <span class=\"mdc-top-app-bar__title\">Account</span>","");var e='<div class="mdc-card demo-card" id=\'profile-card\'>\n  <div class="mdc-card__primary-action demo-card__primary-action" tabindex="0">\n  \n  <div class="mdc-card__media mdc-card__media--16-9 demo-card__media"\n  style="background-image: url('+(firebase.auth().currentUser.photoURL||"./img/empty-user-big.jpg")+");background-size:contain;\" onerror=\"imgErr(this)\">\n  <button class=\"mdc-fab mdc-fab--mini mdc-theme--primary-bg\" aria-label=\"Favorite\" style=\"\n    position: fixed;\n    top: 1rem;\n    right: 1rem;\">\n      <span class=\"mdc-fab__icon material-icons\">edit</span>\n      <input id='choose-profile-image' type='file' accept='image/jpeg;capture=camera'  class='overlay-text'>\n  </button>\n</div>\n\n<div id='base-details'></div>\n<div id='user-details'></div>  \n\n";dom_root.innerHTML=e,setDetails()}function setDetails(){progressBar.close(),document.getElementById("base-details").innerHTML=createBaseDetails(),new mdc.list.MDCList(document.getElementById("basic-info-edit")),document.getElementById("choose-profile-image").addEventListener("change",function(e){getImageBase64(e).then(function(e){return document.querySelector(".mdc-card__media.mdc-card__media--16-9").style.backgroundImage="url("+e+")",requestCreator("backblaze",{imageBase64:e})}).then(function(){snacks("Profile picture updated"),firebase.auth().currentUser.reload()}).catch(function(e){snacks("Try again later")})})}function createBaseDetails(){var e=firebase.auth().currentUser;return"<div class=\"basic-info seperator\">\n  <ul class='mdc-list' id='basic-info-edit'>\n  <li class='mdc-list-item'>\n  <span class=\"mdc-list-item__graphic material-icons\" aria-hidden=\"true\">account_box</span>\n  "+e.displayName+'\n  <span class="mdc-list-item__meta material-icons mdc-theme--primary" aria-hidden="true" onclick="history.pushState([\'updateName\'],null,null);updateName(function(){history.back()})">edit</span>\n  </li>\n  <li class=\'mdc-list-item\'>\n  <span class="mdc-list-item__graphic material-icons" aria-hidden="true">email</span>\n  '+(e.email||"-")+'\n  <span class="mdc-list-item__meta material-icons mdc-theme--primary" aria-hidden="true" onclick="history.pushState([\'emailUpdation\'],null,null);emailUpdation(false,function(){history.back()})">edit</span>\n  </li>\n  <li class=\'mdc-list-item\'>\n    <span class="mdc-list-item__graphic material-icons" aria-hidden="true">phone</span>\n    '+e.phoneNumber+'\n    <span class="mdc-list-item__meta material-icons mdc-theme--primary" aria-hidden="true" onclick="phoneNumberChangeUI()">edit</span>\n  </li>\n  </ul>\n</div>'}function bankAccount(){getProfileInformation().then(function(e){var t=e.linkedAccounts;console.log(t);var n=firebase.auth().currentUser;setHeader("<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n      <span class=\"mdc-top-app-bar__title\">Bank accounts</span>\n      ",""),dom_root.innerHTML="\n      <ul class='mdc-list mdc-list--two-line' id='bank-list'>\n      "+t.map(function(e,t){return"<li class='mdc-list-item' data-index=\""+t+'">\n            <span class="mdc-list-item__text">\n              <span class="mdc-list-item__primary-text">'+e.bankAccount+'</span>\n              <span class="mdc-list-item__secondary-text">'+e.ifsc+"</span>\n          </span>\n          <span class='mdc-list-item__meta material-icons mdc-theme--error'  data-account=\""+getLast4digitsOfAccount(e.bankAccount)+'">delete</span>\n          </li>'}).join("")+"\n      </ul>\n      ",new mdc.list.MDCList(document.getElementById("bank-list")).selectedIndex=0,[].map.call(document.querySelectorAll(".bank-account-remove"),function(i){i&&i.addEventListener("click",function(){requestCreator("removeBankAccount",{bankAccount:i.dataset.account}).then(function(){var e=firebase.auth().currentUser.uid,t=db.transaction("root","readwrite"),n=t.objectStore("root"),a=void 0;n.get(e).onsuccess=function(e){a=e.target.result;var t=Number(i.parentNode.dataset.index);a.linkedAccounts.splice(t,1),n.put(a)},t.oncomplete=function(){i.parentNode.remove(),snacks("Account removed")}}).catch(function(e){snacks(e.message)})})});var a=actionButton("Add BANK ACCOUNT");a.querySelector(".mdc-button").addEventListener("click",function(){if(!n.email||!n.emailVerified)return history.pushState(["profileScreen"],null,null),void emailUpdation(!0,profileScreen);history.pushState(["addNewBankAccount"],null,null),addNewBankAccount(function(){reloadPage()})}),dom_root.appendChild(a)})}function getLast4digitsOfAccount(e){return e.substr(e.length-4)}function validateIFSC(e){return/^[A-Za-z]{4}[a-zA-Z0-9]{7}$/.test(e)}function addNewBankAccount(t){var o=firebase.auth().currentUser,e="",n="";"profileCheck"===history.state[0]?(e='<span class="mdc-top-app-bar__title">Add bank account</span>',n=createButton("SKIP","skip-header").outerHTML):e="<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n    <span class=\"mdc-top-app-bar__title\">Add Bank Account</span>\n    ",setHeader(e,n),dom_root.innerHTML="\n  <div class='mdc-layout-grid'>\n  <div class='add-bank-container mt-20'>\n    \n    "+(o.email?"":""+textFieldWithHelper({id:"email",label:"Email",disabled:!1,value:"",type:"number",required:!0}).outerHTML)+"\n\n    "+textFieldWithHelper({id:"account-number",label:"Bank account number",disabled:!1,value:"",type:"number",required:!0}).outerHTML+"\n    \n    "+textFieldWithHelper({id:"account-number-re",label:"Re-enter bank account number",disabled:!1,value:"",type:"number",required:!0}).outerHTML+"\n      \n    "+textFieldWithHelper({id:"ifsc",label:"IFSC",disabled:!1,value:"",type:"text",required:!0}).outerHTML+"\n\n          \n    "+textFieldWithHelper({id:"upi",label:"UPI",disabled:!1,value:"",type:"text",required:!0}).outerHTML+"\n\n  </div>\n  </div>\n  "+actionButton("SUBMIT","submit-btn").outerHTML+"\n  ";var a=new mdc.ripple.MDCRipple(document.getElementById("submit-btn"));a.root_.setAttribute("disabled","true");var r={};[].map.call(document.querySelectorAll(".mdc-text-field"),function(e){var t=new mdc.textField.MDCTextField(e);t.input_.addEventListener("paste",function(e){e.preventDefault()}),t.root_.classList.add("full-width"),r[t.label_.root_.textContent]=t}),console.log(r),r["Re-enter bank account number"].input_.addEventListener("input",function(){r["Re-enter bank account number"].value!==r["Bank account number"].value?(setHelperInvalid(r["Re-enter bank account number"],""),a.root_.setAttribute("disabled","true")):(setHelperValid(r["Re-enter bank account number"]),a.root_.removeAttribute("disabled"))}),a.root_.addEventListener("click",function(){for(var e=Object.keys(r),t=0;t<e.length;t++){var n=e[t],a=r[n];if(!a.value)return void setHelperInvalid(a,n+" Cannot Be Empty");a.helperTextContent=""}if(r["Re-enter bank account number"].value===r["Bank account number"].value)if(validateIFSC(r.IFSC.value)){var i={bankAccount:r["Bank account number"].value,ifsc:r.IFSC.value,address1:r.IFSC.value,displayName:o.displayName,email:o.email,upi:r.UPI.value};o.email?createNewAccount(i):emailUpdate(r.Email,function(){createNewAccount(i)})}else setHelperInvalid(r.IFSC,"Invalid IFSC code");else setHelperInvalid(r["Re-enter bank account number"],"Bank account number do not match")});var i=document.getElementById("skip-header");i&&(new mdc.ripple.MDCRipple(i),i.addEventListener("click",function(){if(t){var e=db.transaction("root","readwrite"),n=e.objectStore("root");return n.get(o.uid).onsuccess=function(e){var t=e.target.result;t.skipBankAccountAdd=!0,n.put(t)},void(e.oncomplete=function(){t()})}history.back()}))}function createNewAccount(e){return requestCreator("newBankAccount",e).then(function(){snacks("New bank account added"),history.back()}).catch(function(e){snacks(e.message)})}function phoneNumberChangeUI(){setHeader("<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n  <span class=\"mdc-top-app-bar__title\">Change phone number</span>\n  ",""),dom_root.innerHTML="\n  <div class='change-phone-number-ui mdc-layout-grid mt-20'>\n      <div class='icon-container'>\n        <div class='mdc-theme--primary icons'>\n          <i class='material-icons'>sim_card</i>\n          <i class='material-icons'>arrow_right_alt</i>\n          <i class='material-icons'>sim_card</i>\n        </div>\n      </div>\n      <div class='text-container'>\n        <h3 class='mdc-typography--headline6'>Changing your phone number will migrate all your data to new number</h3>\n        <p class='mdc-typography--body1'>\n        Please confirm that you are able to receive SMS  at your new number.\n        </p>\n      </div>\n  </div>\n  "+actionButton("CONFIRM","confirm-btn").outerHTML+"\n  ",document.getElementById("confirm-btn").addEventListener("click",function(){history.pushState(["changePhoneNumber"],null,null),changePhoneNumber()})}function changePhoneNumber(){var a=firebase.auth().currentUser;dom_root.innerHTML="<div class='mdc-layout-grid change-phone-number mt-20'>\n  \n    <div class='change-number-form full-width'>\n      <div class='old-phone-number-container'>\n          "+textFieldTelephone({disabled:!0,value:a.phoneNumber,label:"Current phone number",id:"old-phone-number",customClass:"full-width"})+"\n      </div>\n      <h3 class='mdc-typography--body1'>Enter your new phone number</h3>\n        <div class='new-phone-number-container full-width'>\n          "+textFieldTelephoneWithHelper({id:"new-phone-number",customClass:"new-number-field full-width",required:!0}).outerHTML+"  \n        </div>\n    </div>\n  </div>\n  "+actionButton("Update","change-number-btn").outerHTML+"\n  ";var n=new mdc.textField.MDCTextField(document.getElementById("old-phone-number")),i=new mdc.textField.MDCTextField(document.getElementById("new-phone-number")),o=phoneFieldInit(i.input_);document.getElementById("change-number-btn").addEventListener("click",function(){if(o.isValidNumber()){var t=o.getNumber(intlTelInputUtils.numberFormat.E164);if(n.value!==t){var e=new Dialog("Change Phone Number","Are you sure you want to change your phone number ?").create();e.buttons_[1].textContent="CONFIRM",e.listen("MDCDialog:closed",function(e){"accept"===e.detail.action&&appLocation(3).then(function(e){loadingScreen(["Phone number change is in progress"]),document.getElementById("app-header").classList.add("hidden"),requestCreator("changePhoneNumber",{newPhoneNumber:t},e).then(function(e){var t=db.transaction("root","readwrite"),n=t.objectStore("root");n.get(a.uid).onsuccess=function(e){var t=e.target.result;t.fromTime=0,n.put(t)},t.oncomplete=function(){reloadPage()}}).catch(function(e){document.getElementById("app-header").classList.remove("hidden"),history.back()})}).catch(handleLocationError)}),e.open()}else setHelperInvalid(i,"New number cannot be similar to old number")}else setHelperInvalid(i,"Please enter a correct number")})}function setHelperInvalid(e,t){e.focus(),e.foundation_.setValid(!1),e.foundation_.adapter_.shakeLabel(!0),e.helperTextContent=t}function setHelperValid(e){e.focus(),e.foundation_.setValid(!0),e.helperTextContent=""}function timeDiff(e){var t=moment().format("YYY-MM-DD HH:mm"),n=moment(e).format("YYY-MM-DD HH:mm");return moment(t).diff(moment(n),"minutes")}function isEmailValid(e,t){return!!e&&!(e===t)}_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var workerResolves={},workerRejects={},workerMessageIds=0;function isWifiRequired(){if("Android"===native.getName()&&!AndroidInterface.isWifiOn()){return!!{samsung:!0,OnePlus:!0}[native.getInfo().deviceBrand]||void 0}}function readWait(){for(var t=Promise.resolve(),e=function(e){t=t.then(function(){return window.readStack.splice(e,1),requestCreator("Null")})},n=window.readStack.length-1;0<=n;n--)e(n);return t}var readDebounce=debounce(function(){readWait().then(handleComponentUpdation).catch(console.error)},1e3,!1);function handleError(e){var t=JSON.parse(localStorage.getItem("error"));if(!t.hasOwnProperty(e.message))return e.device=JSON.parse(localStorage.getItem("deviceInfo")),t[e.message]=e,localStorage.setItem("error",JSON.stringify(t)),requestCreator("instant",JSON.stringify(e))}function successDialog(e){var t=document.getElementById("success-animation");t.classList.remove("hidden"),document.getElementById("app-header").style.opacity="0.1",dom_root.style.opacity="0.1",t.querySelector(".success-text").textContent=e,setTimeout(function(){t.classList.add("hidden"),dom_root.style.opacity="1",document.getElementById("app-header").style.opacity="1"},2e3)}function snacks(e,t,n,a){snackBar.labelText=e,snackBar.open(),snackBar.timeoutMs=a||4e3,snackBar.actionButtonText=t||"Okay",snackBar.listen("MDCSnackbar:closed",function(e){"action"===e.detail.reason&&n&&"function"==typeof n&&n()})}function fetchCurrentTime(e){return Date.now()+e}function appLocation(e){return new Promise(function(t,n){manageLocation(e).then(function(e){return ApplicationState.location&&isLocationMoreThanThreshold(calculateDistanceBetweenTwoPoints(ApplicationState.location,e))?n({message:"THRESHOLD EXCEED",type:"geolocation",body:{geopoint:e}}):(ApplicationState.location=e,localStorage.setItem("ApplicationState",JSON.stringify(ApplicationState)),t(e))}).catch(function(e){e.type="geolocation",n(e)})})}function manageLocation(a){return new Promise(function(t,n){getLocation().then(function(e){return 35e3<=e.accuracy&&0<a?void setTimeout(function(){manageLocation(a-1).then(t).catch(n)},1e3):handleLocationOld(3,e).then(t).catch(n)}).catch(n)})}function handleLocationOld(a,i){return new Promise(function(t,n){var e=getStoredLocation();return e&&isLocationOld(e,i)&&0<a?void setTimeout(function(){getLocation().then(function(e){handleLocationOld(a-1,e).then(t).catch(n)}).catch(n)},1e3):t(i)})}function getLocation(){return new Promise(function(n,a){if(!navigator.onLine)return a({message:"BROKEN INTERNET CONNECTION"});if("Android"===native.getName())html5Geolocation().then(function(t){if(!(t.isLocationOld||350<=t.accuracy))return n(t);handleGeoLocationApi().then(n).catch(function(e){return n(t)})}).catch(function(t){handleGeoLocationApi().then(n).catch(function(e){return a({message:"Both HTML and Geolocation failed to fetch location",body:{html5:t,geolocation:e},locationError:!0})})});else try{webkit.messageHandlers.locationService.postMessage("start"),window.addEventListener("iosLocation",function e(t){n(t.detail),window.removeEventListener("iosLocation",e,!0)},!0)}catch(e){html5Geolocation().then(function(e){return n(e)}).catch(function(e){a(e)})}})}function handleGeoLocationApi(){return new Promise(function(e,t){if(ApplicationState.location&&"object"===_typeof(ApplicationState.location.provider)&&ApplicationState.location.provider.wifiAccessPoints){var n=!1;if(ApplicationState.location.provider.wifiAccessPoints.forEach(function(e){updatedWifiAddresses.addresses[e.macAddress]&&ApplicationState.location.accuracy<=1e3&&timeDelta(ApplicationState.location.lastLocationTime,updatedWifiAddresses.timestamp)<=5&&(n=!0)}),n)return e(ApplicationState.location)}var a=void 0;try{a=getCellularInformation()}catch(e){t(e.message)}Object.keys(a).length||t("empty object from getCellularInformation"),requestCreator("geolocationApi",a).then(e).catch(t)})}function iosLocationError(e){html5Geolocation().then(function(e){var t=new CustomEvent("iosLocation",{detail:e});window.dispatchEvent(t)}).catch(console.error),handleError(e)}function html5Geolocation(){return new Promise(function(t,n){navigator.geolocation.getCurrentPosition(function(e){return t({latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy,provider:"HTML5",isLocationOld:isLocationOld(e.coords,getStoredLocation()),lastLocationTime:Date.now()})},function(e){n({message:e.message})},{maximumAge:0,timeout:5e3,enableHighAccuracy:!1})})}window.addEventListener("callRead",readDebounce);var apiHandler=new Worker("js/apiHandler.js?version=198");function requestCreator(e,n,a){var t=firebase.auth().currentUser,i={type:e,body:n,meta:{user:{token:"",uid:t.uid,displayName:t.displayName,photoURL:t.photoURL,phoneNumber:t.phoneNumber},mapKey:appKey.getMapKey(),apiUrl:appKey.getBaseUrl(),authorization:!{geocode:!0,geolocationApi:!0}[e]}};return a?getRootRecord().then(function(e){var t=void 0;return t=i.body.timestamp?i.body.timestamp:fetchCurrentTime(e.serverTime),i.body.timestamp=t,i.body.geopoint=a,"check-in"===n.template&&(ApplicationState.lastCheckInCreated=t),localStorage.setItem("ApplicationState",JSON.stringify(ApplicationState)),executeRequest(i)}):executeRequest(i)}function executeRequest(a){var e=firebase.auth().currentUser;return"instant"!==a.type&&progressBar.open(),e.getIdToken().then(function(e){return a.meta.user.token=e,apiHandler.onmessage=function(e){if(progressBar.close(),e.data.success){var t=workerResolves[e.data.id];t&&(e.data.response.hasOwnProperty("reloadApp")&&!e.data.response.reloadApp&&delete e.data.response.reloadApp,t(e.data.response))}else{var n=workerRejects[e.data.id];n&&(n(e.data),snacks(e.data.body.message),e.data.apiRejection||handleError({message:e.data.message,body:JSON.stringify(e.data.body)}))}delete workerResolves[e.data.id],delete workerRejects[e.data.id]},apiHandler.onerror=function(e){progressBar.open(),handleError({message:e.message,body:JSON.stringify({filename:e.filename,lineno:e.lineno,colno:e.colno})})},new Promise(function(e,t){var n=workerMessageIds++;a.id=n,workerResolves[n]=e,workerRejects[n]=t,apiHandler.postMessage(a)})})}function updateApp(){if("Android"!==native.getName())return webkit.messageHandlers.updateApp.postMessage("Update App");var e=new Dialog("New Update Avaialble","Please Install the Latest version from google play store , to Use Growthfile. Click Okay to Install Lastest Version from Google Play Store.").create();e.open(),e.scrimClickAction="",e.listen("MDCDialog:opened",function(){e.buttons_[0].setAttribute("disabled","true")}),e.listen("MDCDialog:closed",function(e){"accept"===e.detail.action&&AndroidInterface.openGooglePlayStore("com.growthfile.growthfileNew")})}function revokeSession(){firebase.auth().signOut().then(function(){document.getElementById("app-header").classList.add("hidden")}).catch(function(e){handleError({message:"Sign out error",body:e})})}function officeRemovalSuccess(e){new Dialog("Reminder","You have been removed from "+e.msg.join(" & ")).create().open()}function updateIosLocation(e){e.lastLocationTime=Date.now();var t=new CustomEvent("iosLocation",{detail:e});window.dispatchEvent(t)}function handleComponentUpdation(n){getCheckInSubs().then(function(e){ApplicationState.officeWithCheckInSubs=e,localStorage.setItem("ApplicationState",JSON.stringify(ApplicationState))});var a=[];n.activities.forEach(function(e){"duty"===e.template&&checkForDuty(e)});var e=Promise.resolve([]);if(!ApplicationState.venue){var t=new GetOffsetBounds(ApplicationState.location,1);e=loadNearByLocations({north:t.north(),south:t.south(),east:t.east(),west:t.west()},ApplicationState.location)}e.then(function(e){if(e.forEach(function(e){e.distance=calculateDistanceBetweenTwoPoints(e,ApplicationState.location),a.push(e)}),a.length){var t=a.sort(function(e,t){return e.distance-t.distance});ApplicationState.venue=t[0],localStorage.setItem("ApplicationState",JSON.stringify(ApplicationState))}if(history.state)switch(history.state[0]){case"enterChat":if(!n.addendum.length)return;dynamicAppendChats();break;case"jobView":if(document.getElementById("rating-view"))return;getCurrentJob().then(function(e){e.activityId?(e.isActive=!0,jobView(e)):jobView(history.state[1])});break;case"appView":if(appTabBar&&document.getElementById("app-tab-content"))switchTabs(appTabBar.foundation_.adapter_.getFocusedTabIndex()),updateTotalCount();break;default:console.log("no refresh")}})}function backgroundTransition(){}function runRead(e){if(firebase.auth().currentUser&&serverTimeUpdated&&e&&e.read){window.readStack.push(e.read);var t=new CustomEvent("callRead",{detail:window.readStack});window.dispatchEvent(t)}}function debounce(n,a,i){var o;return function(){var e=this,t=arguments;clearTimeout(o),o=setTimeout(function(){o=null,i||n.apply(e,t)},a)}}function removeChildNodes(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function getRootRecord(){return new Promise(function(e,t){var n=void 0,a=db.transaction(["root"],"readwrite");a.objectStore("root").get(firebase.auth().currentUser.uid).onsuccess=function(e){var t=e.target.result;n=t},a.oncomplete=function(){e(n)},a.onerror=function(){t({message:a.error.message+" from getRootRecord"})}})}function getSubscription(i,o){return new Promise(function(t){var e=db.transaction(["subscriptions"]).objectStore("subscriptions"),n=void 0,a=void 0;i||o?(n=i?(a=e.index("validSubscription"),IDBKeyRange.bound([i,o,"CONFIRMED"],[i,o,"PENDING"])):(a=e.index("templateStatus"),IDBKeyRange.bound([o,"CONFIRMED"],[o,"PENDING"])),a.getAll(n).onsuccess=function(e){return t(e.target.result)}):e.getAll().onsuccess=function(e){return t(event.target.result)}})}function emailReg(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}function handleNav(e){if(history.state)return history.back()}function bottomDialog(e,t){e.root_.classList.add("bottom-dialog"),t.singleSelection=!0,t.selectedIndex=0,e.rootRecord,setTimeout(function(){e.root_.querySelector(".mdc-dialog__surface").classList.add("open"),t.foundation_.adapter_.focusItemAtIndex(0)},50),e.listen("MDCDialog:opened",function(){t.layout()}),e.listen("MDCDialog:closing",function(){e.root_.querySelector(".mdc-dialog__surface").classList.remove("open")}),e.open()}function getImageBase64(o){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.5;return new Promise(function(a,e){var t=o.target.files;if(t.length){var n=t[0],i=new FileReader;i.onload=function(e){var t=e.target.result,n=new Image;n.src=t,n.onload=function(){var e=resizeAndCompressImage(n,r);return a(e)}},i.readAsDataURL(n)}})}function updateName(e){var t=firebase.auth().currentUser;setHeader("profileCheck"===history.state[0]?'<span class="mdc-top-app-bar__title">Name</span>':"<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n    <span class=\"mdc-top-app-bar__title\">Name</span>\n    ",""),dom_root.innerHTML="\n  \n  <div class='mdc-layout-grid change-name'>\n    <p class='mdc-typography--body1'>\n        Please provide your name\n    </p>\n    "+textFieldWithHelper({id:"name",value:t.displayName||"",required:!0,label:"Name"}).outerHTML+"\n  </div>\n  <div  class='mb-10 mt-10'>\n    "+actionButton("Update","name-btn").outerHTML+"\n  </div>";var n=new mdc.textField.MDCTextField(document.getElementById("name"));n.focus(),document.getElementById("name-btn").addEventListener("click",function(){n.value?(progressBar.open(),t.updateProfile({displayName:n.value.trim()}).then(function(){progressBar.close(),snacks("Name updated"),e()})):setHelperInvalid(n,"Name Cannot Be Left Blank")})}function getEmailViewHeading(e){var t={topBarText:"",heading:"",btnText:"Update"};return e.email?e.emailVerified?(t.topBarText="Email",t.btnText="Update"):(t.topBarText="Email",t.btnText="Verify"):t.topBarText="Email",t}function emailUpdation(e,t){var a=firebase.auth().currentUser,n=getEmailViewHeading(a),i="";e&&(i=createButton("SKIP","skip-header").outerHTML),setHeader("profileCheck"===history.state[0]?'\n    <span class="mdc-top-app-bar__title">'+n.topBarText+"</span>\n    \n    ":"<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n    <span class=\"mdc-top-app-bar__title\">"+n.topBarText+"</span>\n    ",i).root_.classList.remove("hidden"),dom_root.innerHTML=updateEmailDom(n);var o=new mdc.textField.MDCTextField(document.getElementById("email"));o.focus(),document.getElementById("email-btn").addEventListener("click",function(){if(emailReg(o.value)){if(progressBar.open(),a.email)return o.value!==a.email?void emailUpdate(o.value,t):a.emailVerified?(progressBar.close(),void setHelperInvalid(o,"New Email Cannot Be Same As Previous Email")):void emailVerification(t);emailUpdate(o.value,t)}else setHelperInvalid(o,"Enter A Valid Email Id")});var r=document.getElementById("skip-header");r&&(new mdc.ripple.MDCRipple(r),r.classList.remove("hidden"),r.addEventListener("click",function(){var e=db.transaction("root","readwrite"),n=e.objectStore("root");n.get(a.uid).onsuccess=function(e){var t=e.target.result;t.skipEmail=!0,n.put(t)},e.oncomplete=function(){t()}}))}function emailUpdate(e,t){firebase.auth().currentUser.updateEmail(e).then(function(){emailVerification(t)}).catch(handleEmailError)}function emailVerification(e){firebase.auth().currentUser.sendEmailVerification().then(function(){snacks("Email verification has been sent."),progressBar.close(),e()}).catch(handleEmailError)}function handleEmailError(e){"addView"!==history.state[0]&&(progressBar.close(),"auth/requires-recent-login"!==e.code?snacks(e.message):showReLoginDialog("Email Authentication","Please Login Again To Complete The Operation").listen("MDCDialog:closed",function(e){"accept"===e.detail.action&&("profileCheck"!==history.state[0]&&(EMAIL_REAUTH=!0),revokeSession())}))}function updateEmailDom(e){var t=firebase.auth().currentUser.email;return"\n  <div class='mdc-layout-grid update-email'>\n\n\n    <h3 class='mdc-typography--headline6'>"+e.heading+"</h3>\n    <p class='report-rec mt-10 mdc-typography--body1'>\n      Verify your email to receive  offer letter, salary slip, tax forms & other documents\n    </p>\n    "+textFieldWithHelper({id:"email",classList:["mt-10"],value:t||"",type:"email",label:"Email"}).outerHTML+"\n</div>\n<div  class='mb-10 mt-10'>\n  "+actionButton(e.btnText,"email-btn").outerHTML+"\n</div>\n"}function isPossiblyValidAadharNumber(e){return/^\d{4}\d{4}\d{4}$/.test(e)}function isPossiblyValidPan(e){return/^([a-zA-Z]){5}([0-9]){4}([a-zA-Z]){1}?$/.test(e)}function showPan(e){return"profileCheck"!==history.state[0]||!(e.pan.number&&e.pan.front&&e.pan.back)}function showAadhar(e){return"profileCheck"!==history.state[0]||!(e.aadhar.number&&e.aadhar.front&&e.aadhar.back)}function idProofView(l){getRootRecord().then(function(e){var t=firebase.auth().currentUser,n={aadhar:{front:"",back:"",number:""},pan:{front:"",number:""}};e.aadhar&&(n.aadhar.front=e.aadhar.front,n.aadhar.back=e.aadhar.back,n.aadhar.number=e.aadhar.number),e.pan&&(n.pan.front=e.pan.front,n.pan.number=e.pan.number);var a="",i="";"profileCheck"===history.state[0]?(a=' <span class="mdc-top-app-bar__title">Add ID Proof</span>',i=createButton("SKIP","skip-header").outerHTML):a="<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n    <span class=\"mdc-top-app-bar__title\">Add ID Proof</span>\n    ",setHeader(a,i),dom_root.classList.add("mdc-top-app-bar--fixed-adjust"),dom_root.innerHTML="\n  <div class='id-container app-padding'>\n  \n\n    <div class='pan-container pb-10 "+(showPan(n)?"":"hidden")+"'>\n    <h3 class='mdc-typography--headline6 mdc-theme--primary'> Enter PAN card details</h3>\n      "+textFieldWithHelper({id:"pan-number",label:"Enter PAN Number",value:n.pan.number,type:"text",required:!0,classList:["mt-10","mb-10"]}).outerHTML+"\n  \n    <div class='pan-images mdc-layout-grid__inner'>\n        <div class='mdc-layout-grid__cell mdc-layout-grid__cell--span-2-phone'>\n          <div class='image-container'>\n            <img src='"+(n.pan.front||"./img/placeholder.png")+"'  class='width-100' data-name=\"panFront\"  data-valid=\""+(n.pan.front?"true":"false")+"\">\n            <div class='add-icon-cont'>\n              <button class=\"mdc-fab mdc-fab--mini mdc-button--raised\">\n                <span class=\"mdc-fab__icon material-icons\">add_a_photo</span>\n                <input type='file' accept='image/jpeg;capture=camera'  class='overlay-text'>\n              </button>\n            </div>\n          </div>\n          <div class=\"mdc-image-list__supporting\">\n            <span class=\"mdc-image-list__label\">PAN FRONT</span>\n          </div>\n        </div>\n        \n    </div>\n    <div class='aadhar-container "+(showAadhar(n)?"":"hidden")+"'>\n        <h3 class='mdc-typography--headline6 mdc-theme--primary'>Enter AADHAR card details</h3>\n        "+textFieldWithHelper({id:"aadhar-number",label:"Enter AADHAR card Number",value:n.aadhar.number,type:"text",required:!0,classList:["mt-10","mb-10"]}).outerHTML+"\n      <div class='aadhar-images mdc-layout-grid__inner'>\n      <div class='mdc-layout-grid__cell mdc-layout-grid__cell--span-2-phone'>\n      <div class='image-container'>\n        <img src='"+(n.aadhar.front||"./img/placeholder.png")+"' class='width-100' data-name=\"aadharFront\"  data-valid=\""+(n.aadhar.front?"true":"false")+"\">\n        <div class='add-icon-cont'>\n          <button class=\"mdc-fab mdc-fab--mini mdc-button--raised\">\n            <span class=\"mdc-fab__icon material-icons\">add_a_photo</span>\n            <input type='file' accept='image/jpeg;capture=camera'  class='overlay-text'>\n          </button>\n        </div>\n       \n      </div>\n      <div class=\"mdc-image-list__supporting\">\n      <span class=\"mdc-image-list__label\">AADHAR FRONT</span>\n    </div>\n    </div>\n    <div class='mdc-layout-grid__cell mdc-layout-grid__cell--span-2-phone'>\n    <div class='image-container'>\n        <img src='"+(n.aadhar.back||"./img/placeholder.png")+"' class='width-100' data-name=\"aadharBack\" data-valid=\""+(n.aadhar.back?"true":"false")+'">\n        \n        <div class=\'add-icon-cont\'>\n          <button class="mdc-fab mdc-fab--mini mdc-button--raised">\n            <span class="mdc-fab__icon material-icons">add_a_photo</span>\n            <input type=\'file\' accept=\'image/jpeg;capture=camera\'  class=\'overlay-text\'>\n          </button>\n        </div>\n    </div>\n    <div class="mdc-image-list__supporting">\n      <span class="mdc-image-list__label">AADHAR BACK</span>\n    </div> \n    </div>\n</div>\n      </div>\n    </div>\n    </div>\n    '+actionButton("UPDATE","submit-btn").outerHTML+"\n  ";var o=new mdc.textField.MDCTextField(document.getElementById("pan-number")),r=new mdc.textField.MDCTextField(document.getElementById("aadhar-number")),c=document.getElementById("skip-header");[].concat(_toConsumableArray(document.querySelectorAll(".id-container .mdc-fab input"))).forEach(function(n){n.addEventListener("change",function(e){getImageBase64(e).then(function(e){var t=n.closest(".image-container").querySelector("img");t&&(t.src=""+e,t.dataset.valid=!0)})})});var s=document.getElementById("submit-btn");new mdc.ripple.MDCRipple(s),s.addEventListener("click",function(){isPossiblyValidAadharNumber(r.value.trim())?isPossiblyValidPan(o.value.trim())?[].concat(_toConsumableArray(document.querySelectorAll('[data-valid="false"]'))).length?snacks("Please Upload All Images"):(n.aadhar.number=r.value.trim(),n.aadhar.front=document.querySelector('[data-name="aadharFront"]').src,n.aadhar.back=document.querySelector('[data-name="aadharBack"]').src,n.pan.number=o.value.trim(),n.pan.front=document.querySelector('[data-name="panFront"]').src,s.setAttribute("disabled",!0),c&&c.setAttribute("disabled",!0),requestCreator("idProof",n).then(function(n){var e=db.transaction("root","readwrite"),a=e.objectStore("root");a.get(t.uid).onsuccess=function(e){var t=e.target.result;t.idProof=n,a.put(t)},e.oncomplete=function(){l()}}).catch(function(){c&&c.removeAttribute("disabled"),s.removeAttribute("disabled")})):setHelperInvalid(o,"Please enter a valid PAN number"):setHelperInvalid(r,"Please enter a valid AADHAR number")}),c&&(new mdc.ripple.MDCRipple(c),c.addEventListener("click",function(){var e=db.transaction("root","readwrite"),n=e.objectStore("root");n.get(firebase.auth().currentUser.uid).onsuccess=function(e){var t=e.target.result;t.skipIdproofs=!0,n.put(t)},e.oncomplete=function(){l&&l()}}))})}function getDropDownContent(r,c,s){return new Promise(function(e,t){var a=[],i={},n=parent.db.transaction(["children"]),o="";o=r?IDBKeyRange.only([r,c]):IDBKeyRange.only(c),n.objectStore("children").index(s).openCursor(o).onsuccess=function(e){var t=e.target.result;if(t)if("CANCELLED"!==t.value.status){var n=t.value.attachment.Name.value;i[n]||(i[n]=!0,a.push(n)),t.continue()}else t.continue()},n.oncomplete=function(){return e(a)}})}window.readStack=[];var phoneFieldInit=function(e,t,n){return intlTelInput(e,{initialCountry:"IN",formatOnDisplay:!0,separateDialCode:!0,dropdownContainer:t||null,hiddenInput:n||"",nationalMode:!1})};function toDataURL(e,a){var t=new Image;t.onload=function(){var e,t=document.createElement("CANVAS"),n=t.getContext("2d");t.height=this.naturalHeight,t.width=this.naturalWidth,n.drawImage(this,0,0),e=t.toDataURL(),a(e)},t.src=e}function templateSelectionList(e){return"<ul class='mdc-list subscription-list' id='dialog-office'>\n     "+Object.keys(e).map(function(e){return"<li class='mdc-list-item'>\n        <span class=\"mdc-list-item__text\">\n          "+e+"\n        </span>      \n       <span class='mdc-list-item__meta material-icons mdc-theme--primary'>\n         keyboard_arrow_right\n       </span>\n       </li>"}).join("")+"\n     </ul>"}function officeSelectionList(e){return"<ul class='mdc-list subscription-list' id='dialog-office'>\n     "+e.map(function(e){return"<li class='mdc-list-item'>\n        <span class=\"mdc-list-item__text\">\n          "+("string"==typeof e?e:e.office)+" \n        </span>      \n       <span class='mdc-list-item__meta material-icons mdc-theme--primary'>\n         keyboard_arrow_right\n       </span>\n       </li>"}).join("")+"\n     </ul>"}function chooseAlternativePhoneNumber(e){dom_root.innerHTML="<div class='phone-number-choose "+(1==e.length?"slider":"")+"'>\n            <div class='phone-number-choose-cont "+(1==e.length?"slider-container":"")+"''>\n               \n                "+(1==e.length?"<p class='mdc-typography--body1 pl-20 pr-20'>\n                We found another number <span class='mdc-theme--primary'><b>"+e[0].phoneNumber+"</b></span> you used with this device for Company <span class='mdc-theme--primary'><b>"+e[0].office+"</b></span>. Login with this phone number to proceed\n                </p>":"<p class='mdc-typography--body1'>We found other numbers you used with this device . Login with any of these phone numbers to proceed</p>\n\n                <ul class='mdc-list  mdc-list--two-line' id='phone-list'>                   \n                    "+e.map(function(e){return'<li class=\'mdc-list-item\'>\n                        <span class="mdc-list-item__text">\n                          <span class="mdc-list-item__primary-text">'+e.phoneNumber+'</span>\n                          <span class="mdc-list-item__secondary-text mdc-theme--primary">Company : '+e.office+"</span>\n                      </span>\n                      </li>"}).join("")+"\n                </ul>")+"\n              \n            </div>\n    </div>\n    "+actionButton("RE-LOGIN","confirm-phone-btn").outerHTML+"\n    ";var t=document.getElementById("confirm-phone-btn");t&&(new mdc.ripple.MDCRipple(t),t.addEventListener("click",revokeSession))}function isAdmin(e,t){if(e.claims.hasOwnProperty("admin")&&Array.isArray(e.claims.admin)&&e.claims.admin.length)return!t||-1<e.claims.admin.indexOf(t)}function giveSubscriptionInit(e){history.pushState(["shareLink"],null,null);new Dialog("Invitation link",shareWidget("https://growthfile.page.link/naxz",e)).create("simple").open()}