function addView(t){getHeader("app-header","<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n    <span class=\"mdc-top-app-bar__title\">"+t.template.toUpperCase()+"</span>\n    ","").root_.classList.remove("hidden"),document.getElementById("growthfile").classList.add("mdc-top-app-bar--fixed-adjust"),document.getElementById("app-current-panel").innerHTML="\n    <div class='banner'></div>\n    <iframe id='form-iframe' src='"+window.location.origin+"/forms/"+t.template+"/edit.html'></iframe>\n    ",console.log(db),document.getElementById("form-iframe").addEventListener("load",function(e){document.getElementById("form-iframe").contentWindow.init(t)})}function sendFormToParent(e){progressBar.open();var t=e.customerAuths;delete e.customerAuths,requestCreator("create",e).then(function(){if(progressBar.close(),successDialog(),"customer"===e.template)return ApplicationState.knownLocation=!0,ApplicationState.venue={office:e.office,template:e.template,status:e.status,location:e.venue[0].location,address:e.venue[0].address,latitude:e.venue[0].geopoint.latitude,longitude:e.venue[0].geopoint.longitude},getSuggestions(),void t.forEach(function(e){e.email&&(delete e.displayName,requestCreator("updateAuth",e).then(function(e){console.log(e)}).catch(console.log))});getSuggestions()}).catch(function(e){progressBar.close(),snacks(e.response.message,"Okay")})}function parseContact(e){var t=e.split("&")[0].split("=")[1],n=e.split("&")[1].split("=")[1],a=e.split("&")[2].split("=")[1];return{displayName:t,phoneNumber:n?formatNumber(n):"",email:a}}function setContactForCustomer(e){var t=parseContact(e);document.getElementById("form-iframe").contentWindow.setContact(t,"First Contact")}function setContactForCustomerFailed(e){handleError({message:e,body:""})}function setContactForSecondCustomer(e){var t=parseContact(e);document.getElementById("form-iframe").contentWindow.setContact(t,"Second Contact")}function setContactForSecondCustomerFailed(e){handleError({message:e,body:""})}function attendenceView(){document.getElementById("app-header").classList.remove("hidden"),document.getElementById("growthfile").classList.add("mdc-top-app-bar--fixed-adjust");getHeader("app-header","<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n    <span class=\"mdc-top-app-bar__title\">Attendence</span>\n    ","");document.getElementById("app-current-panel").innerHTML="<div class='attendence-section pt-20'>\n    "+applyLeave()+"\n    "+attendenceCards()+"\n    </div>\n    "}function applyLeave(){return'<button class="mdc-button" id=\'apply-leave\'>\n    <i class="material-icons mdc-button__icon" aria-hidden="true">today</i>\n    <span class="mdc-button__label">Apply For A New Leave</span>\n  </button>'}function attendenceCards(){return"<div class='cards-container mdc-layout-grid__inner mt-20 pt-20'>\n    "+[1,2,3].map(function(){return'<div class="mdc-card mdc-layout-grid__cell">\n        <div class="mdc-card__primary-action demo-card__primary-action">\n        <div class="">\n            <h2 class="demo-card__title mdc-typography mdc-typography--headline6">Our Changing Planet</h2>\n            <h3 class="demo-card__subtitle mdc-typography mdc-typography--subtitle2">by Kurt Wagner</h3>\n        </div>\n        <div class="demo-card__secondary mdc-typography mdc-typography--body2">Visit ten places on our planet that are undergoing the biggest changes today.</div>\n        <div class="card-actions mt-20">\n        <button class="mdc-button" style="\n/* width: 100%; */\n">\n            <span class="mdc-button__label" style="\ntext-align: left;\n">Regularize Attendece</span>\n        </button><button class="mdc-button" style="\n/* margin: 0 auto; */\n/* display: block; */\n/* width: 100%; */\n">\n            <span class="mdc-button__label">Apply Leave</span>\n        </button>\n        \n        </div>\n        </div>\n \n    </div>'}).join("")+"\n    </div>"}var contactsUl,chatsUl,currentChatsArray=[],currentContactsArray=[];function chatView(){document.getElementById("start-load").classList.add("hidden");getHeader("app-header",'<a class=\'mdc-top-app-bar__navigation-icon\'><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></a>',"<a class='mdc-top-app-bar__action-item material-icons' id='search-btn'>\n        search\n    </a>");document.getElementById("app-header").classList.remove("hidden"),document.getElementById("app-current-panel").innerHTML=chatDom(),document.getElementById("growthfile").classList.add("mdc-top-app-bar--fixed-adjust"),readLatestChats()}function chatDom(){return"<div class='user-chats'>\n    \n<div id='search-users-container'>\n    <div class='search-field'></div>\n    <div class='search-result-container'></div>\n</div>\n<div class=\"mdc-list-group\">\n <h3 id='no-result-found' style='text-align:center'></h3>   \n<div class='chats-container'>\n<h3 class=\"mdc-list-group__subheader\">Chats</h3>\n<ul class=\"mdc-list mdc-list--two-line mdc-list--avatar-list\" id='chats'>\n\n</ul>\n</div>\n<div class='contacts-container'>\n  <h3 class=\"mdc-list-group__subheader\">Other Contacts</h3>\n  <ul class=\"mdc-list mdc-list--two-line mdc-list--avatar-list\" id='all-contacts'>\n  </ul>\n</div>\n  </div>\n</div>"}function searchBar(){return'<div id=\'search-users\' class="mdc-text-field mdc-text-field--with-leading-icon mdc-text-field--with-trailing-icon mdc-text-field--no-label">\n    <i class="material-icons mdc-text-field__icon" tabindex="0" role="button" id=\'search-back\'>arrow_back</i>\n    <i class="material-icons mdc-text-field__icon hidden"  tabindex="0" role="button" id=\'clear-search\'>clear</i>\n    <input type="text" id="my-input" class="mdc-text-field__input" placeholder=\'Search...\' style=\'padding-left:48px;padding-right: 48px;\'>\n    <div class="mdc-line-ripple"></div>\n</div>'}function search(){document.getElementById("app-header").classList.add("hidden"),document.querySelector("#search-users-container .search-field").innerHTML=searchBar();var s=new mdc.textField.MDCTextField(document.getElementById("search-users"));s.focus(),s.input_.addEventListener("input",function(e){s.trailingIcon_.root_.classList.remove("hidden"),e.target.value?s.trailingIcon_.root_.classList.remove("hidden"):s.trailingIcon_.root_.classList.add("hidden");var n=firebase.auth().currentUser.phoneNumber,t=getSearchBound(e),a="",i="";currentChatsArray=[],currentContactsArray=[],t.bound.onsuccess=function(e){var t=e.target.result;t&&(t.value.mobile!==n&&(t.value.timestamp?(a+=userLi(t.value),currentChatsArray.push(t.value)):(i+=userLi(t.value),currentContactsArray.push(t.value))),t.continue())},t.tx.oncomplete=function(){var e=document.getElementById("chats"),t=document.getElementById("all-contacts"),n=document.getElementById("no-result-found");n&&(currentChatsArray.length||currentContactsArray.length?n.innerHTML="":n.innerHTML="No Results Found"),e&&(currentChatsArray.length?document.querySelector(".chats-container").classList.remove("hidden"):document.querySelector(".chats-container").classList.add("hidden"),e.innerHTML=a),t&&(i?document.querySelector(".contacts-container").classList.remove("hidden"):document.querySelector(".contacts-container").classList.add("hidden"),t.innerHTML=i)}}),s.leadingIcon_.root_.onclick=function(){history.back()},s.trailingIcon_.root_.onclick=function(){searchInitCancel(s)}}function getSearchBound(e){var t=e.target.value,n=db.transaction(["users","addendum"]),a=n.objectStore("users"),i=null,s="next";return e.target.value?(t=isNumber(t)?(indexName="mobile",formatNumber(t)):(indexName="NAME_SEARCH",t.toLowerCase()),i=IDBKeyRange.bound(t,t+"ï¿¿"),a=a.index(indexName)):"searchChats"===history.state[0]&&(indexName="timestamp",s="prev"),{tx:n,bound:a=a.openCursor(i,s)}}function isNumber(e){return!isNaN(e)}function formatNumber(e){var t=e;return"91"===t.substring(0,2)?t="+"+t:"+91"!==t.substring(0,3)&&(t="+91"+t),t.replace(/ +/g,"")}function readLatestChats(){currentChatsArray=[],currentContactsArray=[];var e=db.transaction("users","readwrite"),t=e.objectStore("users").index("timestamp"),n=firebase.auth().currentUser.phoneNumber,i="",s="";t.openCursor(null,"prev").onsuccess=function(e){var t=e.target.result;if(t)if(t.value.mobile!==n){if(ApplicationState.currentChatSlected===t.value.mobile)t.value.count=0,t.update(t.value).onsuccess=function(){ApplicationState.currentChatSlected=null,console.log("count reset")};t.value.timestamp?(i+=userLi(t.value),currentChatsArray.push(t.value)):(s+=userLi(t.value),currentContactsArray.push(t.value)),t.continue()}else t.continue()},e.oncomplete=function(){var e=document.getElementById("chats"),t=document.getElementById("all-contacts"),n=void 0,a=void 0;e&&(e.innerHTML=i,document.querySelector(".chats-container").classList.remove("hidden"),currentChatsArray.length||(i="No Chat Found. "),initializeChatList(n=new mdc.list.MDCList(e))),t&&(document.querySelector(".contacts-container").classList.remove("hidden"),(t.innerHTML=s)||(s="No Contacts Found"),initializeContactList(a=new mdc.list.MDCList(t))),document.getElementById("search-btn")&&n&&a&&document.getElementById("search-btn").addEventListener("click",function(){history.pushState(["searchChats"],null,null),search()})}}function initializeChatList(e){e.listen("MDCList:action",function(e){var t=currentChatsArray[e.detail.index];"searchChats"===history.state[0]?history.replaceState(["enterChat",t],null,null):history.pushState(["enterChat",t],null,null),enterChat(t)})}function initializeContactList(e){e.listen("MDCList:action",function(e){var t=currentContactsArray[e.detail.index];"searchChats"===history.state[0]?history.replaceState(["enterChat",t],null,null):history.pushState(["enterChat",t],null,null),enterChat(t)})}function userLi(e){return'<li class="mdc-list-item">\n   <div style="position:relative">\n   <img class="mdc-list-item__graphic" aria-hidden="true" src='+(e.photoURL||"./img/empty-user.jpg")+" data-number="+e.mobile+'>\n   <i class="material-icons user-selection-icon">check_circle</i>\n   </div>\n    \n    <span class="mdc-list-item__text">\n    <span class="mdc-list-item__primary-text">\n        '+(e.displayName||e.mobile)+'\n    </span>\n    <span class="mdc-list-item__secondary-text">\n    '+(e.comment||"")+'\n    </span>\n    </span>\n    <span class="mdc-list-item__meta" aria-hidden="true">\n    '+(e.count?"<div class='chat-count'>"+e.count+"</div>":"")+"\n    "+(e.timestamp?formatCreatedTime(e.timestamp):"")+"</span>\n    </li>"}function loadUsers(c,r){return new Promise(function(e,t){var n=db.transaction(["users"]),a=n.objectStore("users"),i=firebase.auth().currentUser.phoneNumber,s="",o=[];a.openCursor().onsuccess=function(e){var t=e.target.result;t&&(t.value.mobile!==i&&(r&&r[t.value.mobile]||(o.push(t.value),c&&(t.value.comment="",t.value.count="",t.value.timestamp=""),s+=userLi(t.value))),t.continue())},n.oncomplete=function(){return e({domString:s,data:o})}})}function selectNew(){return"<div class='new-message-container'>\n        <h2 class='mdc-typography--headline5 mt-0 mb-0'>Message Team With Direct</h2>\n    <p>Send private message.... </p>\n    <button class='mdc-button' onclick=newMessage()>\n    <span class=\"mdc-button__label\">Send Message</span>\n    </button>\n    </div>"}function formatCreatedTime(e){return e?isToday(e)?moment(e).format("hh:mm"):moment(e).format("D, MMM").replace(",",""):""}function isToday(e){return(new Date).setHours(0,0,0,0)==new Date(e).setHours(0,0,0,0)}function enterChat(e){ApplicationState.currentChatSlected=e.mobile;var t=getHeader("app-header",'<a class=\'mdc-top-app-bar__navigation-icon\'><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>       \n        </a>\n        <img src='+(e.photoURL||"./img/empty-user.jpg")+" class='header-image'>\n        <span class=\"mdc-top-app-bar__title\">"+(e.displayName||e.mobile)+"</span>\n        ","");t.root_.classList.remove("hidden"),console.log(t),document.getElementById("app-current-panel").innerHTML='\n        <div class="wrapper">\n        <div class="inner" id="inner">\n    \n        <div class="content" id="content">\n\n        </div>\n      \n        <div class="bottom" id="bottom">\n        <div class="conversation-compose">\n        \n        <div id=\'comment-textarea\' class="mdc-text-field text-field mdc-text-field--fullwidth mdc-text-field--no-label  mdc-text-field--textarea">\n        \n        <textarea id="text-field-fullwidth-textarea-helper" class="mdc-text-field__input mdc-text-field__input  input-msg">\n        </textarea>\n        \n        </div>\n        \n        <button id=\'comment-send\' class="mdc-fab send mdc-theme--primary-bg mdc-theme-on--primary" aria-label="Favorite">\n        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/><path d="M0 0h24v24H0z" fill="none"/></svg>\n        </button>\n        </div>\n        \n        </div>\n        </div>\n        </div>\n        </div>',getUserChats(e)}function actionBox(e){return"\n    <div class='action-box-container'>\n    <div class='menu-container mdc-menu-surface--anchor' id=\""+e.addendumId+'"> \n    </div>\n   \n    <div class="message-wrapper aciton-info" onclick="createActivityActionMenu(\''+e.addendumId+"','"+e.activityId+'\')">\n    <div class="text-wrapper">'+e.comment+"\n    <span class=\"metadata\">\n    <i class='material-icons'>info</i>\n    </span>\n    </div>\n    </div>\n    </div>\n   "}function messageBox(e,t,n,a){return'<div class="message-wrapper '+t+'">\n    <img class="circle-wrapper" src='+n+'>\n    <div class="text-wrapper">'+e+'\n    <span class="metadata">\n        <span class="time">\n            '+moment(a).format("hh:mm")+"\n        </span>\n    </span>\n    </div>\n    </div>"}function messageBoxDom(e,t,n,a){var i=createElement("div",{className:"message-wrapper "+t}),s=createElement("img",{className:"circle-wrapper",src:n}),o=createElement("div",{className:"text-wrapper",textContent:e}),c=createElement("span",{className:"metadata"}),r=createElement("span",{className:"time",textContent:moment(a).format("hh:mm")});return i.appendChild(s),c.appendChild(r),o.appendChild(c),i.appendChild(o),i}function actionBoxDom(e){var t=createElement("div",{className:"action-box-container"}),n=createElement("div",{id:e.addendumId,className:"menu-container mdc-menu-surface--anchor"}),a=createElement("div",{className:"message-wrapper aciton-info"});a.onclick=function(){createActivityActionMenu(e.addendumId,e.activityId)};var i=createElement("div",{className:"text-wrapper",textContent:e.comment}),s=createElement("span",{className:"metadata"}),o=createElement("i",{className:"material-icons",textContent:"info"});return s.appendChild(o),i.appendChild(s),a.appendChild(i),t.appendChild(n),t.appendChild(a),t}function createActivityActionMenu(o,c){console.log("long press"),db.transaction("activity").objectStore("activity").get(c).onsuccess=function(e){var t=e.target.result;if(t){var n=t.activityName+"\n        <p class='card-time mdc-typography--subtitle1 mb-0 mt-0'>Created On "+formatCreatedTime(t.timestamp)+'</p>\n        <span class="demo-card__subtitle mdc-typography mdc-typography--subtitle2 mt-0">by '+(t.creator.displayName||t.creator.phoneNumber)+"</span>";if(!t.canEdit)return dialog=new Dialog(n,activityDomCustomer(t),"view-form").create(),dialog.open(),dialog.buttons_[1].classList.add("hidden"),void(dialog.autoStackButtons=!1);var a=[{name:"View",icon:"info"},{name:"Share",icon:"share"},{name:"Edit",icon:"edit"}];"CANCELLED"===t.status&&(a.push({name:"Confirm",icon:"check"}),a.push({name:"Undo",icon:"undo"})),"PENDING"===t.status&&(a.push({name:"Confirm",icon:"check"}),a.push({name:"Delete",icon:"delete"})),"CONFIRMED"===t.status&&(a.push({name:"Undo",icon:"undo"}),a.push({name:"Delete",icon:"delete"}));var i=o+c;document.getElementById(o).innerHTML=createSimpleMenu(a,i);var s=new mdc.menu.MDCMenu(document.getElementById(i));s.open=!0,s.root_.classList.add("align-right-menu"),s.listen("MDCMenu:selected",function(e){switch(a[e.detail.index].name){case"View":dialog=new Dialog(n,activityDomCustomer(t),"view-form").create(),dialog.open(),dialog.buttons_[1].classList.add("hidden"),dialog.autoStackButtons=!1;break;case"Edit":break;case"Share":share(t);break;case"Undo":setActivityStatus(t,"PENDING");break;case"Confirm":setActivityStatus(t,"CONFIRMED");break;case"Delete":setActivityStatus(t,"CANCELLED")}})}}}function createDynamicChips(e,t){var n=createElement("button",{className:"mdc-chip mdc-chip--selected",id:t}),a=createElement("img",{className:"mdc-chip__icon mdc-chip__icon--leading",src:e.photoURL||"./img/empty-user.jpg"}),i=createElement("div",{className:"mdc-chip__text",textContent:""+(e.displayName||e.mobile)}),s=createElement("i",{className:"material-icons mdc-chip__icon mdc-chip__icon--trailing",textContent:"cancel"});return s.setAttribute("tabindex","0"),s.setAttribute("role","button"),n.appendChild(a),n.appendChild(i),n.appendChild(s),n}function share(t){var a={},o={};t.assignees.forEach(function(e){a[e.phoneNumber]=!0}),document.getElementById("app-current-panel").innerHTML="\n    <div id='search-users-container'>\n    </div>\n    <div class='share-user-container'>\n    <div class=\"mdc-chip-set hidden\" id='share'>\n    </div>\n    </div>\n    <ul class=\"mdc-list mdc-list--two-line mdc-list--avatar-list\" id='users-list'>\n    </ul>\n    <button class=\"mdc-fab mdc-theme--primary-bg app-fab--absolute\" aria-label=\"Favorite\" id='send-assignee'>\n        <span class=\"mdc-fab__icon material-icons mdc-theme--on-primary\">arrow_forward</span>\n    </button>\n    ";getHeader("app-header","<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n    <span class=\"mdc-top-app-bar__title\">Add People</span>\n    ","<a class='mdc-top-app-bar__action-item material-icons' id='search-btn'>\n        search\n    </a>");var c=document.getElementById("share"),r=new mdc.chips.MDCChipSet(c),e=document.getElementById("users-list"),d=new mdc.list.MDCList(e),n=new mdc.ripple.MDCRipple(document.getElementById("send-assignee"));history.pushState(["share",t],null,null),console.log(r),loadUsers(!0,a).then(function(s){s.data.length&&(n.root_.addEventListener("click",function(){var e=Object.keys(o);e.length?(console.log(o),addAssignee(t,e)):snacks("At least 1 contact must be selected")}),document.getElementById("users-list").innerHTML=s.domString,r.listen("MDCChip:removal",function(e){console.log(r.chips);var t=d.listElements[Number(e.detail.chipId)];delete o[s.data[Number(e.detail.chipId)].mobile],c.removeChild(e.detail.root),t.classList.remove("selected"),t.querySelector(".user-selection-icon").classList.add("hidden"),t.querySelector(".user-selection-icon").classList.remove("user-selection-show"),r.chips.length?c.classList.remove("hidden"):c.classList.add("hidden")}),d.listen("MDCList:action",function(e){var t=e.detail.index,n=d.listElements[t],a=s.data[t];if(n.classList.contains("selected")){new mdc.chips.MDCChip(document.getElementById(""+t)).beginExit()}else{o[a.mobile]=!0,n.classList.add("selected"),n.querySelector(".user-selection-icon").classList.remove("hidden"),n.querySelector(".user-selection-icon").classList.add("user-selection-show");var i=createDynamicChips(a,t);c.appendChild(i),r.addChip(i),i.scrollIntoView({behavior:"smooth",block:"center",inline:"end"}),c.classList.remove("hidden")}}),document.getElementById("search-btn").addEventListener("click",function(e){document.getElementById("app-header").classList.add("hidden"),document.getElementById("search-users-container").innerHTML="<div class='search-field'>\n            "+searchBar()+"\n        </div>";var n=new mdc.textField.MDCTextField(document.getElementById("search-users"));n.focus(),n.input_.addEventListener("input",function(e){e.target.value?n.trailingIcon_.root_.classList.remove("hidden"):n.trailingIcon_.root_.classList.add("hidden"),d.listElements.forEach(function(e){e.classList.remove("found")});var t=getSearchBound(e);t.bound.onsuccess=function(e){var t=e.target.result;if(t)if(a[t.value.mobile])t.continue();else{var n=document.querySelector('[data-number="'+t.value.mobile+'"]');n&&n.parentNode.parentNode.classList.add("found"),t.continue()}},t.tx.oncomplete=function(){d.listElements.forEach(function(e){e.classList.contains("found")?e.classList.remove("hidden"):e.classList.add("hidden")})}}),n.leadingIcon_.root_.onclick=function(){searchInitBack(n)},n.trailingIcon_.root_.onclick=function(){searchInitCancel(n)}}))})}function searchInitBack(e){document.getElementById("search-users").classList.add("hidden"),document.getElementById("app-header").classList.remove("hidden"),e.value="",e.input_.dispatchEvent(new Event("input"))}function searchInitCancel(e){e.value="",e.input_.dispatchEvent(new Event("input"))}function activityDomCustomer(e){return console.log(e)," <div class='mdc-card'>\n    <div class='view-card'>\n\n        <div id='attachment-container'>\n            "+viewAttachment(e)+"\n        </div>\n        <div id='venue-container'>\n            <ul class=\"mdc-list\">\n                "+viewVenue(e)+"\n            </ul>\n        </div>\n        <div id='schedule-container'>\n            <ul class='mdc-list mdc-list--two-line'>\n                "+viewSchedule(e)+"\n            </ul>\n        </div>\n        <div id='schedule-container'></div>\n        <div id='assignee-container'>\n            <div class=\"assignees tasks-heading center\">\n                <i class=\"material-icons\">share</i>\n                "+viewAssignee(e)+"\n            </div>\n        </div>\n    \n    </div>\n</div>"}function addAssignee(e,t){progressBar.open(),requestCreator("share",{activityId:e.activityId,share:t}).then(function(){progressBar.close(),snacks("You Added "+t.length+" People"),history.back()}).catch(function(e){snacks(e.response.message),progressBar.close()})}function setActivityStatus(e,t){progressBar.open(),requestCreator("statusChange",{activityId:e.activityId,status:t}).then(function(){snacks(e.activityName+" is "+t),progressBar.close()}).catch(function(e){snacks(e.response.message),progressBar.close()})}function viewFormActions(){return'\n    <div class="mdc-card__actions">\n    <div class="mdc-card__action-buttons">\n    <button class="mdc-button mdc-card__action mdc-card__action--button">\n    <span class="mdc-button__label">Close</span>\n    </button>\n    </div>\n    </div>\n    \n'}function markCancelled(e){console.log(e)}function iconByType(e,t){if("string"===e)return"Name"===t?"account_circle":"info";return{phoneNumber:"phone","HH:MM":"access_time",weekday:"today"}[e]}function viewFormAttachmentEl(e,t){return"base64"===t.attachment[e].type?'<ul class="mdc-image-list my-image-list">\n        <li class="mdc-image-list__item">\n          <div class="mdc-image-list__image-aspect-container">\n            <img class="mdc-image-list__image" src="'+t.attachment[e].value+'">\n          </div>\n          <div class="mdc-image-list__supporting">\n            <span class="mdc-image-list__label">'+e+"</span>\n          </div>\n        </li>\n      </ul>":'<h1 class="mdc-typography--subtitle1 mt-0">\n        '+e+" : "+t.attachment[e].value+"\n    </h1>"}function viewAttachment(t){return""+Object.keys(t.attachment).map(function(e){return""+(t.attachment[e].value?viewFormAttachmentEl(e,t):"")}).join("")}function viewVenue(e){return""+e.venue.map(function(e,t){return"\n            "+(e.location&&e.address?'\n            <li class="mdc-list-item">\n                 '+(0==t?'<span class="mdc-list-item__graphic material-icons"\n                 aria-hidden="true">location_on</span>':'<span class="mdc-list-item__graphic" aria-hidden="true"\n                    style=\'background-color:white\'></span>')+"\n                     <span class='list-text'>"+e.location+"</span>\n              </li>":"")}).join("")}function viewSchedule(e){return""+e.schedule.map(function(e,t){return'\n            <li class="mdc-list-item">\n            '+(0==t?'<span class="mdc-list-item__graphic material-icons"\n            aria-hidden="true">today</span>':'<span class="mdc-list-item__graphic" aria-hidden="true"\n            style=\'background-color:white\'></span>')+'\n            <span class="mdc-list-item__text">\n              <span class="mdc-list-item__primary-text">'+e.name+'</span>\n              <span class="mdc-list-item__secondary-text">'+formatCreatedTime(e.startTime)+" - "+formatCreatedTime(e.endTime)+"</span>\n            </span>\n          </li>"}).join("")}function viewAssignee(e){return"\n    <div class=\"mdc-chip-set\" id='share'>\n     "+e.assignees.map(function(e,t){return'<div class="mdc-chip" id=\''+t+"-preselected'>\n                    <img class='mdc-chip__icon mdc-chip__icon--leading' src="+(e.photoURL||"../img/empty-user.jpg")+">\n                    <div class='mdc-chip__text'>"+(e.displayName||e.phoneNumber)+"</div>\n                </div>"}).join("")+"\n    </div>"}function createStatusChange(e){var t="";return"CANCELLED"===e&&(t='<li class="mdc-list-item" data-value="PENDING">\n       PENDING\n      </li>\n      <li class="mdc-list-item" data-value="CONFIRMED">\n        CONFIRMED\n    </li>\n      '),"PENDING"===e&&(t='<li class="mdc-list-item mdc-list-item--selected" data-value="PENDING" aria-selected="true">\n        PENDING\n       </li>\n       <li class="mdc-list-item" data-value="CONFIRMED">\n         CONFIRMED\n     </li>\n       '),"CONFIRMED"===e&&(t='<li class="mdc-list-item mdc-list-item--selected" data-value="CONFIRMED" aria-selected="true">\n        CONFIRMED\n       </li>\n       <li class="mdc-list-item" data-value="PENDING">\n         PENDING\n     </li>\n       '),'<div class="mdc-select status-select" id=\'status-enhanced-select\'>\n    <input type="hidden" name="enhanced-select">\n    <i class="mdc-select__dropdown-icon"></i>\n    <div class="mdc-select__selected-text"></div>\n    <div class="mdc-select__menu mdc-menu mdc-menu-surface status-select">\n      <ul class="mdc-list">\n        '+t+'\n      </ul>\n    </div>\n    <span class="mdc-floating-label">Change Status</span>\n    <div class="mdc-line-ripple"></div>\n  </div>'}function dynamicAppendChats(e){var n=document.getElementById("content"),a=firebase.auth().currentUser.phoneNumber;e.forEach(function(t){var e;e=history.state[1].photoURL,n&&(t.isComment&&t.user===a||(t.isComment?n.appendChild(messageBoxDom(t.comment,"them",e,t.timestamp)):t.user===history.state[1].mobile?n.appendChild(actionBoxDom(t)):db.transaction("activity").objectStore("activity").get(t.activityId).onsuccess=function(e){e.target.result.assignees.filter(function(e){return e.phoneNumber===history.state[1].mobile}).length&&n.appendChild(actionBoxDom(t))}))}),setBottomScroll()}function getUserChats(i){var e=db.transaction("addendum"),t=e.objectStore("addendum").index("key"),n=firebase.auth().currentUser.phoneNumber,a=IDBKeyRange.only(n+i.mobile),s=firebase.auth().currentUser.photoURL||"./img/empty-user.jpg",o=document.getElementById("content"),c="",r="",d="";t.openCursor(a).onsuccess=function(e){var t=e.target.result;t&&(d=t.value.user===n?(r="me",s):(r="them",i.photoURL||"./img/empty-user.jpg"),t.value.isComment?c+=messageBox(t.value.comment,r,d,t.value.timestamp):t.value.user!==n&&t.value.user!==i.mobile||(c+=actionBox(t.value)),t.continue())},e.oncomplete=function(){o.innerHTML=c,setBottomScroll();var e=new mdc.ripple.MDCRipple(document.getElementById("comment-send")),t=new mdc.textField.MDCTextField(document.getElementById("comment-textarea")),n=document.querySelector(".conversation-compose"),a=document.getElementById("bottom");e.root_.addEventListener("click",function(){t.value.trim()&&(progressBar.open(),requestCreator("dm",{comment:t.value,assignee:i.mobile}).then(function(){o&&(o.appendChild(messageBoxDom(t.value,"me",firebase.auth().currentUser.photoURL)),t.value="",resetCommentField(a,n,t.input_),setBottomScroll(),progressBar.close())}).catch(function(e){progressBar.close(),t.value="",snacks(e.response.message)}))}),t.input_.addEventListener("input",function(){200<=this.scrollHeight||(this.style.paddingTop="10px",this.style.lineHeight="1",this.style.height="5px",this.style.height=this.scrollHeight+"px",n.style.minHeight="56px",n.style.height="auto",a.style.height=this.scrollHeight+20+"px",this.value.trim()||resetCommentField(a,n,this))})}}function resetCommentField(e,t,n){e.style.height="72px",t.style.height="56px",n.style.height="auto"}function setBottomScroll(){var e=document.getElementById("inner");e&&e.scrollTo(0,e.scrollHeight)}function claimsView(){document.getElementById("app-header").classList.remove("hidden"),document.getElementById("growthfile").classList.add("mdc-top-app-bar--fixed-adjust");getHeader("app-header","<a class='mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n    <span class=\"mdc-top-app-bar__title\">Reimbursements</span>\n    ","");document.getElementById("app-current-panel").innerHTML=emptyClaims()}function emptyClaims(){return"<div class='empty-claims-section'>\n        <h3 class='mdc-typography--headline6'>No open claims pending for payment</h3>\n        <button class='mdc-button'>\n        <span class='mdc-button--label'>Create A New Claim</span>\n        </button>\n    </div>"}function getCellularInformation(){var e=void 0,t=AndroidInterface.getMobileCountryCode(),n=AndroidInterface.getMobileNetworkCode(),a=AndroidInterface.getRadioType(),i=AndroidInterface.getCarrier(),s=AndroidInterface.getWifiAccessPoints();try{e=AndroidInterface.getCellTowerInformation()}catch(e){console.log(e)}var o=[],c=[];s&&(o=parseQuery(s)),e&&(c=removeFalseCellIds(parseQuery(e)));var r={};return t&&(r.homeMobileCountryCode=Number(t)),n&&(r.homeMobileNetworkCode=Number(n)),i&&(r.carrier=i),a&&(r.radioType=a),o.length&&(r.wifiAccessPoints=o),c.length&&(r.cellTowers=c),o.length&&c.length?r.considerIp=!1:r.considerIp=!0,r}function removeFalseCellIds(e){var t=2147483647;return e.filter(function(e){return 0<e.cellId&&e.cellId<t&&0<e.locationAreaCode&&e.locationAreaCode<t})}function parseQuery(e){var n=[];return e.split(",").forEach(function(e){var t=new URLSearchParams(e);n.push(queryPatramsToObject(t))}),n}function queryPatramsToObject(e){var n={};return e.forEach(function(e,t){n[t]="macAddress"===t?e:Number(e)}),n}function createElement(e,t){var n=document.createElement(e);return t&&Object.keys(t).forEach(function(e){n[e]=t[e]}),n}function Dialog(e,t,n){this.title=e,this.content=t,this.id=n}function getHeader(e,t,n){var a=document.getElementById(e);return a.querySelector("#section-start").innerHTML=t,a.querySelector("#section-end").innerHTML=n,a.querySelector("#tabs").innerHTML="",topAppBar=new mdc.topAppBar.MDCTopAppBar(a),topAppBar}function createSimpleRadio(e,t){return'<div class=\'mdc-radio\'>\n    <input class="mdc-radio__native-control" type="radio" name="demo-radio-set" id='+e+'>\n    <div class="mdc-radio__background">\n    <div class="mdc-radio__outer-circle">\n    </div>\n    <div class="mdc-radio__inner-circle">\n    </div>\n    </div>\n    </div>\n    <label for='+e+">"+t+"</label>\n    "}function createSimpleToggle(e){return'<div class="mdc-switch mdc-list-item__meta" id='+e+'>\n    <div class="mdc-switch__track"></div>\n    <div class="mdc-switch__thumb-underlay">\n      <div class="mdc-switch__thumb">\n          <input type="checkbox" id="basic-switch" class="mdc-switch__native-control" role="switch">\n      </div>\n    </div>\n  </div>'}function createSimpleMenu(e,t){return'\n    <div class="mdc-menu mdc-menu-surface" id="'+t+'">\n    <ul class="mdc-list" role="menu" aria-hidden="true" aria-orientation="vertical" tabindex="-1">\n    '+e.map(function(e){return' <li class="mdc-list-item" role="menuitem">\n        <span class="mdc-list-item__graphic mdc-menu__selection-group-icon">\n        <i class=\'material-icons\'>'+e.icon+'</i>\n        </span>\n        <span class="mdc-list-item__text">'+e.name+"</span>\n        </li>"}).join("")+"\n    </ul>\n    </div>\n  "}function AppKeys(){this.mode="production"}function getSuggestions(){if(!ApplicationState.knownLocation)return ApplicationState.office?getSubsWithVenue().then(homeView):getAllSubscriptions().then(homeView);getKnownLocationSubs().then(homeView)}function getKnownLocationSubs(){return new Promise(function(e,t){var n=db.transaction(["subscriptions"]),a=n.objectStore("subscriptions"),i=[],s=ApplicationState.venue;a.openCursor(null,"prev").onsuccess=function(e){var t=e.target.result;t&&(t.value.office===s.office&&"CANCELLED"!==t.value.status&&Object.keys(t.value.attachment).forEach(function(e){t.value.attachment[e].type===s.template&&i.push(t.value)}),t.continue())},n.oncomplete=function(){e(i)}})}function getPendingLocationActivities(){return new Promise(function(e,t){var n=db.transaction("activity"),i=[];n.objectStore("activity").index("status").openCursor("PENDING").onsuccess=function(e){var t=e.target.result;if(t)if(t.value.office===ApplicationState.office)if(t.value.hidden)t.continue();else{var n=void 0;if(Object.keys(t.value.attachment).forEach(function(e){t.value.attachment[e].type===ApplicationState.venue.template&&t.value.attachment[e].value===ApplicationState.venue.location&&(console.log(t.value),n=t.value)}),n){var a=!1;n.schedule.forEach(function(e){(e.startTime||e.endTime)&&moment(moment().format("DD-MM-YY")).isBetween(moment(e.startTime).format("DD-MM-YY"),moment(e.endTime).format("DD-MM-YY"),null,"[]")&&(e.isValid=!0,a=!0)}),a&&i.push(n),t.continue()}else t.continue()}else t.continue()},n.oncomplete=function(){return e(i)}})}function getSubsWithVenue(){return new Promise(function(e,t){var n=db.transaction(["subscriptions"]),a=n.objectStore("subscriptions"),i=ApplicationState.office,s=[];a.openCursor(null,"prev").onsuccess=function(e){var t=e.target.result;t&&("check-in"!==t.value.template&&t.value.office===i&&"CANCELLED"!==t.value.status&&t.value.venue.length&&s.push(t.value),t.continue())},n.oncomplete=function(){e(s)}})}function handleNav(e){return history.back()}function homePanel(){return' <div class="container home-container">\n  '+topNavCard()+"\n  <div class='work-tasks'>\n      <h3 class=\"mdc-list-group__subheader mdc-typography--headline6\">What do you want to do ?</h3>\n      <h3 class=\"mdc-list-group__subheader\">Suggestions</h3>\n      <div id='pending-location-tasks'></div>\n      <div id='suggestions-container'></div>\n      <div id='action-button' class='attendence-claims-btn-container mdc-layout-grid__inner'>\n      </div>\n\n      <button class=\"mdc-fab mdc-fab--extended  mdc-theme--primary-bg app-fab--absolute\" id='reports'>\n      <span class=\"material-icons mdc-fab__icon\">description</span>\n      <span class=\"mdc-fab__label\">My Reports</span>\n     </button>\n  </div>\n</div>"}function topNavCard(){return'\n    <div class="profile-container mdc-card">\n    <div class="mdc-card__primary-action">\n      <div class="simple">\n  \n        <img src="'+firebase.auth().currentUser.photoURL+'" class="image" id=\'profile-image-card\'>\n        <h3 class="mdc-typography--headline6">My Growthfile</h3>\n      </div>\n      <div class="actions">\n        <div class="action">\n          <span class="mdc-typography--body1" id=\'camera\'><i class="material-icons">camera</i>Camera</span>\n        </div>\n       \n        <div class="action">\n          <span class="mdc-typography--body1" id=\'chat\'><i class="material-icons">comment</i>Chats</span>\n        </div>\n      </div>\n  \n    </div>\n    <div role="progressbar" class="mdc-linear-progress mdc-linear-progress--indeterminate mdc-linear-progress--closed" id=\'suggestion-progress\'>\n    <div class="mdc-linear-progress__buffering-dots"></div>\n    <div class="mdc-linear-progress__buffer"></div>\n    <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">\n      <span class="mdc-linear-progress__bar-inner"></span>\n    </div>\n    <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">\n      <span class="mdc-linear-progress__bar-inner"></span>\n    </div>\n  </div>\n  </div>\n  \n  '}function homeView(e){progressBar.close(),getHeader("app-header","","").listen("MDCTopAppBar:nav",handleNav),document.getElementById("app-header").classList.add("hidden"),history.pushState(["homeView"],null,null);var t=document.getElementById("app-current-panel");document.getElementById("growthfile").classList.remove("mdc-top-app-bar--fixed-adjust"),t.innerHTML=homePanel();var i=new mdc.linearProgress.MDCLinearProgress(document.getElementById("suggestion-progress"));document.getElementById("camera")&&document.getElementById("camera").addEventListener("click",function(){history.pushState(["snapView"],null,null),snapView()}),document.getElementById("chat").addEventListener("click",function(){history.pushState(["chatView"],null,null),chatView()}),document.getElementById("profile-image-card").addEventListener("click",function(){history.pushState(["profileView"],null,null),profileView()}),document.getElementById("reports").addEventListener("click",function(){history.pushState(["reportView"],null,null),reportView()}),ApplicationState.knownLocation&&getPendingLocationActivities().then(function(n){if(document.getElementById("pending-location-tasks")){document.getElementById("pending-location-tasks").innerHTML=pendinglist(n);var a=new mdc.list.MDCList(document.getElementById("confirm-tasks"));a.singleSelection=!0,console.log(a),a.listen("MDCList:action",function(t){console.log(n[t.detail.index]);var e=n[t.detail.index];i.open(),requestCreator("statusChange",{activityId:e.activityId,status:"CONFIRMED"}).then(function(){i.close(),a.listElements[t.detail.index].classList.add("slide-right"),setTimeout(function(){a.listElements[t.detail.index].classList.add("hidden")},500)}).catch(function(e){i.close(),snacks(e.response.message),a.foundation_.adapter_.setCheckedCheckboxOrRadioAtIndex(t.detail.index,!1)})})}}),document.getElementById("suggestions-container").innerHTML=templateList(e);var n=new mdc.list.MDCList(document.getElementById("suggested-list"));n.singleSelection=!0,n.selectedIndex=0,n.listen("MDCList:action",function(e){console.log(n.listElements[e.detail.index].dataset),history.pushState(["addView"],null,null),addView(JSON.parse(n.listElements[e.detail.index].dataset.value))}),Promise.all([getSubscription(ApplicationState.office,"attendance regularization","CONFIRMED"),getSubscription(ApplicationState.office,"leave","CONFIRMED"),getSubscription(ApplicationState.office,"expense claim","CONFIRMED")]).then(function(e){}).catch(console.log)}function pendinglist(e){return'\n  <ul class="mdc-list subscription-list" role="group" aria-label="List with checkbox items" id=\'confirm-tasks\'>\n    '+e.map(function(e,t){return'\n      <li class="mdc-list-item" role="checkbox" aria-checked="false">\n      Confirm '+e.activityName+' ?    \n      <div class=\'mdc-checkbox mdc-list-item__meta\'>\n        <input type="checkbox"\n                class="mdc-checkbox__native-control"\n                id="demo-list-checkbox-item-'+t+'" />\n        <div class="mdc-checkbox__background">\n          <svg class="mdc-checkbox__checkmark"\n                viewBox="0 0 24 24">\n            <path class="mdc-checkbox__checkmark-path"\n                  fill="none"\n                  d="M1.73,12.91 8.1,19.28 22.79,4.59"/>\n          </svg>\n          <div class="mdc-checkbox__mixedmark"></div>\n        </div>\n      </div>   \n    </li>'}).join()+"\n  </ul>\n  "}function templateList(e){return"<ul class=\"mdc-list subscription-list\" id='suggested-list'>\n  "+e.map(function(e){return"<li class='mdc-list-item' data-value='"+JSON.stringify(e)+"'>\n      New "+e.template+"  ?\n    <span class='mdc-list-item__meta material-icons mdc-theme--primary'>\n      keyboard_arrow_right\n    </span>\n  </li>"}).join("")+"\n</ul>"}Dialog.prototype.create=function(e){var t=createElement("div",{className:"mdc-dialog",role:"alertDialog",id:this.id});t.setAttribute("aria-modal","true"),t.setAttribute("aria-labelledby","Title"),t.setAttribute("aria-describedby","content");var n=createElement("div",{className:"mdc-dialog__container"}),a=createElement("div",{className:"mdc-dialog__surface"}),i=createElement("h2",{className:"mdc-dialog__title"});i.innerHTML=this.title;var s=createElement("footer",{className:"mdc-dialog__actions"}),o=createElement("div",{className:"mdc-dialog__content"});if(this.content instanceof HTMLElement?o.appendChild(this.content):o.innerHTML=this.content,a.appendChild(i),a.appendChild(o),"simple"!==e){var c=createElement("button",{className:"mdc-button mdc-dialog__button",type:"button",textContent:"Close"});c.setAttribute("data-mdc-dialog-action","close");var r=createElement("button",{className:"mdc-button mdc-dialog__button",type:"button",textContent:"Okay"});r.setAttribute("data-mdc-dialog-action","accept"),s.appendChild(c),s.appendChild(r),a.appendChild(s)}n.appendChild(a),t.appendChild(n),t.appendChild(createElement("div",{className:"mdc-dialog__scrim"}));var d=document.getElementById("dialog-container");return d.innerHTML="",d.appendChild(t),new mdc.dialog.MDCDialog(t)},AppKeys.prototype.getMode=function(){return this.mode},AppKeys.prototype.getMapKey=function(){return"production"===this.mode?"AIzaSyA4s7gp7SFid_by1vLVZDmcKbkEcsStBAo":"AIzaSyCadBqkHUJwdcgKT11rp_XWkbQLFAy80JQ"},AppKeys.prototype.getKeys=function(){return"production"===this.mode?{apiKey:this.getMapKey(),authDomain:"growthfile-207204.firebaseapp.com",databaseURL:"https://growthfile-207204.firebaseio.com",projectId:"growthfile-207204",storageBucket:"growthfile-207204.appspot.com",messagingSenderId:"701025551237"}:{apiKey:this.getMapKey(),authDomain:"growthfilev2-0.firebaseapp.com",projectId:"growthfilev2-0",messagingSenderId:"1011478688238"}},AppKeys.prototype.getBaseUrl=function(){return"production"===this.mode?"https://api2.growthfile.com/api/":"https://us-central1-growthfilev2-0.cloudfunctions.net/api/"};var db,map,globMark,appKey=new AppKeys,progressBar=void 0,snackBar=void 0,ui=void 0,send=void 0,change=void 0,next=void 0,emailInit=void 0,isCheckInCreated=void 0,drawer=void 0,navList=void 0,native={setFCMToken:function(e){localStorage.setItem("token",e)},getFCMToken:function(){return localStorage.getItem("token")},setName:function(e){localStorage.setItem("deviceType",e)},getName:function(){return localStorage.getItem("deviceType")},setIosInfo:function(e){var t=new URLSearchParams(e),n={};t.forEach(function(e,t){n[t]="appVersion"===t?Number(e):e}),localStorage.setItem("deviceInfo",JSON.stringify(n))},getIosInfo:function(){return localStorage.getItem("deviceInfo")},getInfo:function(){return!!this.getName()&&("Android"===this.getName()?(deviceInfo=getAndroidDeviceInformation(),localStorage.setItem("deviceInfo",deviceInfo),deviceInfo):this.getIosInfo())}};function getAndroidDeviceInformation(){return JSON.stringify({id:AndroidInterface.getId(),deviceBrand:AndroidInterface.getDeviceBrand(),deviceModel:AndroidInterface.getDeviceModel(),osVersion:AndroidInterface.getOsVersion(),baseOs:AndroidInterface.getBaseOs(),radioVersion:AndroidInterface.getRadioVersion(),appVersion:Number(AndroidInterface.getAppVersion())})}function firebaseUiConfig(e,t){return{callbacks:{signInSuccessWithAuthResult:function(e){return!1},signInFailure:function(e){return handleUIError(e)},uiShown:function(){}},signInFlow:"popup",signInOptions:[{provider:firebase.auth.PhoneAuthProvider.PROVIDER_ID,recaptchaParameters:{type:"image",size:"invisible",badge:"bottomleft"},defaultCountry:"IN",defaultNationalNumber:e?firebase.auth().currentUser.phoneNumber:""}]}}function userSignedOut(){(ui=new firebaseui.auth.AuthUI(firebase.auth())).start(document.getElementById("login-container"),firebaseUiConfig())}function startApp(){firebase.auth().onAuthStateChanged(function(l){if(!l)return document.getElementById("main-layout-app").style.display="none",void userSignedOut();if("production"!==appKey.getMode()||native.getInfo()){localStorage.setItem("error",JSON.stringify({}));var m=window.indexedDB.open(l.uid,15);m.onupgradeneeded=function(e){if((db=m.result).onerror=function(){handleError({message:db.error.message+" from startApp on upgradeneeded"})},e.oldVersion){if(e.oldVersion<4)m.transaction.objectStore("subscriptions").createIndex("status","status");if(e.oldVersion<5)(r=m.transaction).objectStore("map").createIndex("bounds",["latitude","longitude"]);if(e.oldVersion<6){var t=(r=m.transaction).objectStore("children");t.createIndex("officeTemplate",["office","template"]),t.createIndex("employees","employee"),t.createIndex("employeeOffice",["employee","office"]),t.createIndex("team","team"),t.createIndex("teamOffice",["team","office"]);var n=firebase.auth().currentUser.phoneNumber;t.index("template").openCursor("employee").onsuccess=function(e){var t=e.target.result;t?(t.value.employee=t.value.attachment["Employee Contact"].value,t.value.attachment["First Supervisor"].value!==n&&t.value.attachment["Second Supervisor"].value!==n||(t.value.team=1),t.update(t.value),t.continue()):console.log("finished modiying children")},r.oncomplete=function(){console.log("finsihed backlog")}}if(e.oldVersion<7){var a=(r=m.transaction).objectStore("map");a.createIndex("office","office"),a.createIndex("status","status"),a.createIndex("selection",["office","status","location"])}if(e.oldVersion<8){var i=(r=m.transaction).objectStore("list"),s=r.objectStore("calendar");i.createIndex("office","office"),s.createIndex("office","office")}if(e.oldVersion<9){(r=m.transaction).objectStore("users").createIndex("mobile","mobile");var o=r.objectStore("addendum");o.createIndex("user","user"),o.createIndex("timestamp","timestamp")}if(e.oldVersion<=10)(r=m.transaction).objectStore("subscriptions").createIndex("count","count");if(e.oldVersion<=11)(r=m.transaction).objectStore("users").createIndex("timestamp","timestamp");if(e.oldVersion<=12)(r=m.transaction).objectStore("activity").createIndex("status","status");if(e.oldVersion<=13){(r=m.transaction).objectStore("subscriptions").createIndex("validSubscription",["office","template","status"]);var c=r.objectStore("addendum");c.createIndex("key","key"),c.createIndex("KeyTimestamp",["timestamp","key"])}if(e.oldVersion<=14){var r,d=(r=m.transaction).objectStore("users");d.createIndex("NAME_SEARCH","NAME_SEARCH"),d.openCursor().onsuccess=function(e){var t=e.target.result;t&&(t.value.timestamp||(t.value.timestamp=""),t.value.NAME_SEARCH=t.value.displayName.toLowerCase(),t.update(t.value).onsuccess=function(){console.log("updated user ",t.value)},t.continue())}}}else createObjectStores(db,l.uid)},m.onsuccess=function(){if(!areObjectStoreValid((db=m.result).objectStoreNames)){db.close(),console.log(l);var e=indexedDB.deleteDatabase(l.uid);return e.onsuccess=function(){window.location.reload()},e.onblocked=function(){snacks("Please Re-Install The App")},void(e.onerror=function(){snacks("Please Re-Install The App")})}var t=document.querySelector("#start-load");t.classList.remove("hidden"),console.log("run app"),document.getElementById("main-layout-app").style.display="block";var n=["Loading Growthfile","Getting Your Data","Creating Profile","Please Wait"],a=0,i=setInterval(function(){a==n.length-1&&clearInterval(i),t.querySelector("p").textContent=n[a],a++},a+1e3);requestCreator("now",{device:native.getInfo(),from:"",registerToken:native.getFCMToken()}).then(function(e){e.updateClient?updateApp():e.revokeSession?revokeSession():getRootRecord().then(function(e){e.fromTime?(profileCheck(),requestCreator("Null").then(console.log).catch(function(e){snacks(e.response.message,"Okay",function(){startApp(!0)})})):requestCreator("Null").then(profileCheck).catch(function(e){snacks(e.response.message,"Okay")})})}).catch(function(e){console.log(e),snacks(e.response.message,"Retry")})},m.onerror=function(){handleError({message:m.error.message+" from startApp"})}}else redirect()})}function miniProfileCard(e,t,n){return"<div class='mdc-card profile-update-init'>\n  <header class='mdc-top-app-bar mdc-top-app-bar--fixed' id='card-header'>\n    <div class='mdc-top-app-bar__row'>\n      <section class='mdc-top-app-bar__section mdc-top-app-bar__section--align-start' id='card-header-start'>\n        "+t+'\n      </section>\n    </div>\n    <div role="progressbar" class="mdc-linear-progress mdc-linear-progress--indeterminate mdc-linear-progress--closed" id=\'card-progress\'>\n      <div class="mdc-linear-progress__buffering-dots"></div>\n      <div class="mdc-linear-progress__buffer"></div>\n      <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">\n        <span class="mdc-linear-progress__bar-inner"></span>\n      </div>\n      <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">\n        <span class="mdc-linear-progress__bar-inner"></span>\n      </div>\n    </div>\n  </header>\n  <div class=\'content-area mdc-top-app-bar--fixed-adjust\'>\n  <div id=\'primary-content\'>\n  \n  '+e+"\n  </div>\n  </div>\n  "+n+"\n</div>"}function checkForPhoto(){var e=firebase.auth().currentUser;if(e.photoURL)checkForRecipient();else{var t='\n\n      <div class=\'photo-container\'>\n      <img src="./img/empty-user.jpg" id="image-update">\n      <button class="mdc-fab mdc-theme--primary-bg" aria-label="Favorite">\n        <span class="mdc-fab__icon material-icons mdc-theme--on-primary">camera</span>\n        <input type=\'file\' accept=\'image/jpeg;capture=camera\' id=\'choose\'>\n      </button>\n\n      </div>\n      <div class="view-container">\n      <div class="mdc-text-field mdc-text-field--with-leading-icon mb-10 mt-20">\n    <i class="material-icons mdc-text-field__icon mdc-theme--primary">account_circle</i>\n    <input class="mdc-text-field__input" value="'+e.displayName+'" disabled>\n    <div class="mdc-line-ripple"></div>\n    <label class="mdc-floating-label mdc-floating-label--float-above">Name</label>\n  </div>\n\n  <div class="mdc-text-field mdc-text-field--with-leading-icon mt-0">\n    <i class="material-icons mdc-text-field__icon mdc-theme--primary">phone</i>\n    <input class="mdc-text-field__input" value="'+e.phoneNumber+'" disabled>\n    <div class="mdc-line-ripple"></div>\n    <label class="mdc-floating-label mdc-floating-label--float-above">Phone</label>\n  </div>\n      </div>\n      </div>\n      ';document.getElementById("app-current-panel").innerHTML=miniProfileCard(t,' <span class="mdc-top-app-bar__title">Add Your Profile Picture</span>',"");var i=new mdc.linearProgress.MDCLinearProgress(document.getElementById("card-progress"));document.getElementById("choose").addEventListener("change",function(e){var t=document.getElementById("choose").files;if(t.length){var n=t[0],a=new FileReader;a.onload=function(e){var t=e.target.result,n=new Image;n.src=t,n.onload=function(){var e=resizeAndCompressImage(n);document.getElementById("image-update").src=e,i.open(),requestCreator("backblaze",{imageBase64:e}).then(function(){i.close(),checkForRecipient()}).catch(function(e){i.close(),snacks(e.response.message)})}},a.readAsDataURL(n)}})}}function resizeAndCompressImage(e){var t=document.createElement("canvas"),n=new CanvasDimension(e.width,e.height);n.setMaxHeight(screen.height),n.setMaxWidth(screen.width);var a=n.getNewDimension();return t.width=a.width,t.height=a.height,t.getContext("2d").drawImage(e,0,0,a.width,a.height),t.toDataURL("image/jpeg",.5)}function CanvasDimension(e,t){this.MAX_HEIGHT="",this.MAX_WIDTH="",this.width=e,this.height=t}function checkForRecipient(){var r=firebase.auth().currentUser;getEmployeeDetails(IDBKeyRange.bound(["recipient","CONFIRMED"],["recipient","PENDING"]),"templateStatus").then(function(e){if(!e.length)return mapView();if(r.email&&r.emailVerified)return mapView();var t=getReportNameString(e);if(r.email)if(r.emailVerified);else{var n=firebase.auth().currentUser.email,a="<h3 class='mdc-typography--headline6 mt-0'>"+t+"</h3>\n      <h3 class='mdc-typography--body1'>Click To Send a verification Email</h3>\n      <button class=\"mdc-button mdc-theme--primary-bg mdc-theme--on-primary\" id='sendVerification'>\n      <span class=\"mdc-button__label\">RESEND VERIFICATION MAIL</span>\n      </button>";document.getElementById("app-current-panel").innerHTML=miniProfileCard(a,'<span class="mdc-top-app-bar__title">VERIFY YOUR EMAIL ADDRESS</span>',"");var i=new mdc.linearProgress.MDCLinearProgress(document.getElementById("card-progress"));new mdc.ripple.MDCRipple(document.getElementById("sendVerification")).root_.addEventListener("click",function(e){i.open(),requestCreator("updateAuth",{email:n,phoneNumber:firebase.auth().currentUser.phoneNumber}).then(function(){i.close(),snacks("Verification Link has been Sent to "+n),mapView()}).catch(console.log)})}else{var s="<h3 class='mdc-typography--headline6 mt-0'>"+t+'</h3>\n    <div class="mdc-text-field mdc-text-field--outlined" id=\'email\'>\n       <input class="mdc-text-field__input" required>\n      <div class="mdc-notched-outline">\n          <div class="mdc-notched-outline__leading"></div>\n          <div class="mdc-notched-outline__notch">\n                <label class="mdc-floating-label">Email</label>\n          </div>\n          <div class="mdc-notched-outline__trailing"></div>\n      </div>\n    </div>';document.getElementById("app-current-panel").innerHTML=miniProfileCard(s,'<span class="mdc-top-app-bar__title">Add You Email Address</span>','<div class="mdc-card__actions">\n    <div class="mdc-card__action-icons"></div>\n    <div class="mdc-card__action-buttons">\n    <button class="mdc-button" id=\'addEmail\'>\n      <span class="mdc-button__label">UPDATE</span>\n      <i class="material-icons mdc-button__icon" aria-hidden="true">arrow_forward</i>\n    </button>\n </div>\n </div>');var o=new mdc.textField.MDCTextField(document.getElementById("email")),c=new mdc.linearProgress.MDCLinearProgress(document.getElementById("card-progress"));new mdc.ripple.MDCRipple(document.getElementById("addEmail")).root_.addEventListener("click",function(e){o.value?(c.open(),requestCreator("updateAuth",{email:o.value,phoneNumber:firebase.auth().currentUser.phoneNumber}).then(function(){snacks("Verification Link has been Sent to "+o.value),mapView(),c.close()}).catch(console.log)):o.focus()})}})}function getReportNameString(e){var a="You are a recipient in ",i={};return e.forEach(function(e){i[e.office]?i[e.office].push(e.attachment.Name.value):i[e.office]=[e.attachment.Name.value]}),Object.keys(i).forEach(function(e,t){var n=i[e].join(",");console.log(t),a+=" "+n+" For "+e+" &"}),"&"===a[a.length-1]?a.substring(0,a.length-1):a}function simpleInputField(){}function profileCheck(){history.state=null,document.getElementById("start-load").classList.add("hidden");var e=firebase.auth().currentUser;if(!e.displayName){document.getElementById("app-current-panel").innerHTML=miniProfileCard('\n    <div class="mdc-text-field mdc-text-field--outlined" id=\'name\'>\n    <input class="mdc-text-field__input" required>\n    <div class="mdc-notched-outline">\n      <div class="mdc-notched-outline__leading"></div>\n      <div class="mdc-notched-outline__notch">\n        <label class="mdc-floating-label">Name</label>\n      </div>\n      <div class="mdc-notched-outline__trailing"></div>\n    </div>\n  </div>\n  ','<span class="mdc-top-app-bar__title">Enter Your Name</span>','<div class="mdc-card__actions"><div class="mdc-card__action-icons"></div><div class="mdc-card__action-buttons"><button class="mdc-button" id=\'updateName\'>\n  <span class="mdc-button__label">NEXT</span>\n  <i class="material-icons mdc-button__icon" aria-hidden="true">arrow_forward</i>\n  </button></div></div>');var t=new mdc.linearProgress.MDCLinearProgress(document.getElementById("card-progress")),n=new mdc.textField.MDCTextField(document.getElementById("name"));return console.log(n),history.pushState(["profileCheck"],null,null),void new mdc.ripple.MDCRipple(document.getElementById("updateName")).root_.addEventListener("click",function(){n.value?(t.open(),e.updateProfile({displayName:n.value}).then(checkForPhoto).catch(console.log)):n.focus()})}checkForPhoto()}function areObjectStoreValid(e){for(var t=["map","children","calendar","root","subscriptions","list","users","activity","addendum"],n=0;n<t.length;n++){var a=t[n];if(!e.contains(a))return!1}return!0}function getEmployeeDetails(a,i){return new Promise(function(n,e){var t=db.transaction(["children"]).objectStore("children").index(i).getAll(a);t.onsuccess=function(e){var t=e.target.result;return console.log(t),n(t)},t.onerror=function(){return e({message:t.error})}})}function createObjectStores(e,t){var n=e.createObjectStore("activity",{keyPath:"activityId"});n.createIndex("timestamp","timestamp"),n.createIndex("office","office"),n.createIndex("hidden","hidden"),n.createIndex("template","template"),n.createIndex("status","status");var a=e.createObjectStore("list",{keyPath:"activityId"});a.createIndex("timestamp","timestamp"),a.createIndex("status","status"),a.createIndex("office","office");var i=e.createObjectStore("users",{keyPath:"mobile"});i.createIndex("displayName","displayName"),i.createIndex("isUpdated","isUpdated"),i.createIndex("count","count"),i.createIndex("mobile","mobile"),i.createIndex("timestamp","timestamp"),i.createIndex("NAME_SEARCH","NAME_SEARCH");var s=e.createObjectStore("addendum",{autoIncrement:!0});s.createIndex("activityId","activityId"),s.createIndex("user","user"),s.createIndex("key","key"),s.createIndex("KeyTimestamp",["timestamp","key"]);var o=e.createObjectStore("subscriptions",{autoIncrement:!0});o.createIndex("office","office"),o.createIndex("template","template"),o.createIndex("officeTemplate",["office","template"]),o.createIndex("validSubscription",["office","template","status"]),o.createIndex("status","status"),o.createIndex("count","count");var c=e.createObjectStore("calendar",{autoIncrement:!0});c.createIndex("activityId","activityId"),c.createIndex("timestamp","timestamp"),c.createIndex("start","start"),c.createIndex("end","end"),c.createIndex("office","office"),c.createIndex("urgent",["status","hidden"]),c.createIndex("onLeave",["template","status","office"]);var r=e.createObjectStore("map",{autoIncrement:!0});r.createIndex("activityId","activityId"),r.createIndex("location","location"),r.createIndex("latitude","latitude"),r.createIndex("longitude","longitude"),r.createIndex("nearby",["status","hidden"]),r.createIndex("byOffice",["office","location"]),r.createIndex("bounds",["latitude","longitude"]),r.createIndex("office","office"),r.createIndex("status","status"),r.createIndex("selection",["office","status","location"]);var d=e.createObjectStore("children",{keyPath:"activityId"});d.createIndex("template","template"),d.createIndex("office","office"),d.createIndex("templateStatus",["template","status"]),d.createIndex("officeTemplate",["office","template"]),d.createIndex("employees","employee"),d.createIndex("employeeOffice",["employee","office"]),d.createIndex("team","team"),d.createIndex("teamOffice",["team","office"]),e.createObjectStore("root",{keyPath:"uid"}).put({uid:t,fromTime:0,location:""})}function redirect(){firebase.auth().signOut().then(function(){window.location="https://www.growthfile.com"}).catch(function(e){console.log(e),window.location="https://www.growthfile.com",handleError({message:e+" from redirect"})})}function setVenueForCheckIn(e,t){var n={geopoint:{latitude:"",longitude:""},address:"",location:"",venueDescriptor:t.venue[0]};return e?(n.location=e.location,n.address=e.address,n.geopoint.latitude=e.latitude,n.geopoint.longitude=e.longitude,t.venue=[n],t.share=[],console.log(t)):(t.venue=[n],t.share=[]),t}function getUniqueOfficeCount(){return new Promise(function(e,t){var n=[],a=db.transaction(["children"]);a.objectStore("children").index("employees").openCursor(firebase.auth().currentUser.phoneNumber).onsuccess=function(e){var t=e.target.result;t&&(n.push(t.value.office),t.continue())},a.oncomplete=function(){return console.log(n),e(n)},a.onerror=function(){return t({message:a.error.message,body:JSON.stringify(a.error)})}})}function checkMapStoreForNearByLocation(o,c){return new Promise(function(a,e){var i=[],t=db.transaction(["map"]),n=t.objectStore("map").index("byOffice"),s=IDBKeyRange.bound([o,""],[o,"ï¿¿"]);n.openCursor(s).onsuccess=function(e){var t=e.target.result;if(t)if(t.value.location)if(t.value.latitude&&t.value.longitude){var n=calculateDistanceBetweenTwoPoints(t.value,c);isLocationLessThanThreshold(n)&&i.push(t.value),t.continue()}else t.continue();else t.continue()},t.oncomplete=function(){var t={};i.forEach(function(e){t[e.location]=e});var n=[];Object.keys(t).forEach(function(e){n.push(t[e])});var e=n.sort(function(e,t){return e.accuracy-t.accuracy});a(e)},t.onerror=function(){e(t.error)}})}window.onpopstate=function(e){e.state&&"mapView"!==e.state[0]&&"snapView"!==e.state[0]&&("homeView"!==e.state[0]?window[e.state[0]](e.state[1]):getSuggestions())},window.addEventListener("load",function(){(firebase.initializeApp(appKey.getKeys()),progressBar=new mdc.linearProgress.MDCLinearProgress(document.querySelector(".mdc-linear-progress")),drawer=new mdc.drawer.MDCDrawer(document.querySelector(".mdc-drawer")),snackBar=new mdc.snackbar.MDCSnackbar(document.querySelector(".mdc-snackbar")),drawer.listen("MDCDrawer:opened",function(e){document.querySelector(".mdc-drawer__header .mdc-drawer__title").textContent=firebase.auth().currentUser.displayName||firebase.auth().currentUser.phoneNumber,document.querySelector(".mdc-drawer__header img").src=firebase.auth().currentUser.photoURL||"../src/img/empty-user.jpg",document.querySelector(".mdc-drawer__header img").onclick=function(){profileView()}}),moment.updateLocale("en",{calendar:{lastDay:"[yesterday]",sameDay:"hh:mm",nextDay:"[Tomorrow at] LT",lastWeek:"dddd",nextWeek:"dddd [at] LT",sameElse:"L"},longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YY"},months:["January","February","March","April","May","June","July","August","September","October","November","December"]}),window.Worker||window.indexedDB)?startApp(!0):new Dialog("App Incompatiblity","Growthfile is incompatible with this device").create().open()}),CanvasDimension.prototype.setMaxWidth=function(e){this.MAX_WIDTH=e},CanvasDimension.prototype.setMaxHeight=function(e){this.MAX_HEIGHT=e},CanvasDimension.prototype.getNewDimension=function(){return this.width>this.height?this.width>this.MAX_WIDTH&&(this.height*=this.MAX_WIDTH/this.width,this.width=this.MAX_WIDTH):this.height>this.MAX_HEIGHT&&(this.width*=this.MAX_HEIGHT/this.height,this.height=this.MAX_HEIGHT),{width:this.width,height:this.height}};var o=void 0,selectedSubs=void 0;function mapView(){history.pushState(["mapView"],null,null),document.getElementById("start-load").classList.add("hidden");var e=document.getElementById("app-current-panel");e.innerHTML=mapDom(),e.classList.remove("user-detail-bckg","mdc-top-app-bar--fixed-adjust"),document.getElementById("map-view").style.height="100%",manageLocation().then(function(e){ApplicationState.location=e,firebase.auth().currentUser.reload(),console.log("auth relaoderd"),document.getElementById("start-load").classList.add("hidden");var t={lat:e.latitude,lng:e.longitude};console.log(t);var n=new GetOffsetBounds(e,.5);if(o={north:n.north(),south:n.south(),east:n.east(),west:n.west()},document.getElementById("map")){map=new google.maps.Map(document.getElementById("map"),{center:t,zoom:18,disableDefaultUI:!0,restriction:{latLngBounds:{north:n.north(),south:n.south(),east:n.east(),west:n.west()},strictBounds:!0}}),new google.maps.Marker({position:t,icon:"https://www.robotwoods.com/dev/misc/bluecircle.png"}).setMap(map);new google.maps.Circle({strokeColor:"#89273E",strokeOpacity:.8,strokeWeight:2,fillColor:"#89273E",fillOpacity:.35,map:map,center:t,radius:e.accuracy});google.maps.event.addListenerOnce(map,"idle",function(){console.log("idle_once"),loadNearByLocations(o,map,e).then(function(e){loadCardData(e)})})}}).catch(function(e){console.log(e),document.getElementById("start-load").classList.add("hidden"),document.getElementById("map").innerHTML='<div class="center-abs"><p>Failed To Detect You Location</p><button class="mdc-button" id="try-again">Try Again</button></div>',new mdc.ripple.MDCRipple(document.getElementById("try-again")).root_.onclick=function(){document.getElementById("start-load").classList.remove("hidden"),mapView()}})}function loadCardData(e){var t=document.getElementById("selection-box"),a=t.querySelector("aside"),n=t.querySelector(".content-body");n.innerHTML="";var i=document.getElementById("card-primary"),s=new mdc.linearProgress.MDCLinearProgress(document.getElementById("check-in-prog"));i.textContent="Where Are You",t.classList.remove("hidden"),n.innerHTML="<div>\n    "+mdcSelectVenue(e,"Where Are You ?","select-venue")+"\n    <div id='office-cont' class='pt-10'></div>\n    <div id='subs-cont' class='pt-10'></div>\n    <div id='submit-cont' class='pt-10'></div>\n    </div>",selectVenue=new mdc.select.MDCSelect(document.getElementById("select-venue")),selectVenue.listen("MDCSelect:change",function(e){if(document.getElementById("office-cont").innerHTML="",document.getElementById("subs-cont").innerHTML="",document.getElementById("submit-cont").innerHTML="",console.log(e.detail.value),a.classList.add("open"),e.detail.value){var n=JSON.parse(e.detail.value);if(1===n)return ApplicationState.knownLocation=!1,ApplicationState.venue="",ApplicationState.office="",void getUniqueOfficeCount().then(function(e){if(!e.length)return getSuggestions();document.getElementById("office-cont").innerHTML=""+mdcDefaultSelect(e,"Choose Office","choose-office");var t=new mdc.select.MDCSelect(document.getElementById("choose-office"));t.listen("MDCSelect:change",function(e){e.detail.value&&(ApplicationState.office=e.detail.value,getSubscription(e.detail.value,"check-in","CONFIRMED").then(function(e){if(!e)return getSuggestions();s.open(),requestCreator("create",setVenueForCheckIn("",e)).then(function(){snacks("Check-in created"),s.close(),getSuggestions()}).catch(function(e){snacks("Please Try again later"),s.close()})}))}),1==e.length&&(t.selectedIndex=0),1<e.length&&(t.selectedIndex=-1)});ApplicationState.knownLocation=!0,ApplicationState.venue=n,ApplicationState.office=n.office,getSubscription(n.office,"check-in","CONFIRMED").then(function(e){if(!e)return getSuggestions();document.getElementById("submit-cont").innerHTML="<button id='confirm' class='mdc-button mdc-theme--primary-bg mdc-theme--text-primary-on-light'>\n        <span class='mdc-button__label'>Confirm</span>\n        </button>";var t=new mdc.ripple.MDCRipple(document.getElementById("confirm"));t.root_.onclick=function(){t.root_.classList.add("hidden"),s.open(),requestCreator("create",setVenueForCheckIn(n,e)).then(function(){snacks("Check-in created"),s.close(),getSuggestions()}).catch(function(e){console.log(e),t.root_.classList.remove("hidden"),snacks("Please Try Again"),s.close()})}})}}),e.length||(selectVenue.selectedIndex=0),1==e.length&&(selectVenue.selectedIndex=1),1<e.length&&(selectVenue.selectedIndex=-1)}function getAllSubscriptions(){return new Promise(function(e,t){var n=db.transaction("subscriptions"),a=[];n.objectStore("subscriptions").openCursor().onsuccess=function(e){var t=e.target.result;t&&("CANCELLED"!==t.value.status&&a.push(t.value),t.continue())},n.oncomplete=function(){return e(a)}})}function hideBottomNav(){document.querySelector(".mdc-bottom-navigation").classList.add("hidden")}function showBottomNav(){document.querySelector(".mdc-bottom-navigation").classList.remove("hidden")}function toggleCardHeight(e,t){var n=document.getElementById("map-view"),a=document.getElementById(t);e?(n.classList.add("hidden"),a.classList.remove("hidden"),a.style.height="100%",document.getElementById("app-header").classList.add("hidden")):(n.classList.remove("hidden"),document.getElementById("selection-box").classList.remove("hidden"),a.classList.add("hidden"),document.getElementById("app-header").classList.remove("hidden"))}function mapDom(){return'\n  <div id=\'map-view\' class=\'\'>\n    <div id=\'map\'></div>\n    <div  class="overlay selection-box-auto hidden" id=\'selection-box\'>\n              <aside class="social" tabindex="-1" role="dialog" aria-labelledby="modal-label" aria-hidden="true">\n                <div class="card__primary">\n                  <h2 class="demo-card__title mdc-typography mdc-typography--headline6 margin-auto" id=\'card-primary\'>\n                  </h2>\n\n                </div>\n                <div role="progressbar"\n                  class="mdc-linear-progress mdc-linear-progress--indeterminate mdc-linear-progress--closed"\n                  id=\'check-in-prog\'>\n                  <div class="mdc-linear-progress__buffering-dots"></div>\n                  <div class="mdc-linear-progress__buffer"></div>\n                  <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">\n                    <span class="mdc-linear-progress__bar-inner"></span>\n                  </div>\n                  <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">\n                    <span class="mdc-linear-progress__bar-inner"></span>\n                  </div>\n                </div>\n\n                <div class="content-body">\n\n                </div>\n                <div id=\'submit-cont\'>\n                </div>\n              </aside>\n            </div>\n\n  '}function snapView(){history.pushState(["snapView"],null,null),AndroidInterface.startCamera()}function setFilePath(e){getHeader("app-header",'<a class=\'mdc-top-app-bar__navigation-icon\'><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></a>',"").root_.classList.remove("hidden"),document.getElementById("growthfile").classList.add("mdc-top-app-bar--fixed-adjust");var i="data:image/jpg;base64,"+e;document.getElementById("app-current-panel").innerHTML='\n  \n<div id=\'snap\' class="snap-bckg" style="background-image: url('+i+'); padding: 0px; overflow: hidden; background-size: cover;">\n<div class="form-meta snap-form">\n  <div class="mdc-text-field mdc-text-field--no-label mdc-text-field--textarea" id=\'snap-textarea\'>\n      <textarea\n      class="mdc-text-field__input  snap-text mdc-theme--on-primary" rows="1" cols="100"></textarea></div>\n      <button id=\'snap-submit\' class="mdc-fab app-fab--absolute mdc-theme--primary-bg  mdc-ripple-upgraded"\n    style="z-index: 9;">\n    <svg class="mdc-button__icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/><path d="M0 0h24v24H0z" fill="none"/></svg>\n    </button>\n</div>\n</div>\n  ';var t=document.getElementById("snap"),n=new mdc.textField.MDCTextField(document.getElementById("snap-textarea")),a=new mdc.ripple.MDCRipple(document.getElementById("snap-submit"));n.focus(),n.input_.addEventListener("keyup",function(){this.style.paddingTop="25px",this.style.height="5px",this.style.height=this.scrollHeight+"px",this.scrollHeight<=300&&(a.root_.style.bottom=this.scrollHeight-20+"px")}),a.root_.addEventListener("click",function(){var a=n.value;getUniqueOfficeCount().then(function(t){if(t.length)if(1!=t.length){if(1<t.length){var e=new Dialog("Send To","<ul class='mdc-list' role='radiogroup' id='dialog-office'>\n              "+t.map(function(e,t){return' <li class="mdc-list-item" role="radio" aria-checked="'+(t?"false":"true")+'" tabindex='+(t?"":"0")+'>\n                <span class="mdc-list-item__graphic">\n                  <div class="mdc-radio">\n                    <input class="mdc-radio__native-control"\n                          type="radio"\n                          id=\'demo-list-radio-item-'+t+'\'\n                          name="demo-list-radio-item-group"\n                          value="1">\n                    <div class="mdc-radio__background">\n                      <div class="mdc-radio__outer-circle"></div>\n                      <div class="mdc-radio__inner-circle"></div>\n                    </div>\n                  </div>\n                </span>\n                <label class="mdc-list-item__text" for="demo-list-radio-item-'+t+'">'+e+"</label>\n              </li>"}).join("")+"\n            \n            <ul>").create(),n=new mdc.list.MDCList(document.getElementById("dialog-office"));e.open(),e.listen("MDCDialog:opened",function(){n.layout(),n.singleSelection=!0}),e.listen("MDCDialog:closed",function(e){"accept"===e.detail.action&&getSubscription(t[n.selectedIndex],"check-in","CONFIRMED").then(function(e){if(!e)return snacks("Check-in Subscription not available"),void history.back();e.attachment.Photo.value=i,e.attachment.Comment.value=a,progressBar.open(),requestCreator("create",setVenueForCheckIn("",e)).then(function(){getSuggestions(),snacks("Check-In Created")}).catch(function(e){snacks(e.response.message)})})})}}else getSubscription(t[0],"check-in","CONFIRMED").then(function(e){if(!e)return snacks("Check-in Subscription not available"),void history.back();e.attachment.Photo.value=i,e.attachment.Comment.value=a,progressBar.open(),requestCreator("create",setVenueForCheckIn("",e)).then(function(){getSuggestions(),snacks("Check-In Created")}).catch(function(e){snacks(e.message)})})})});var s=new Image;s.onload=function(){var e=getOrientation(s);t.style.backgroundImage="url("+i+")",t.style.padding="0px",t.style.overflow="hidden",t.classList.add("snap-bckg"),"potrait"==e&&(t.style.backgroundSize="cover"),"landscape"!=e&&"sqaure"!=e||(t.style.backgroundSize="contain")},s.src=i}function createPhotoCheckIn(){}function mdcDefaultSelect(e,t,n,a){return'<div class="mdc-select" id='+n+'>\n  <i class="mdc-select__dropdown-icon"></i>\n  <select class="mdc-select__native-control">\n  '+e.map(function(e){return" <option value='"+e+"'>\n    "+e+"\n    </option>"}).join("")+"\n"+a+"\n\n  </select>\n  <label class='mdc-floating-label'>"+t+'</label>\n  <div class="mdc-line-ripple"></div>\n</div>'}function mdcSelectVenue(e,t,n){return'<div class="mdc-select" id='+n+'>\n  <i class="mdc-select__dropdown-icon"></i>\n  <select class="mdc-select__native-control">\n\n  <option value='+JSON.stringify("1")+">UNKNOWN LOCATION</option>\n  "+e.map(function(e){return" <option value='"+JSON.stringify(e)+"'>\n    "+e.location+"\n    </option>"}).join("")+"\n  </select>\n  <label class='mdc-floating-label'>"+t+'</label>\n  <div class="mdc-line-ripple"></div>\n</div>'}function getOrientation(e){return e.width>e.height?"landscape":e.height>e.width?"potrait":e.width==e.height?"square":void 0}function focusMarker(e,t,n){e.setZoom(n),e.panTo(t)}function GetOffsetBounds(e,t){var n=180/Math.PI;this.latLng=e,this.ratio=t/6378*n,this.radioLon=this.ratio/Math.cos(this.latLng.latitude*Math.PI/180)}function loadNearByLocations(c,r,d){return new Promise(function(e,t){new google.maps.InfoWindow;var a=[],n=db.transaction(["map"]),i=n.objectStore("map").index("bounds"),s=IDBKeyRange.bound([c.south,c.west],[c.north,c.east]),o=r.getBounds();i.openCursor(s).onsuccess=function(e){var t=e.target.result;if(t)if(.5<calculateDistanceBetweenTwoPoints(d,{latitude:t.value.latitude,longitude:t.value.longitude}))t.continue();else{var n=new google.maps.Marker({position:{lat:t.value.latitude,lng:t.value.longitude},icon:{url:"./img/m.png",size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)},id:t.value.activityId,value:JSON.stringify(t.value)});n.setMap(r);t.value.activityId;a.push(t.value),o.extend(n.getPosition()),t.continue()}},n.oncomplete=function(){return r.fitBounds(o),e(a)}})}function profileView(){drawer.open=!1,document.getElementById("start-load").classList.add("hidden"),document.getElementById("app-header").classList.remove("hidden"),document.getElementById("growthfile").classList.add("mdc-top-app-bar--fixed-adjust");var e=firebase.auth().currentUser.metadata.lastSignInTime,t=firebase.auth().currentUser,n=getHeader("app-header","<a class='mdc-top-app-bar__navigation-icon mdc-top-app-bar__navigation-icon material-icons'>arrow_back</a>\n  <span class=\"mdc-top-app-bar__title\">Profile</span>",' <a  class="material-icons mdc-top-app-bar__action-item" aria-label="Edit" id=\'edit-profile\'>edit</a>\n  <a class=" mdc-top-app-bar__action-item hidden" aria-label="Edit" id=\'save-profile\'>SAVE</a>\n  ');n.setScrollTarget(document.getElementById("main-content"));var a='<div class="mdc-card demo-card" id=\'profile-card\'>\n  <div class="mdc-card__primary-action demo-card__primary-action" tabindex="0">\n  \n  <div class="mdc-card__media mdc-card__media--16-9 demo-card__media"\n  style="background-image: url('+(firebase.auth().currentUser.photoURL||"./img/empty-user-big.jpg")+");\">\n\n</div>\n<button class='mdc-button overlay-text'>\n<i class='material-icons mdc-button__icon mdc-theme--on-primary'>add_a_photo</i>\n<span class='mdc-button__label mdc-theme--on-primary'>\nChoose Image\n</span>\n<input id='choose-profile-image' type='file' accept='image/jpeg;capture=camera'  class='overlay-text'>\n</button>\n<div id='base-details'></div>\n<div id='user-details'></div>  \n<div class=\"mdc-card__actions\">\n<div class=\"mdc-card__action-buttons\">\n    <span class=\"mdc-typography--headline6 last-logged-in-time\">"+e+"</span>\n</div>\n</div>\n";document.getElementById("app-current-panel").innerHTML=a,setDetails();var i=void 0,s=void 0,o=t.displayName,c=t.email,r=firebase.auth().currentUser.photoURL;document.getElementById("edit-profile").addEventListener("click",function(e){console.log(n),n.iconRipples_[0].root_.classList.add("hidden"),n.iconRipples_[1].root_.classList.remove("hidden"),history.pushState(["edit-profile"],null,null),document.getElementById("base-details").innerHTML="",document.querySelector(".mdc-card .mdc-card__actions").classList.add("hidden"),document.querySelector("#user-details").innerHTML=createEditProfile(o,c),nameInit=new mdc.textField.MDCTextField(document.getElementById("name")),emailInit=new mdc.textField.MDCTextField(document.getElementById("email"));var i=document.querySelector(".mdc-card__media");i.classList.add("reduced-brightness"),document.querySelector(".mdc-button.overlay-text").classList.add("show");var s=document.getElementById("choose-profile-image");document.querySelector(".overlay-text").style.opacity=1,s.addEventListener("change",function(e){var t=s.files;if(t.length){var n=t[0],a=new FileReader;a.onload=function(e){var t=new Image;t.src=e.target.result,t.onload=function(){var e=resizeAndCompressImage(t);i.style.backgroundImage="url("+e+")",r=e}},a.readAsDataURL(n)}})}),document.getElementById("save-profile").addEventListener("click",function(){document.querySelector(".mdc-card .mdc-card__actions").classList.remove("hidden"),i=nameInit.value,s=emailInit.value,progressBar.foundation_.open(),r!==firebase.auth().currentUser.photoURL&&requestCreator("backblaze",{imageBase64:r}).then(function(){snacks("Profile Picture set successfully")}).catch(function(e){snacks(e.response.message)}),t.updateProfile({displayName:i}).then(function(){if(!isEmailValid(s,c))return history.back();requestCreator("updateAuth",{email:emailInit.value}).then(function(){snacks("Verification Link has been Sent to "+emailInit.value),history.back(),setDetails()}).catch(function(e){progressBar.close(),history.back(),snacks(e?e.response.message:"Please Try Again Later")})})})}function setDetails(){progressBar.foundation_.close(),document.getElementById("base-details").innerHTML=createBaseDetails(),document.getElementById("user-details").innerHTML=createUserDetails(),createViewProfile()}function createBaseDetails(){return'   <div class="basic-info seperator">\n\n  <h1 class="mdc-typography--headline5 mb-0 mt-0" id=\'view-name\'>\n      '+(firebase.auth().currentUser.displayName||"-")+'</h1>\n  <h1 class="mdc-typography--headline6 mb-0 mt-0">\n  <svg class=\'meta-icon\' fill=\'#cccccc\' xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/><path d="M0 0h24v24H0z" fill="none"/></svg>\n  <span id=\'view-email\'>\n          '+firebase.auth().currentUser.email+'\n      </span>\n\n  </h1>\n  <h1 class="mdc-typography--headline6 mt-0"> \n  <svg class=\'meta-icon\' fill=\'#cccccc\' xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/></svg>\n  <span\n          class="mdc-typography--headline6">+91</span> 9999288921\n  </h1>\n</div>'}function createUserDetails(){return'\n  <div class="mdc-tab-bar" role="tablist">\n  <div class="mdc-tab-scroller">\n      <div class="mdc-tab-scroller__scroll-area">\n          <div class="mdc-tab-scroller__scroll-content" id=\'tab-scroller\'>\n          </div>\n      </div>\n  </div>\n</div>\n<div id=\'my-details\' class=\'pt-10\'></div>\n\n'}function createViewProfile(){getEmployeeDetails(IDBKeyRange.only(firebase.auth().currentUser.phoneNumber),"employees").then(function(a){var t="";a.forEach(function(e){t+=addTabs(e.office)}),document.getElementById("tab-scroller").innerHTML=t;var e=new mdc.tabBar.MDCTabBar(document.querySelector(".mdc-tab-bar"));setTimeout(function(){e.activateTab(0)},0),e.listen("MDCTabBar:activated",function(e){var t=a[e.detail.index],n=t.office,r=[t.attachment["First Supervisor"].value,t.attachment["Second Supervisor"].value];document.getElementById("my-details").innerHTML=fillUserDetails(t),Promise.all([getEmployeeDetails([n,"recipient"],"officeTemplate"),getEmployeeDetails([n,"leave-type"],"officeTemplate"),getEmployeeDetails([1,n],"teamOffice")]).then(function(e){var t=e[0],n=e[1],a=e[2];console.log(e),t.length&&(document.getElementById("reports").innerHTML=' <h1 class="mdc-typography--subtitle1 mt-0">\n                          Reports :\n                          '+t.map(function(e){return"<span>"+e.attachment.Name.value+'</span>  <span class="dot"></span>'}).join("")+"\n                          </h1>"),n.length&&(document.getElementById("leaves").innerHTML='<h1 class="mdc-typography--headline6 mb-0">\n                          Remaining Leaves\n                          '+n.map(function(e,t){return'<h1 class="mdc-typography--headline6 mt-0 '+(n.length-t==1?"":"mb-0")+'">'+e.attachment.Name.value+" : "+e.attachment["Annual Limit"].value+"</h1>"}).join("")+"\n                      </h1>");var i=db.transaction(["users"]),s=i.objectStore("users"),o="",c="";r.forEach(function(e){s.get(e).onsuccess=function(e){var t=e.target.result;t&&(c+=addUserChips(t))}}),a.length&&a.forEach(function(e){s.get(e.attachment["Employee Contact"].value).onsuccess=function(e){var t=e.target.result;t&&(o+=addUserChips(t))}}),i.oncomplete=function(){c&&(document.getElementById("supervisors").innerHTML='<h1 class="mdc-typography--headline6 mt-0 mb-0">Supervisors</h1>\n                  <div class="mdc-chip-set supervisor">\n                  '+c+"\n                  </div>\n                  "),o&&(document.getElementById("my-team").innerHTML='<h1 class="mdc-typography--headline6 mt-0 mb-0">Team</h1>\n                  <div class="mdc-chip-set">\n                  '+o+"\n                  </div>")}})})})}function createEditProfile(e,t){return" "+nameField(e)+"\n\n  "+emailField(t,"This Will Be Used For Sending Reports")+"\n    "}function nameField(e){return'<div class="mdc-typography mdc-typography--body2 p-10" id=\'card-body-edit\'>\n  <div class="mdc-text-field mdc-text-field--with-leading-icon full-width" id=\'name\'>\n\n  <svg class=\'mdc-text-field__icon\' xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/><path d="M0 0h24v24H0z" fill="none"/></svg>\n      <input class="mdc-text-field__input" value="'+e+'">\n      <div class="mdc-line-ripple"></div>\n      <label class="mdc-floating-label '+(e?"mdc-floating-label--float-above":"")+'">Name</label>\n  </div>\n  <div class="mdc-text-field-helper-line">\n      <div id="username-helper-text" class="mdc-text-field-helper-text" aria-hidden="true">\n       This will be displayed on your public profile\n\n      </div>\n  </div>'}function emailField(e,t,n){return'<div class="mdc-text-field mdc-text-field--with-leading-icon full-width" id=\'email\'>\n  <svg class=\'mdc-text-field__icon\' xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/><path d="M0 0h24v24H0z" fill="none"/></svg>\n  <input class="mdc-text-field__input" type=\'email\' value="'+e+'" autofocus='+(n?"true":"false")+'>\n  <div class="mdc-line-ripple"></div>\n  <label class="mdc-floating-label '+(e?"mdc-floating-label--float-above":"")+' ">Email</label>\n</div>\n<div class="mdc-text-field-helper-line">\n  <div id="username-helper-text" class="mdc-text-field-helper-text" aria-hidden="true">\n      '+t+"\n  </div>\n</div>"}function addTabs(e){return' <button class="mdc-tab" role="tab">\n        <span class="mdc-tab__content">\n            <span class="mdc-tab__text-label">'+e+'</span>\n        </span>\n        <span class="mdc-tab-indicator">\n            <span\n                class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>\n        </span>\n        <span class="mdc-tab__ripple"></span>\n    </button>'}function addUserChips(e){return'\n  <div class="mdc-chip">\n    '+(e.photoURL?'<img class="mdc-chip__icon mdc-chip__icon--leading" src='+e.photoURL+">":'\n    \n    <svg class="mdc-chip__icon mdc-chip__icon--leading" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M16.5 12c1.38 0 2.49-1.12 2.49-2.5S17.88 7 16.5 7C15.12 7 14 8.12 14 9.5s1.12 2.5 2.5 2.5zM9 11c1.66 0 2.99-1.34 2.99-3S10.66 5 9 5C7.34 5 6 6.34 6 8s1.34 3 3 3zm7.5 3c-1.83 0-5.5.92-5.5 2.75V19h11v-2.25c0-1.83-3.67-2.75-5.5-2.75zM9 13c-2.33 0-7 1.17-7 3.5V19h7v-2.25c0-.85.33-2.34 2.37-3.47C10.5 13.1 9.66 13 9 13z"/></svg>')+'\n    <div class="mdc-chip__text">'+(e.displayName||e.mobile)+"</div>\n</div>"}function fillUserDetails(t){var n={"First Supervisor":!0,"Second Supervisor":!0,"Employee Contact":!0,Name:!0};return'<div class="office-info seperator">\n'+Object.keys(t.attachment).map(function(e){return n[e]?"":t.attachment[e].value?'<h1 class="mdc-typography--subtitle1 mt-0">\n    '+e+" : "+t.attachment[e].value+"\n</h1>":""}).join("")+'\n\n<h1 class="mdc-typography--subtitle1 mt-0">\n    Joined : '+moment(firebase.auth().currentUser.metadata.creationTime).format("Do MMM YYYY")+"\n</h1>\n\n<div id='reports'>\n\n</div>\n</div>\n<div class=\"hierchy pt-10 seperator\">\n<div id='supervisors'>\n</div>\n\n<div id='my-team' style='padding-bottom:10px'>\n</div>\n</div>\n\n<div class=\"meta-hidden-details\">\n<div id='leaves'>\n\n</div>\n\n</div>\n\n</div>\n\n</div>\n"}function timeDiff(e){var t=moment().format("YYY-MM-DD HH:mm"),n=moment(e).format("YYY-MM-DD HH:mm");return moment(t).diff(moment(n),"minutes")}function isEmailValid(e,t){return!!e&&!(e===t)}function reportView(){getHeader("app-header",'<a class=\'mdc-top-app-bar__navigation-icon\'><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></a>',"");document.getElementById("app-header").classList.remove("hidden"),document.getElementById("growthfile").classList.add("mdc-top-app-bar--fixed-adjust"),document.getElementById("tabs").innerHTML=showTabs(),setTimeout(function(){e.activateTab(1)},0);var e=new mdc.tabBar.MDCTabBar(document.querySelector("#tabs .mdc-tab-bar"));console.log(e),e.listen("MDCTabBar:activated",function(e){document.getElementById("app-current-panel").innerHTML="",e.detail.index?1==e.detail.index&&(document.getElementById("app-current-panel").innerHTML="<div class='mdc-top-app-bar--fixed-adjust-with-tabs'>"+emptyClaims()+"</div>"):document.getElementById("app-current-panel").innerHTML="<div class='attendence-section pt-20 mdc-top-app-bar--fixed-adjust-with-tabs'>\n    "+applyLeave()+"\n    "+attendenceCards()+"\n    </div>\n    "})}function showTabs(){return'<div class="mdc-tab-bar" role="tablist">\n    <div class="mdc-tab-scroller">\n      <div class="mdc-tab-scroller__scroll-area">\n        <div class="mdc-tab-scroller__scroll-content">\n          <button class="mdc-tab mdc-tab--active" role="tab" aria-selected="true" tabindex="0">\n            <span class="mdc-tab__content">\n              <span class="mdc-tab__icon material-icons mdc-theme--on-primary" aria-hidden="true">fingerprint</span>\n              <span class="mdc-tab__text-label mdc-theme--on-primary">Attendence</span>\n            </span>\n            <span class="mdc-tab-indicator mdc-tab-indicator--active">\n              <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>\n            </span>\n            <span class="mdc-tab__ripple"></span>\n          </button>\n          <button class="mdc-tab" role="tab" aria-selected="false" tabindex="-1">\n          <span class="mdc-tab__content">\n            <span class="mdc-tab__icon material-icons mdc-theme--on-primary" aria-hidden="true">assignment</span>\n            <span class="mdc-tab__text-label mdc-theme--on-primary">reimbursement</span>\n          </span>\n          <span class="mdc-tab-indicator">\n            <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>\n          </span>\n          <span class="mdc-tab__ripple"></span>\n        </button>\n        <button class="mdc-tab" role="tab" aria-selected="false" tabindex="-1">\n        <span class="mdc-tab__content">\n         \n          <span class="mdc-tab__text-label mdc-theme--on-primary">Report 1</span>\n        </span>\n        <span class="mdc-tab-indicator">\n          <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>\n        </span>\n        <span class="mdc-tab__ripple"></span>\n      </button>\n      <button class="mdc-tab" role="tab" aria-selected="false" tabindex="-1">\n        <span class="mdc-tab__content">\n          <span class="mdc-tab__text-label mdc-theme--on-primary">Report 2</span>\n        </span>\n        <span class="mdc-tab-indicator">\n          <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>\n        </span>\n        <span class="mdc-tab__ripple"></span>\n      </button><button class="mdc-tab" role="tab" aria-selected="false" tabindex="-1">\n      <span class="mdc-tab__content">\n        <span class="mdc-tab__text-label mdc-theme--on-primary">Report 3</span>\n      </span>\n      <span class="mdc-tab-indicator">\n        <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>\n      </span>\n      <span class="mdc-tab__ripple"></span>\n    </button><button class="mdc-tab" role="tab" aria-selected="false" tabindex="-1">\n    <span class="mdc-tab__content">\n      <span class="mdc-tab__icon material-icons" aria-hidden="true">favorite</span>\n      <span class="mdc-tab__text-label mdc-theme--on-primary">Report 4</span>\n    </span>\n    <span class="mdc-tab-indicator">\n      <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>\n    </span>\n    <span class="mdc-tab__ripple"></span>\n  </button>\n        </div>\n      </div>\n    </div>\n  </div>'}ApplicationState={office:"",location:"",knownLocation:!1,venue:""},GetOffsetBounds.prototype.north=function(){return this.latLng.latitude+this.ratio},GetOffsetBounds.prototype.south=function(){return this.latLng.latitude-this.ratio},GetOffsetBounds.prototype.east=function(){return this.latLng.longitude+this.radioLon},GetOffsetBounds.prototype.west=function(){return this.latLng.longitude-this.radioLon};var apiHandler=new Worker("js/apiHandler.js");function handleError(e){var t=JSON.parse(localStorage.getItem("error"));t.hasOwnProperty(e.message)||(localStorage.setItem("error",JSON.stringify(t)),requestCreator("instant",JSON.stringify(e)))}function successDialog(e){console.log(e);var t=document.getElementById("success-animation"),n=document.getElementById("growthfile");t.classList.remove("hidden"),n.style.opacity="0.37",setTimeout(function(){t.classList.add("hidden"),n.style.opacity="1"},1500)}function snacks(e,t,n){snackBar.labelText=e,snackBar.open(),snackBar.timeoutMs=4e3,snackBar.actionButtonText=t||"Okay",snackBar.listen("MDCSnackbar:closed",function(e){"action"===e.detail.reason&&n&&"function"==typeof n&&n()})}function fetchCurrentTime(e){return Date.now()+e}function geolocationApi(i){return new Promise(function(t,n){var a=new XMLHttpRequest;a.open("POST","https://www.googleapis.com/geolocation/v1/geolocate?key="+appKey.getMapKey(),!0),a.setRequestHeader("Content-Type","application/json"),a.onreadystatechange=function(){if(4===a.readyState){if(400<=a.status)return n({message:a.response,body:JSON.parse(i)});var e=JSON.parse(a.response);if(!e)return n({message:"Response From geolocation Api "+e,body:JSON.parse(i)});t({latitude:e.location.lat,longitude:e.location.lng,accuracy:e.accuracy,provider:i})}},a.onerror=function(){n({message:a})},a.send(i)})}function manageLocation(){return new Promise(function(t,n){getLocation().then(function(e){ApplicationState.location=e,t(e)}).catch(function(e){n(e)})})}function getLocation(){return new Promise(function(n,a){if("Android"!==native.getName())try{webkit.messageHandlers.locationService.postMessage("start"),window.addEventListener("iosLocation",function e(t){n(t.detail),window.removeEventListener("iosLocation",e,!0)},!0)}catch(e){html5Geolocation().then(function(e){n(e)}).catch(function(e){a(e)})}else html5Geolocation().then(function(t){if(t.accuracy<=350)return n(t);handleGeoLocationApi().then(function(e){return t.accuracy<e.accuracy?n(t):n(e)}).catch(function(e){return n(t)})}).catch(function(t){handleGeoLocationApi().then(function(e){return n(e)}).catch(function(e){return a({message:"Both HTML and Geolocation failed to fetch location",body:{html5:t,geolocation:e},locationError:!0})})})})}function handleGeoLocationApi(){return new Promise(function(t,n){var e=void 0;try{e=getCellularInformation()}catch(e){n(e.message)}Object.keys(e).length||n("empty object from getCellularInformation"),geolocationApi(JSON.stringify(e)).then(function(e){return t(e)}).catch(function(e){n(e)})})}function iosLocationError(n){return new Promise(function(t,e){html5Geolocation().then(function(e){return ApplicationState.location=e,t(e)}).catch(e),handleError(n)})}function html5Geolocation(){return new Promise(function(t,n){navigator.geolocation.getCurrentPosition(function(e){return t({latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy,provider:"HTML5",lastLocationTime:Date.now()})},function(e){n({message:e.message})},{maximumAge:0,timeout:5e3,enableHighAccuracy:!1})})}function toRad(e){return e*Math.PI/180}function calculateDistanceBetweenTwoPoints(e,t){var n=toRad(t.latitude-e.latitude),a=toRad(t.longitude-e.longitude),i=toRad(t.latitude),s=toRad(e.latitude),o=Math.sin(n/2)*Math.sin(n/2)+Math.sin(a/2)*Math.sin(a/2)*Math.cos(i)*Math.cos(s);return 6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}function isLocationMoreThanThreshold(e){return 1<=e}function isLocationStatusWorking(){return"Android"!==native.getName()||(AndroidInterface.isLocationPermissionGranted()?!{samsung:!0,OnePlus:!0}[JSON.parse(localStorage.getItem("deviceInfo")).deviceBrand]||(!!AndroidInterface.isWifiOn()||void new Dialog("TURN ON YOUR WIFI","Growthfile requires wi-fi access for improving your location accuracy.").create().open()):void new Dialog("LOCATION PERMISSION","Please Allow Growthfile location access.").create().open())}function requestCreator(t,n){var e=firebase.auth().currentUser;if(e){var a={type:t,body:"",meta:{user:{token:"",uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,phoneNumber:e.phoneNumber},apiUrl:appKey.getBaseUrl()}};return e.getIdToken(!1).then(function(e){a.meta.user.token=e,"instant"===t||"now"===t||"Null"===t||"backblaze"===t||"removeFromOffice"===t?(a.body=n,apiHandler.postMessage(a)):getRootRecord().then(function(e){n.timestamp=fetchCurrentTime(e.serverTime),(a.body=n).geopoint=ApplicationState.location,apiHandler.postMessage(a)})}).catch(console.log),new Promise(function(t,n){apiHandler.onmessage=function(e){return console.log(e),e.data.success?t(e.data):n(e.data)},apiHandler.onerror=function(e){return console.log(e),n(e.data)}})}}function locationErrorDialog(t){var e=new Dialog("Location Error","There was a problem in detecting your location. Please try again later").create();e.open(),e.listen("MDCDialog:closed",function(e){resetScroll(),listView(),handleError(t)})}function isLastLocationOlderThanThreshold(e,t){if(!e)return!0;var n=moment(moment().valueOf());return t<moment.duration(n.diff(e)).asSeconds()}function updateApp(){if("Android"!==native.getName())return webkit.messageHandlers.updateApp.postMessage("Update App");var e=new Dialog("New Update Avaialble","Please Install the Latest version from google play store , to Use Growthfile. Click Okay to Install Lastest Version from Google Play Store.").create();e.open(),e.scrimClickAction="",e.listen("MDCDialog:opened",function(){e.buttons_[0].setAttribute("disabled","true")}),e.listen("MDCDialog:closed",function(e){"accept"===e.detail.action&&AndroidInterface.openGooglePlayStore("com.growthfile.growthfileNew")})}function revokeSession(){firebase.auth().signOut().then(function(){}).catch(function(e){handleError({message:"Sign out error",body:e})})}function officeRemovalSuccess(e){var t=new Dialog("Reminder","You have been removed from "+e.msg.join(" & ")).create();t.open(),t.listen("MDCDialog:closed",function(){})}function handleComponentUpdation(e){if(history.state)switch(history.state[0]){case"homeView":getSuggestions();break;case"enterChat":dynamicAppendChats(e.response.addendum)}}function runRead(e){if(!e||e.read)return firebase.auth().currentUser.reload(),void requestCreator("Null",e).then(handleComponentUpdation).catch(console.log)}function removeChildNodes(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function getRootRecord(){return new Promise(function(e,t){var n=void 0,a=db.transaction(["root"],"readwrite");a.objectStore("root").get(firebase.auth().currentUser.uid).onsuccess=function(e){var t=e.target.result;n=t},a.oncomplete=function(){e(n)},a.onerror=function(){t({message:a.error.message+" from getRootRecord"})}})}function getSubscription(i,s,o){return new Promise(function(t){var e=db.transaction(["subscriptions"]),n=e.objectStore("subscriptions").index("validSubscription"),a=IDBKeyRange.only([i,s,o]);n.get(a).onsuccess=function(e){return e.target.result?t(e.target.result):t(null)},e.onerror=function(){return reject({message:e.error,body:""})}})}